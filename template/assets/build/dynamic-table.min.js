var _e=Object.defineProperty;var u=(y,C)=>_e(y,"name",{value:C,configurable:!0});(function(){"use strict";(function(){const n={env:{NODE_ENV:"production"}};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,n);return}}catch(o){}globalThis.process={env:n}})();var y=Object.defineProperty,C=Object.defineProperties,ee=Object.getOwnPropertyDescriptors,K=Object.getOwnPropertySymbols,te=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable,N=u((n,o,r)=>o in n?y(n,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[o]=r,"G"),O=u((n,o)=>{for(var r in o||(o={}))te.call(o,r)&&N(n,r,o[r]);if(K)for(var r of K(o))ne.call(o,r)&&N(n,r,o[r]);return n},"C"),L=u((n,o)=>C(n,ee(o)),"F"),l=u((n,o)=>y(n,"name",{value:o,configurable:!0}),"r");const h=window.jQuery,{Table:x,ajax:oe}=window.Tangible||{},ae=!1,re=l(n=>["log","warn","error"].reduce((o,r)=>(o[r]=(...b)=>r==="log"&&!ae?null:window.console[r](`[${n}]`,...b),o),{}),"createLogger"),i=re("Tangible Table"),le=l((n,o)=>{let r;return function(){clearTimeout(r),r=window.setTimeout(()=>n.apply(this,arguments),o)}},"debounce"),I="__tangibleTableRendered";function j(n,o={}){if(!x){i.warn("Library not found");return}const r=typeof n=="string"?document.querySelector(n):n;if(!r){i.warn("Element not found",n);return}if(r[I])return;r[I]=!0;const b=h(r),S=b.data("tangibleTableConfig")||{};i.log("Config",S);const{name:ve,rows:U=[],column_label:ie={},column_sort_enabled:se=[],column_sort_type:V={},pagination:ce=!0,pagination_template:ue,empty_table_template:ge="",row_loop:k,column_template:pe,column_order:fe}=S;let p=1,{per_page:D=-1,total_pages:w,sort_column:R,sort_order:$,sort_type:E}=S,G="",J=[],q={},f=h("<div><div></div></div>");const be=f.find("div")[0],Q=L(O({},o),{element:be,data:U,columns:ie,sorting:se,rowsPerPage:D===-1?999:D,pagination:ce,totalPages:w,paginationTemplate:ue,onPaginationChange:H,onColumnSort:W}),m=new x(Q);i.log("Created",Q),b.empty().append(f.find("table").children());const z=f.find(".tangible-table-pagination");z.insertAfter(b),b.wrap('<div class="tangible-table-overflow"></div>');const T=h('<div class="tangible-table-on-empty">'+ge+"</div>");T.hide(),T.insertAfter(z),f=b.closest(".tangible-table-container");const B=b,P={},de=l(t=>{const e=Object.keys(t);return e.sort(),e.reduce((a,s)=>`${a}${s}=${JSON.stringify(t[s])},`,"")},"createCacheKey");function A(t={}){const e=O({page:p,per_page:D,row_loop:k,column_order:fe,sort_column:R,sort_order:$,sort_type:E,search:G,search_columns:J,filter_by_column_values:q},t),a=de(e);return{tableRequest:L(O({},e),{column_template:pe,column_sort_type:V}),cacheKey:a}}u(A,"I"),l(A,"createTableRequest");function F(t=!1){t?(T.hide(),B.show(),f.removeClass("is-empty-table")):(B.hide(),T.show(),f.addClass("is-empty-table"))}u(F,"N"),l(F,"handleEmptyTable");function v(t={}){const{tableRequest:e,cacheKey:a}=A(t);return new Promise((s,c)=>{if(P[a]){const g=P[a];return s(g)}i.log("fetchTableData",e),f.addClass("loading"),oe("tangible_table_data",e).then(function(g){P[a]=g,i.log("fetchTableData success",g),s(g),f.removeClass("loading")}).catch(function(g){i.log("fetchTableData error",g),s(),f.removeClass("loading")})})}u(v,"y"),l(v,"fetchTableData");const{cacheKey:me}=A();P[me]={rows:U,total_pages:w};function H(t){i.log("Get page",t+1),p=t+1,v().then(function(e){!e||m.setPage(t,e.rows)})}u(H,"ae"),l(H,"onPaginationChange");function M(t){i.log("onUpdateRowsPerPage",t)}u(M,"le"),l(M,"onUpdateRowsPerPage");function W(t,e){p=1,R=t,$=e,E=V[t]||"string",i.log("onColumnSort",p,R,$,E),v().then(function(a){if(!a)return;const s=p-1;m.setPage(s,a.rows)})}u(W,"re"),l(W,"onColumnSort");function X(t,e){i.log("onSearch",t,e),p=1,G=t,J=e||m.getVisibleColumns(),v().then(function(a){if(!a)return;i.log("Search result",a),m.setTotalPages(a.total_pages||1);const s=p-1,c=a.rows||[];m.setPage(s,c),F(c.length)})}u(X,"ce"),l(X,"onSearch");const Y=f.find(".tangible-table-filter-form");if(!Y.length)return;const he=l(function({$field:t,tag:e,name:a,type:s,action:c,filterColumns:g}){const d=t.val();if(i.log("Filter",c,a,d),c==="loop"||c==="column"){c==="column"?d.length?q[a]={value:d}:delete q[a]:k.attributes[a]=d,v().then(function(_){if(!_)return;w=_.total_pages||1,p>w&&(p=w),m.setTotalPages(w);const we=p-1,Z=_.rows||[];m.setPage(we,Z),F(Z.length)});return}if(c==="search"){X(d,g);return}if(c==="perPage"){M(parseInt(d,10));return}},"runFilter");Y.each(function(){const t=h(this);t.find("select,input").each(function(){const e=h(this),a=e.prop("tagName").toLowerCase(),s=e.attr("name"),c=a==="select"?"select":e.attr("type"),g=e.data("tangibleTableFilterAction")||"loop",d=e.data("tangibleTableFilterColumns"),_=l(function(){he({$field:e,tag:a,name:s,type:c,action:g,filterColumns:d})},"onAction");e.on("change",_),c==="text"&&e.on("input",le(_,500))}),t.on("submit",function(e){e.preventDefault()})})}u(j,"H"),l(j,"activateTable"),h(".tangible-table").each(function(){j(this)}),window.Tangible=window.Tangible||{},window.Tangible.activateTable=j})();
//# sourceMappingURL=dynamic-table.min.js.map

(function(){"use strict";(function(){const i={env:{NODE_ENV:"production"}};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,i);return}}catch(t){}globalThis.process={env:i}})();const p=i=>Array.isArray(i),l=i=>typeof i=="number",P=i=>typeof i=="object",b=i=>typeof i=="function",m=i=>typeof i=="string",Q=i=>l(parseFloat(i,10)),$=i=>{if(Object.prototype.toString.call(i)==="[object Date]"){if(l(i.getTime()))return!0}else if(m(i)){const t=new Date(i);if(l(t.getTime()))return!0}return!1},B=(i,t)=>i.sort((e,s)=>t==="asc"?parseInt(e,10)-parseInt(s,10):parseInt(s,10)-parseInt(e,10)),L=i=>"keys"in Object?Object.keys(i):Object.getOwnPropertyNames(i),v=(i,t)=>{if(w(p(i),"ForEach requires array input"),!i.length)return[];b(t)||(t=()=>{});let e=0,s=i.length;for(;e<s;)t.apply(null,[i[e],e]),e+=1;return i},V=(i,t)=>{if(w(p(i),"_filter requires array input"),!i.length)return[];if(!b(t))return i;let e=0,s=i.length,a=[];for(;e<s;)t.apply(null,[i[e],e])&&a.push(i[e]),e+=1;return a},w=(i,t,...e)=>{let s;if(!i){const a=[...e];let n=0;throw s=new Error(t.replace(/%s/g,()=>a[n++])),s.name="TableSortable Violation",s.framesToPop=1,s}},F=(i,t)=>{if(i===t)return 0;if(l(i))return parseFloat(i)>parseFloat(t)?1:-1;if(!Q(i)&&$(i)){const e=new Date(i),s=new Date(t);return console.log("compare",i,t,i>t?1:-1),e.getTime()>s.getTime()?1:-1}return m(i)?i.toLowerCase()>t.toLowerCase()?1:-1:1},S=(i,t)=>{let e;return function(){clearTimeout(e),e=window.setTimeout(()=>i.apply(this,arguments),t)}},O=i=>m(i)?i.toLowerCase():String(i),I=(i,t,e=[])=>{if(!t&&!l(t))return!1;const s=L(i);p(e)||(e=s);let a=0,n=s.length,o=!1;const d=O(t);for(;a<n;){const h=s[a],g=O(i[h]);if(e.length&&e.indexOf(h)>-1&&g.indexOf(d)>-1){o=!0;break}if(!e.length&&g.indexOf(d)>-1){o=!0;break}a+=1}return o};var A=Object.defineProperty,q=(i,t,e)=>t in i?A(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,f=(i,t,e)=>(q(i,typeof t!="symbol"?t+"":t,e),e);class M{constructor(){f(this,"_name","dataset"),f(this,"dataset",null),f(this,"_cachedData",null),f(this,"_datasetLen",0),f(this,"_outLen",10),f(this,"sortDirection",{ASC:"asc",DESC:"desc"})}_formatError(t,e,s,...a){w(t,`${this._name}.${e} ${s}`,...a)}_hasDataset(){this._formatError(this.dataset!==null,"data",'No source collection is provided. Add your collection to dataset with "dataset.fromCollection([{}])" method.')}fromCollection(t){this._formatError(p(t),"fromCollection","Requires dataset to be a collection, like [{ }]"),this.dataset=t,this._cachedData=JSON.stringify(t),this._datasetLen=t.length}top(t){return this._hasDataset(),t?(this._formatError(l(t),"top","Requires length to be a number"),this.dataset.slice(0,t)):this.dataset.slice(0,this._outLen)}bottom(t){return this._hasDataset(),t?(this._formatError(l(t),"bottom","Requires length to be a number"),t=Math.max(this._datasetLen-t,0),this.dataset.slice(t,this._datasetLen)):(t=Math.max(this._datasetLen-this._outLen,0),this.dataset.slice(t,this._datasetLen))}get(t,e){return this._hasDataset(),this._formatError(l(t),"get",'Requires "from" to be a number'),this._formatError(l(e),"get",'Requires "to" to be a number'),this._formatError(!(t>e),"get",'"from" cannot be greater than "to"'),t=Math.max(t,0),e=Math.min(e,this._datasetLen),this.dataset.slice(t,e)}sort(t,e){this._hasDataset(),this._formatError(m(t),"sort",'Requires "column" type of string'),this._formatError(m(e),"sort",'Requires "direction" type of string'),this._formatError(e==="asc"||e==="desc","sort",'"%s" is invalid sort direction. Use "dataset.sortDirection.ASC" or "dataset.sortDirection.DESC".',e);const s=this.top(1)[0];this._formatError(s[t],"sort",'Column name "%s" does not exist in collection',t);const a=this.sortDirection.ASC===e?1:-1;return this.dataset.sort(function(n,o){return F(n[t],o[t])*a}),this.top(this._datasetLen)}pushData(t){p(t)&&Array.prototype.push.apply(this.dataset,t)}search(t,e){if(m(t)||l(t)){const s=JSON.parse(this._cachedData);t===""?this.dataset=s:this.dataset=V(s,a=>I(a,t,e)),this._datasetLen=this.dataset.length}}}const W=(i,t,e)=>({node:i,attrs:t,children:e}),H=(i,t)=>{if(!t)return i;const e=Object.keys(t);let s=0;for(;s<e.length;){const a=e[s],n=t[a];n!==void 0&&(/^on/.test(a)&&n?i.on(a.replace(/^on/,"").toLowerCase(),n):a==="text"?i.text(n):a==="html"?i.html(n):a==="append"?i.append(n):a==="className"?i.attr("class",n):i.attr(a,n),s+=1)}return i},U=({node:i,attrs:t,children:e})=>{let s=jQuery(`<${i}></${i}>`);return H(s,t)},x=(i,t,e)=>{if(e||t.empty(),m(i)||i instanceof jQuery)t.append(i);else if(p(i)){const s=[];for(let a=0;a<i.length;a++){let n=U(i[a]);i[a].children&&(n=x(i[a].children,n,!0)),s.push(n)}t.append(s)}else if(P(i)){let s=U(i);i.children&&(s=x(i.children,s,!0)),t.append(s)}return t},k=()=>({createElement:W,render:x}),N=(i,t)=>Array(t-i+1).fill().map((e,s)=>s+i),z=(i,t)=>{let e;t<=7?e=7:e=i>4&&i<t-3?2:4;const s={start:Math.round(i-e/2),end:Math.round(i+e/2)};(s.start-1===1||s.end+1===t)&&(s.start+=1,s.end+=1);let a=i>e?N(Math.min(s.start,t-e),Math.min(s.end,t)):N(1,Math.min(t,e+1));const n="...",o=(d,h)=>a.length+1!==t?h:[d];return a[0]!==1&&(a=o(1,[1,n]).concat(a)),a[a.length-1]<t&&(a=a.concat(o(t,[n,t]))),a};var G=Object.defineProperty,J=(i,t,e)=>t in i?G(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,r=(i,t,e)=>(J(i,typeof t!="symbol"?t+"":t,e),e);class D{constructor(t){r(this,"_name","tableSortable"),r(this,"_defOptions",{element:"",data:[],columns:{},visibleColumns:null,classPrefix:"tangible-table",buttonClass:"tangible-table-button",activeButtonClass:"tangible-table-button active",buttonGroupClass:"tangible-table-button-group",paginationContainerClass:"tangible-table-pagination-container",paginationLeftColumnClass:"tangible-table-pagination-left-column",paginationRightColumnClass:"tangible-table-pagination-right-column",sorting:!0,pagination:!0,paginationContainer:null,paginationTemplate:'<span data-tangible-table-paginator-field="current"></span> of <span data-tangible-table-paginator-field="total"></span> pages',rowsPerPage:10,formatCell:null,formatHeader:null,searchField:null,responsive:{},totalPages:0,sortingIcons:{asc:"<span> \u25B2</span>",desc:"<span> \u25BC</span>"},prevText:"<span>\u25C0\uFE0E</span>",nextText:"<span>\u25B6\uFE0E</span>",tableWillMount:()=>{},tableDidMount:()=>{},tableWillUpdate:()=>{},tableDidUpdate:()=>{},tableWillUnmount:()=>{},tableDidUnmount:()=>{},onPaginationChange:null,onColumnSort:null,onSearch:null,onUpdateRowsPerPage:null}),r(this,"_styles",null),r(this,"_dataset",null),r(this,"_table",null),r(this,"_thead",null),r(this,"_tbody",null),r(this,"_isMounted",!1),r(this,"_isUpdating",!1),r(this,"_sorting",{currentCol:"",dir:""}),r(this,"_pagination",{elm:null,currentPage:0,totalPages:1,visiblePageNumbers:5,pageData:[]}),r(this,"_cachedOption",null),r(this,"_cachedViewPort",-1),r(this,"setData",(e,s,a)=>{this.logError(p(e),"setData","expect first argument as array of objects"),this._isMounted&&e&&(a?this._dataset.pushData(e):this._dataset.fromCollection(e),s&&(this.logError(P(s),"setData","expect second argument as objects"),this.options.columns=s),this.refresh())}),r(this,"getData",()=>this._isMounted?this._dataset.top():[]),r(this,"getCurrentPageData",()=>{if(this._isMounted){const{rowsPerPage:e}=this.options,{currentPage:s}=this._pagination,a=s*e,n=a+e;return this._dataset.get(a,n)}return[]}),r(this,"refresh",e=>{e?(this.distroy(),this.create()):this._isMounted&&this.updateTable()}),r(this,"distroy",()=>{this._isMounted&&(this.emitLifeCycles("tableWillUnmount"),this._table.remove(),this._styles&&this._styles.length&&(this._styles.remove(),this._styles=null),this._dataset=null,this._table=null,this._thead=null,this._tbody=null,this._pagination.elm&&this._pagination.elm.remove(),this._pagination={elm:null,currentPage:0,totalPages:0,visiblePageNumbers:5},this._isMounted=!1,this._isUpdating=!1,this._sorting={currentCol:"",dir:""},this._cachedViewPort=-1,this._cachedOption=null,this.emitLifeCycles("tableDidUnmount"))}),r(this,"create",()=>{this._isMounted||this.init()}),this.options=jQuery.extend(this._defOptions,t),delete this._defOptions,this._rootElement=jQuery(this.options.element),["classPrefix","buttonClass","activeButtonClass","buttonGroupClass","paginationContainerClass","paginationLeftColumnClass","paginationRightColumnClass"].forEach(e=>{this[e]=this.options[e]}),this.engine=k(),this.html=this.engine.createElement,this.init(),this._debounceUpdateTable()}logError(t,e,s,...a){w(t,`${this._name}.${e} ${s}`,...a)}logWarn(t,e,s){t&&console.warn(`${this._name}.options.${e} ${s}`)}emitLifeCycles(t,...e){if(!this.options)return;const{options:s}=this;b(s[t])&&s[t].apply(this,e)}setVisibleColumns(t){this.options.visibleColumns=t||Object.keys(this.options.columns)}getVisibleColumns(){return this.options.visibleColumns}setPage(t,e){this.logError(l(t),"setPage","expect argument as number");const{totalPages:s}=this._pagination;l(t)&&(t>s-1&&(t=s-1),this._pagination.currentPage=t,e&&this.setCurrentPageData(e),this.updateTable())}clearPageData(){this._pagination.pageData=[]}setTotalPages(t){t===0&&(t=1),this.options.totalPages=this._pagination.totalPages=t,this._pagination.currentPage>t-1&&(this._pagination.currentPage=t-1)}setCurrentPageData(t){this._pagination.pageData[this._pagination.currentPage]=t}updateRowsPerPage(t){if(this.logError(l(t),"updateRowsPerPage","expect argument as number"),!t)return;const{onUpdateRowsPerPage:e}=this.options;this._pagination.currentPage=0,this.options.rowsPerPage=t,e?e(t):this.updateTable()}search(t,e=[]){this.logError(e&&p(e),"search","second argument must be array of keys"),e.length||(e=this.getVisibleColumns()),this._pagination.currentPage=0;const{onSearch:s}=this.options;s?s(t,e):(this._dataset.search(t,e),this.debounceUpdateTable())}lookUp(t,e){return this.search(t,e)}_bindSearchField(){const t=this,{searchField:e}=this.options;if(!e)return;const s=jQuery(e);this.logError(s.length,"searchField",'"%s" is not a valid DOM element or string',s),s.on("input",function(){const a=jQuery(this).val();t.search(a)}),this.options.searchField=s}_validateRootElement(){this.logError(this._rootElement.length,"element",'"%s" is not a valid root element',this._rootElement)}_createTable(){this._table=jQuery("<table></table>").addClass("table "+this.classPrefix)}_initDataset(){const{data:t}=this.options;this.logError(p(t),"data","table-sortable only supports collections. Like: [{ key: value }, { key: value }]");const e=new M;e.fromCollection(t),this._dataset=e}_validateColumns(){const{columns:t}=this.options;this.logError(P(t),"columns","Invalid column type, see docs")}sortData(t){let{dir:e,currentCol:s}=this._sorting;t!==s&&(e=""),e?e===this._dataset.sortDirection.ASC?e=this._dataset.sortDirection.DESC:e===this._dataset.sortDirection.DESC&&(e=this._dataset.sortDirection.ASC):e=this._dataset.sortDirection.ASC,s=t,this._sorting={dir:e,currentCol:s};const{onColumnSort:a}=this.options;a?a.apply(this,[s,e]):(this._dataset.sort(s,e),this.updateCellHeader())}_addColSorting(t,e){const{sorting:s}=this.options,a=this;return s&&(s&&!p(s)&&(t=jQuery(t),t.attr("role","button"),t.addClass(this.classPrefix+"-sortable-column-header"),e===this._sorting.currentCol&&this._sorting.dir&&t.append(this.options.sortingIcons[this._sorting.dir]),t.click(function(n){a.sortData(e)})),p(s)&&v(s,n=>{e===n&&(t=jQuery(t),t.attr("role","button"),t.addClass(this.classPrefix+"-sortable-column-header"),e===this._sorting.currentCol&&this._sorting.dir&&t.append(this.options.sortingIcons[this._sorting.dir]),t.click(function(o){a.sortData(e)}))})),t}getCurrentPageIndex(){const{_datasetLen:t}=this._dataset,{pagination:e,rowsPerPage:s}=this.options,{currentPage:a}=this._pagination;if(!e)return{from:0};let n=a*s;const o=Math.min(n+s,t);return n=Math.min(n,o),{from:n,to:o}}_renderHeader(t){t||(t=jQuery('<thead class="'+this.classPrefix+'-head"></thead>'));const{html:e}=this,{columns:s,formatHeader:a}=this.options,n=[],o=this.getVisibleColumns();v(o,(h,g)=>{let c;b(a)?c=a(s[h],h,g):c=`<div>${s[h]}</div>`,c=this._addColSorting(c,h);const _=e("th",{html:c});n.push(_)});const d=e("tr",null,n);return this.engine.render(d,t)}_renderBody(t){t||(t=jQuery('<tbody class="'+this.classPrefix+'-body"></tbody>'));const e=this.engine,{html:s}=this,{columns:a,formatCell:n}=this.options,{from:o,to:d}=this.getCurrentPageIndex(),{currentPage:h}=this._pagination;let g=[];this._pagination.pageData[h]?g=this._pagination.pageData[h]:d===void 0?g=this._dataset.top():g=this._dataset.get(o,d);const c=[],_=this.getVisibleColumns();return v(g,function(E,C){const T=[];v(_,y=>{const j=s("td",{html:b(n)?n(E,y):E[y+"__display"]!==void 0?E[y+"__display"]:E[y]});T.push(j)}),c.push(s("tr",null,T))}),e.render(c,t)}_createCells(){const t=this._renderHeader(),e=this._renderBody();return{thead:t,tbody:e}}onPaginationBtnClick(t,e){let{totalPages:s,currentPage:a}=this._pagination;const{onPaginationChange:n}=this.options;t==="up"?a<s-1&&(a+=1):t==="down"&&a>=0&&(a-=1);const o=this.setPage.bind(this);if(b(n)){const d=isNaN(e)?a:e;n.apply(this,[d,o])}else e!==void 0?this._pagination.currentPage=e:this._pagination.currentPage=a,this.updateTable()}renderPagination(t){const e=this,s=this.engine,{html:a}=this,{pagination:n,paginationContainer:o,paginationTemplate:d,prevText:h,nextText:g}=this.options;if(!n)return t;const{currentPage:c,totalPages:_,visiblePageNumbers:E}=this._pagination;if(!t){t=jQuery('<div class="'+this.classPrefix+'-pagination"></div>');const u=jQuery(o);u.length?u.append(t):this._rootElement.after(t)}const C=[],T=a("button",{className:this.buttonClass,html:h,disabled:c===0,onClick:()=>e.onPaginationBtnClick("down")});C.push(T);const y=z(c+1,_);for(const u of y){if(u==="..."){C.push(a("button",{className:this.buttonClass,disabled:!0,text:"\u2026"}));continue}const Y=c+1===u,Z=u;C.push(a("button",{className:Y?this.activeButtonClass:this.buttonClass,onClick:function(tt){e.onPaginationBtnClick(null,Z-1)},text:u,"data-page":u}))}const j=a("button",{className:this.buttonClass,html:g,disabled:c>=_-1,onClick:()=>e.onPaginationBtnClick("up")});C.push(j);let R="";if(_>=2){const u=jQuery(`<div>${d}</div>`);u.find('[data-tangible-table-paginator-field="current"]').text(c+1),u.find('[data-tangible-table-paginator-field="total"]').text(_),R=u}const X=a("div",{className:this.paginationContainerClass},[a("div",{className:this.paginationLeftColumnClass},R),a("div",{className:this.paginationRightColumnClass},a("div",{className:this.buttonGroupClass},_<2?"":C))]);return s.render(X,t)}createPagination(){const{pagination:t,totalPages:e,rowsPerPage:s}=this.options;if(!t)return!1;this.logError(s&&l(s),"rowsPerPage","should be a number greater than zero."),this.logError(l(e),"totalPages","should be a number greater than zero.");let a=e||Math.ceil(this._dataset._datasetLen/s);0>=a&&(a=1),this._pagination.totalPages=a,this._pagination.elm?this.renderPagination(this._pagination.elm):this._pagination.elm=this.renderPagination()}_generateTable(t,e){this._table.html(""),this._table.append(t),this._table.append(e),this._thead=t,this._tbody=e}_renderTable(){if(this._rootElement.is("table"))this._rootElement.html(this._table.html());else{const t=this.html("div",{className:this.classPrefix+"-container",append:this._table});this._rootElement=this.engine.render(t,this._rootElement)}}_initStyles(){}init(){this.emitLifeCycles("tableWillMount"),this._validateRootElement(),this._initDataset(),this._createTable(),this.setVisibleColumns(),this._validateColumns();const{thead:t,tbody:e}=this._createCells();this._generateTable(t,e),this._renderTable(),this.createPagination(),this._bindSearchField(),this._initStyles(),this._isMounted=!0,this.emitLifeCycles("tableDidMount"),this._cachedViewPort===-1&&this.resizeSideEffect()}_debounceUpdateTable(){this.debounceUpdateTable=S(this.updateTable,400)}updateTable(){this._isUpdating||(this.emitLifeCycles("tableWillUpdate"),this._isUpdating=!0,this._renderHeader(this._thead),this._renderBody(this._tbody),this.createPagination(),this._isUpdating=!1,this.emitLifeCycles("tableDidUpdate"))}updateCellHeader(){this._isUpdating||(this._isUpdating=!0,this.emitLifeCycles("tableWillUpdate"),this._renderHeader(this._thead),this._renderBody(this._tbody),this._isUpdating=!1,this.emitLifeCycles("tableDidUpdate"))}resizeSideEffect(){const t=S(this.makeResponsive,500);window.addEventListener("resize",t.bind(this)),this.makeResponsive()}makeResponsive(){const{responsive:t}=this.options,{innerWidth:e}=window,s=B(L(t),"desc");let a;if(this.logError(P(t),"responsive",'Invalid type of responsive option provided: "%s"',t),v(s,o=>{parseInt(o,10)>e&&(a=o)}),this._cachedViewPort===a)return;this._cachedViewPort=a;const n=t[a];P(n)?(this._cachedOption||(this._cachedOption=jQuery.extend({},this.options)),this.options=jQuery.extend(this.options,n),this.refresh()):this._cachedOption&&(this.options=jQuery.extend({},this._cachedOption),this._cachedOption=null,this._cachedViewPort=-1,this.refresh())}}D.Pret=k,D.DataSet=M,function(i){i.fn.tangibleTable=function(t){this.each(function(){return t.element=i(this),new D(t)})}}(jQuery);function K(i){if(!i.element.length){console.warn("Tangible table requires element in options",i);return}return new D(i)}window.Tangible=window.Tangible||{},window.Tangible.Table=D,window.Tangible.Table.create=K})();
//# sourceMappingURL=table.min.js.map

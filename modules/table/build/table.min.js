var ht=Object.defineProperty;var b=(L,r)=>ht(L,"name",{value:r,configurable:!0});(function(){"use strict";(function(){const i={NODE_ENV:"production"};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,i);return}}catch{}globalThis.process={env:i}})();var L=Object.defineProperty,r=b((i,t)=>L(i,"name",{value:t,configurable:!0}),"n$1");const p=r(i=>Array.isArray(i),"_isArray"),l=r(i=>typeof i=="number","_isNumber"),E=r(i=>typeof i=="object","_isObject"),y=r(i=>typeof i=="function","_isFunction"),f=r(i=>typeof i=="string","_isString"),W=r(i=>l(parseFloat(i,10)),"_isNumericString"),H=r(i=>{if(Object.prototype.toString.call(i)==="[object Date]"){if(l(i.getTime()))return!0}else if(f(i)){const t=new Date(i);if(l(t.getTime()))return!0}return!1},"_isDate"),z=r((i,t)=>i.sort((e,s)=>t==="asc"?parseInt(e,10)-parseInt(s,10):parseInt(s,10)-parseInt(e,10)),"_sort"),j=r(i=>"keys"in Object?Object.keys(i):Object.getOwnPropertyNames(i),"_keys"),w=r((i,t)=>{if(O(p(i),"ForEach requires array input"),!i.length)return[];y(t)||(t=r(()=>{},"callback"));let e=0,s=i.length;for(;e<s;)t.apply(null,[i[e],e]),e+=1;return i},"_forEach"),G=r((i,t)=>{if(O(p(i),"_filter requires array input"),!i.length)return[];if(!y(t))return i;let e=0,s=i.length,a=[];for(;e<s;)t.apply(null,[i[e],e])&&a.push(i[e]),e+=1;return a},"_filter"),O=r((i,t,...e)=>{let s;if(!i){const a=[...e];let n=0;throw s=new Error(t.replace(/%s/g,()=>a[n++])),s.name="TableSortable Violation",s.framesToPop=1,s}},"_invariant"),Q=r((i,t)=>{if(i===t)return 0;if(l(i))return parseFloat(i)>parseFloat(t)?1:-1;if(!W(i)&&H(i)){const e=new Date(i),s=new Date(t);return console.log("compare",i,t,i>t?1:-1),e.getTime()>s.getTime()?1:-1}return f(i)?i.toLowerCase()>t.toLowerCase()?1:-1:1},"_nativeCompare"),$=r((i,t)=>{let e;return function(){clearTimeout(e),e=window.setTimeout(()=>i.apply(this,arguments),t)}},"debounce"),R=r(i=>f(i)?i.toLowerCase():String(i),"_lower"),J=r((i,t,e=[])=>{if(!t&&!l(t))return!1;const s=j(i);p(e)||(e=s);let a=0,n=s.length,o=!1;const u=R(t);for(;a<n;){const c=s[a],_=R(i[c]);if(e.length&&e.indexOf(c)>-1&&_.indexOf(u)>-1){o=!0;break}if(!e.length&&_.indexOf(u)>-1){o=!0;break}a+=1}return o},"lookInObject");r((i,t)=>p(t)&&t[0]<=i&&t[1]>i,"_inRange");var K=Object.defineProperty,X=b((i,t)=>K(i,"name",{value:t,configurable:!0}),"o$2");let k=b(class{constructor(){this._name="dataset",this.dataset=null,this._cachedData=null,this._datasetLen=0,this._outLen=10,this.sortDirection={ASC:"asc",DESC:"desc"}}_formatError(t,e,s,...a){O(t,`${this._name}.${e} ${s}`,...a)}_hasDataset(){this._formatError(this.dataset!==null,"data",'No source collection is provided. Add your collection to dataset with "dataset.fromCollection([{}])" method.')}fromCollection(t){this._formatError(p(t),"fromCollection","Requires dataset to be a collection, like [{ }]"),this.dataset=t,this._cachedData=JSON.stringify(t),this._datasetLen=t.length}top(t){return this._hasDataset(),t?(this._formatError(l(t),"top","Requires length to be a number"),this.dataset.slice(0,t)):this.dataset.slice(0,this._outLen)}bottom(t){return this._hasDataset(),t?(this._formatError(l(t),"bottom","Requires length to be a number"),t=Math.max(this._datasetLen-t,0),this.dataset.slice(t,this._datasetLen)):(t=Math.max(this._datasetLen-this._outLen,0),this.dataset.slice(t,this._datasetLen))}get(t,e){return this._hasDataset(),this._formatError(l(t),"get",'Requires "from" to be a number'),this._formatError(l(e),"get",'Requires "to" to be a number'),this._formatError(!(t>e),"get",'"from" cannot be greater than "to"'),t=Math.max(t,0),e=Math.min(e,this._datasetLen),this.dataset.slice(t,e)}sort(t,e){this._hasDataset(),this._formatError(f(t),"sort",'Requires "column" type of string'),this._formatError(f(e),"sort",'Requires "direction" type of string'),this._formatError(e==="asc"||e==="desc","sort",'"%s" is invalid sort direction. Use "dataset.sortDirection.ASC" or "dataset.sortDirection.DESC".',e);const s=this.top(1)[0];this._formatError(s[t],"sort",'Column name "%s" does not exist in collection',t);const a=this.sortDirection.ASC===e?1:-1;return this.dataset.sort(function(n,o){return Q(n[t],o[t])*a}),this.top(this._datasetLen)}pushData(t){p(t)&&Array.prototype.push.apply(this.dataset,t)}search(t,e){if(f(t)||l(t)){const s=JSON.parse(this._cachedData);t===""?this.dataset=s:this.dataset=G(s,a=>J(a,t,e)),this._datasetLen=this.dataset.length}}},"h");X(k,"DataSet");var Y=Object.defineProperty,T=b((i,t)=>Y(i,"name",{value:t,configurable:!0}),"l");const A=window.jQuery,Z=T((i,t,e)=>({node:i,attrs:t,children:e}),"constructNode"),tt=T((i,t)=>{if(!t)return i;const e=Object.keys(t);let s=0;for(;s<e.length;){const a=e[s],n=t[a];n!==void 0&&(/^on/.test(a)&&n?i.on(a.replace(/^on/,"").toLowerCase(),n):a==="text"?i.text(n):a==="html"?i.html(n):a==="append"?i.append(n):a==="className"?i.attr("class",n):i.attr(a,n),s+=1)}return i},"addAttrs"),B=T(({node:i,attrs:t,children:e})=>{let s=A(`<${i}></${i}>`);return tt(s,t)},"createElement"),U=T((i,t,e)=>{if(e||t.empty(),f(i)||i instanceof A)t.append(i);else if(p(i)){const s=[];for(let a=0;a<i.length;a++){let n=B(i[a]);i[a].children&&(n=U(i[a].children,n,!0)),s.push(n)}t.append(s)}else if(E(i)){let s=B(i);i.children&&(s=U(i.children,s,!0)),t.append(s)}return t},"renderElement"),F=T(()=>({createElement:Z,render:U}),"Pret");var et=Object.defineProperty,M=b((i,t)=>et(i,"name",{value:t,configurable:!0}),"h");const I=M((i,t)=>Array(t-i+1).fill().map((e,s)=>s+i),"getRange"),it=M((i,t)=>{let e;t<=7?e=7:e=i>4&&i<t-3?2:4;const s={start:Math.round(i-e/2),end:Math.round(i+e/2)};(s.start-1===1||s.end+1===t)&&(s.start+=1,s.end+=1);let a=i>e?I(Math.min(s.start,t-e),Math.min(s.end,t)):I(1,Math.min(t,e+1));const n="...",o=M((u,c)=>a.length+1!==t?c:[u],"withDots");return a[0]!==1&&(a=o(1,[1,n]).concat(a)),a[a.length-1]<t&&(a=a.concat(o(t,[n,t]))),a},"generatePageRange");var st=Object.defineProperty,C=b((i,t)=>st(i,"name",{value:t,configurable:!0}),"p");const h=window.jQuery;class P{constructor(t){this._name="tableSortable",this._defOptions={element:"",data:[],columns:{},visibleColumns:null,classPrefix:"tangible-table",buttonClass:"tangible-table-button",activeButtonClass:"tangible-table-button active",buttonGroupClass:"tangible-table-button-group",paginationContainerClass:"tangible-table-pagination-container",paginationLeftColumnClass:"tangible-table-pagination-left-column",paginationRightColumnClass:"tangible-table-pagination-right-column",sorting:!0,pagination:!0,paginationContainer:null,paginationTemplate:'<span data-tangible-table-paginator-field="current"></span> of <span data-tangible-table-paginator-field="total"></span> pages',rowsPerPage:10,formatCell:null,formatHeader:null,searchField:null,responsive:{},totalPages:0,sortingIcons:{asc:"<span> \u25B2</span>",desc:"<span> \u25BC</span>"},prevText:"<span>\u25C0\uFE0E</span>",nextText:"<span>\u25B6\uFE0E</span>",tableWillMount:()=>{},tableDidMount:()=>{},tableWillUpdate:()=>{},tableDidUpdate:()=>{},tableWillUnmount:()=>{},tableDidUnmount:()=>{},onPaginationChange:null,onColumnSort:null,onSearch:null,onUpdateRowsPerPage:null},this._styles=null,this._dataset=null,this._table=null,this._thead=null,this._tbody=null,this._isMounted=!1,this._isUpdating=!1,this._sorting={currentCol:"",dir:""},this._pagination={elm:null,currentPage:0,totalPages:1,visiblePageNumbers:5,pageData:[]},this._cachedOption=null,this._cachedViewPort=-1,this.setData=C((e,s,a)=>{this.logError(p(e),"setData","expect first argument as array of objects"),this._isMounted&&e&&(a?this._dataset.pushData(e):this._dataset.fromCollection(e),s&&(this.logError(E(s),"setData","expect second argument as objects"),this.options.columns=s),this.refresh())},"setData"),this.getData=C(()=>this._isMounted?this._dataset.top():[],"getData"),this.getCurrentPageData=C(()=>{if(this._isMounted){const{rowsPerPage:e}=this.options,{currentPage:s}=this._pagination,a=s*e,n=a+e;return this._dataset.get(a,n)}return[]},"getCurrentPageData"),this.refresh=C(e=>{e?(this.distroy(),this.create()):this._isMounted&&this.updateTable()},"refresh"),this.distroy=C(()=>{this._isMounted&&(this.emitLifeCycles("tableWillUnmount"),this._table.remove(),this._styles&&this._styles.length&&(this._styles.remove(),this._styles=null),this._dataset=null,this._table=null,this._thead=null,this._tbody=null,this._pagination.elm&&this._pagination.elm.remove(),this._pagination={elm:null,currentPage:0,totalPages:0,visiblePageNumbers:5},this._isMounted=!1,this._isUpdating=!1,this._sorting={currentCol:"",dir:""},this._cachedViewPort=-1,this._cachedOption=null,this.emitLifeCycles("tableDidUnmount"))},"distroy"),this.create=C(()=>{this._isMounted||this.init()},"create"),this.options=h.extend(this._defOptions,t),delete this._defOptions,this._rootElement=h(this.options.element),["classPrefix","buttonClass","activeButtonClass","buttonGroupClass","paginationContainerClass","paginationLeftColumnClass","paginationRightColumnClass"].forEach(e=>{this[e]=this.options[e]}),this.engine=F(),this.html=this.engine.createElement,this.init(),this._debounceUpdateTable()}logError(t,e,s,...a){O(t,`${this._name}.${e} ${s}`,...a)}logWarn(t,e,s){t&&console.warn(`${this._name}.options.${e} ${s}`)}emitLifeCycles(t,...e){if(!this.options)return;const{options:s}=this;y(s[t])&&s[t].apply(this,e)}setVisibleColumns(t){this.options.visibleColumns=t||Object.keys(this.options.columns)}getVisibleColumns(){return this.options.visibleColumns}setPage(t,e){this.logError(l(t),"setPage","expect argument as number");const{totalPages:s}=this._pagination;l(t)&&(t>s-1&&(t=s-1),this._pagination.currentPage=t,e&&this.setCurrentPageData(e),this.updateTable())}clearPageData(){this._pagination.pageData=[]}setTotalPages(t){t===0&&(t=1),this.options.totalPages=this._pagination.totalPages=t,this._pagination.currentPage>t-1&&(this._pagination.currentPage=t-1)}setCurrentPageData(t){this._pagination.pageData[this._pagination.currentPage]=t}updateRowsPerPage(t){if(this.logError(l(t),"updateRowsPerPage","expect argument as number"),!t)return;const{onUpdateRowsPerPage:e}=this.options;this._pagination.currentPage=0,this.options.rowsPerPage=t,e?e(t):this.updateTable()}search(t,e=[]){this.logError(e&&p(e),"search","second argument must be array of keys"),e.length||(e=this.getVisibleColumns()),this._pagination.currentPage=0;const{onSearch:s}=this.options;s?s(t,e):(this._dataset.search(t,e),this.debounceUpdateTable())}lookUp(t,e){return this.search(t,e)}_bindSearchField(){const t=this,{searchField:e}=this.options;if(!e)return;const s=h(e);this.logError(s.length,"searchField",'"%s" is not a valid DOM element or string',s),s.on("input",function(){const a=h(this).val();t.search(a)}),this.options.searchField=s}_validateRootElement(){this.logError(this._rootElement.length,"element",'"%s" is not a valid root element',this._rootElement)}_createTable(){this._table=h("<table></table>").addClass("table "+this.classPrefix)}_initDataset(){const{data:t}=this.options;this.logError(p(t),"data","table-sortable only supports collections. Like: [{ key: value }, { key: value }]");const e=new k;e.fromCollection(t),this._dataset=e}_validateColumns(){const{columns:t}=this.options;this.logError(E(t),"columns","Invalid column type, see docs")}sortData(t){let{dir:e,currentCol:s}=this._sorting;t!==s&&(e=""),e?e===this._dataset.sortDirection.ASC?e=this._dataset.sortDirection.DESC:e===this._dataset.sortDirection.DESC&&(e=this._dataset.sortDirection.ASC):e=this._dataset.sortDirection.ASC,s=t,this._sorting={dir:e,currentCol:s};const{onColumnSort:a}=this.options;a?a.apply(this,[s,e]):(this._dataset.sort(s,e),this.updateCellHeader())}_addColSorting(t,e){const{sorting:s}=this.options,a=this;return s&&(s&&!p(s)&&(t=h(t),t.attr("role","button"),t.addClass(this.classPrefix+"-sortable-column-header"),e===this._sorting.currentCol&&this._sorting.dir&&t.append(this.options.sortingIcons[this._sorting.dir]),t.click(function(n){a.sortData(e)})),p(s)&&w(s,n=>{e===n&&(t=h(t),t.attr("role","button"),t.addClass(this.classPrefix+"-sortable-column-header"),e===this._sorting.currentCol&&this._sorting.dir&&t.append(this.options.sortingIcons[this._sorting.dir]),t.click(function(o){a.sortData(e)}))})),t}getCurrentPageIndex(){const{_datasetLen:t}=this._dataset,{pagination:e,rowsPerPage:s}=this.options,{currentPage:a}=this._pagination;if(!e)return{from:0};let n=a*s;const o=Math.min(n+s,t);return n=Math.min(n,o),{from:n,to:o}}_renderHeader(t){t||(t=h('<thead class="'+this.classPrefix+'-head"></thead>'));const{html:e}=this,{columns:s,formatHeader:a}=this.options,n=[],o=this.getVisibleColumns();w(o,(c,_)=>{let d;y(a)?d=a(s[c],c,_):d=`<div>${s[c]}</div>`,d=this._addColSorting(d,c);const m=e("th",{html:d});n.push(m)});const u=e("tr",null,n);return this.engine.render(u,t)}_renderBody(t){t||(t=h('<tbody class="'+this.classPrefix+'-body"></tbody>'));const e=this.engine,{html:s}=this,{columns:a,formatCell:n}=this.options,{from:o,to:u}=this.getCurrentPageIndex(),{currentPage:c}=this._pagination;let _=[];this._pagination.pageData[c]?_=this._pagination.pageData[c]:u===void 0?_=this._dataset.top():_=this._dataset.get(o,u);const d=[],m=this.getVisibleColumns();return w(_,function(x,v){const S=[];w(m,D=>{const N=s("td",{html:y(n)?n(x,D):x[D+"__display"]!==void 0?x[D+"__display"]:x[D]});S.push(N)}),d.push(s("tr",null,S))}),e.render(d,t)}_createCells(){const t=this._renderHeader(),e=this._renderBody();return{thead:t,tbody:e}}onPaginationBtnClick(t,e){let{totalPages:s,currentPage:a}=this._pagination;const{onPaginationChange:n}=this.options;t==="up"?a<s-1&&(a+=1):t==="down"&&a>=0&&(a-=1);const o=this.setPage.bind(this);if(y(n)){const u=isNaN(e)?a:e;n.apply(this,[u,o])}else e!==void 0?this._pagination.currentPage=e:this._pagination.currentPage=a,this.updateTable()}renderPagination(t){const e=this,s=this.engine,{html:a}=this,{pagination:n,paginationContainer:o,paginationTemplate:u,prevText:c,nextText:_}=this.options;if(!n)return t;const{currentPage:d,totalPages:m,visiblePageNumbers:x}=this._pagination;if(!t){t=h('<div class="'+this.classPrefix+'-pagination"></div>');const g=h(o);g.length?g.append(t):this._rootElement.after(t)}const v=[],S=a("button",{className:this.buttonClass,html:c,disabled:d===0,onClick:()=>e.onPaginationBtnClick("down")});v.push(S);const D=it(d+1,m);for(const g of D){if(g==="..."){v.push(a("button",{className:this.buttonClass,disabled:!0,text:"\u2026"}));continue}const rt=d+1===g,lt=g;v.push(a("button",{className:rt?this.activeButtonClass:this.buttonClass,onClick:function(ct){e.onPaginationBtnClick(null,lt-1)},text:g,"data-page":g}))}const N=a("button",{className:this.buttonClass,html:_,disabled:d>=m-1,onClick:()=>e.onPaginationBtnClick("up")});v.push(N);let q="";if(m>=2){const g=h(`<div>${u}</div>`);g.find('[data-tangible-table-paginator-field="current"]').text(d+1),g.find('[data-tangible-table-paginator-field="total"]').text(m),q=g}const ot=a("div",{className:this.paginationContainerClass},[a("div",{className:this.paginationLeftColumnClass},q),a("div",{className:this.paginationRightColumnClass},a("div",{className:this.buttonGroupClass},m<2?"":v))]);return s.render(ot,t)}createPagination(){const{pagination:t,totalPages:e,rowsPerPage:s}=this.options;if(!t)return!1;this.logError(s&&l(s),"rowsPerPage","should be a number greater than zero."),this.logError(l(e),"totalPages","should be a number greater than zero.");let a=e||Math.ceil(this._dataset._datasetLen/s);0>=a&&(a=1),this._pagination.totalPages=a,this._pagination.elm?this.renderPagination(this._pagination.elm):this._pagination.elm=this.renderPagination()}_generateTable(t,e){this._table.html(""),this._table.append(t),this._table.append(e),this._thead=t,this._tbody=e}_renderTable(){if(this._rootElement.is("table"))this._rootElement.html(this._table.html());else{const t=this.html("div",{className:this.classPrefix+"-container",append:this._table});this._rootElement=this.engine.render(t,this._rootElement)}}_initStyles(){}init(){this.emitLifeCycles("tableWillMount"),this._validateRootElement(),this._initDataset(),this._createTable(),this.setVisibleColumns(),this._validateColumns();const{thead:t,tbody:e}=this._createCells();this._generateTable(t,e),this._renderTable(),this.createPagination(),this._bindSearchField(),this._initStyles(),this._isMounted=!0,this.emitLifeCycles("tableDidMount"),this._cachedViewPort===-1&&this.resizeSideEffect()}_debounceUpdateTable(){this.debounceUpdateTable=$(this.updateTable,400)}updateTable(){this._isUpdating||(this.emitLifeCycles("tableWillUpdate"),this._isUpdating=!0,this._renderHeader(this._thead),this._renderBody(this._tbody),this.createPagination(),this._isUpdating=!1,this.emitLifeCycles("tableDidUpdate"))}updateCellHeader(){this._isUpdating||(this._isUpdating=!0,this.emitLifeCycles("tableWillUpdate"),this._renderHeader(this._thead),this._renderBody(this._tbody),this._isUpdating=!1,this.emitLifeCycles("tableDidUpdate"))}resizeSideEffect(){const t=$(this.makeResponsive,500);window.addEventListener("resize",t.bind(this)),this.makeResponsive()}makeResponsive(){const{responsive:t}=this.options,{innerWidth:e}=window,s=z(j(t),"desc");let a;if(this.logError(E(t),"responsive",'Invalid type of responsive option provided: "%s"',t),w(s,o=>{parseInt(o,10)>e&&(a=o)}),this._cachedViewPort===a)return;this._cachedViewPort=a;const n=t[a];E(n)?(this._cachedOption||(this._cachedOption=h.extend({},this.options)),this.options=h.extend(this.options,n),this.refresh()):this._cachedOption&&(this.options=h.extend({},this._cachedOption),this._cachedOption=null,this._cachedViewPort=-1,this.refresh())}}b(P,"C"),C(P,"TableSortable"),P.Pret=F,P.DataSet=k,function(i){i.fn.tangibleTable=function(t){this.each(function(){return t.element=i(this),new P(t)})}}(jQuery);var at=Object.defineProperty,nt=b((i,t)=>at(i,"name",{value:t,configurable:!0}),"n");function V(i){if(!i.element.length){console.warn("Tangible table requires element in options",i);return}return new P(i)}b(V,"r"),nt(V,"create"),window.Tangible=window.Tangible||{},window.Tangible.Table=P,window.Tangible.Table.create=V})();
//# sourceMappingURL=table.min.js.map

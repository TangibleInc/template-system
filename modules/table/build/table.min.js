var dt=Object.defineProperty;var u=(k,r)=>dt(k,"name",{value:r,configurable:!0});(function(){"use strict";(function(){const i={env:{NODE_ENV:"production"}};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,i);return}}catch(t){}globalThis.process={env:i}})();var k=Object.defineProperty,r=u((i,t)=>k(i,"name",{value:t,configurable:!0}),"n$2");const g=r(i=>Array.isArray(i),"_isArray"),h=r(i=>typeof i=="number","_isNumber"),w=r(i=>typeof i=="object","_isObject"),P=r(i=>typeof i=="function","_isFunction"),f=r(i=>typeof i=="string","_isString"),H=r(i=>h(parseFloat(i,10)),"_isNumericString"),z=r(i=>{if(Object.prototype.toString.call(i)==="[object Date]"){if(h(i.getTime()))return!0}else if(f(i)){const t=new Date(i);if(h(t.getTime()))return!0}return!1},"_isDate"),G=r((i,t)=>i.sort((e,s)=>t==="asc"?parseInt(e,10)-parseInt(s,10):parseInt(s,10)-parseInt(e,10)),"_sort"),$=r(i=>"keys"in Object?Object.keys(i):Object.getOwnPropertyNames(i),"_keys"),T=r((i,t)=>{if(O(g(i),"ForEach requires array input"),!i.length)return[];P(t)||(t=r(()=>{},"callback"));let e=0,s=i.length;for(;e<s;)t.apply(null,[i[e],e]),e+=1;return i},"_forEach"),J=r((i,t)=>{if(O(g(i),"_filter requires array input"),!i.length)return[];if(!P(t))return i;let e=0,s=i.length,a=[];for(;e<s;)t.apply(null,[i[e],e])&&a.push(i[e]),e+=1;return a},"_filter"),O=r((i,t,...e)=>{let s;if(!i){const a=[...e];let n=0;throw s=new Error(t.replace(/%s/g,()=>a[n++])),s.name="TableSortable Violation",s.framesToPop=1,s}},"_invariant"),K=r((i,t)=>{if(i===t)return 0;if(h(i))return parseFloat(i)>parseFloat(t)?1:-1;if(!H(i)&&z(i)){const e=new Date(i),s=new Date(t);return console.log("compare",i,t,i>t?1:-1),e.getTime()>s.getTime()?1:-1}return f(i)?i.toLowerCase()>t.toLowerCase()?1:-1:1},"_nativeCompare"),R=r((i,t)=>{let e;return function(){clearTimeout(e),e=window.setTimeout(()=>i.apply(this,arguments),t)}},"debounce"),Q=r(i=>f(i)?i.toLowerCase():String(i),"_lower"),X=r((i,t,e=[])=>{if(!t&&!h(t))return!1;const s=$(i);g(e)||(e=s);let a=0,n=s.length,o=!1;const p=Q(t);for(;a<n;){const c=s[a],b=Q(i[c]);if(e.length&&e.indexOf(c)>-1&&b.indexOf(p)>-1){o=!0;break}if(!e.length&&b.indexOf(p)>-1){o=!0;break}a+=1}return o},"lookInObject");r((i,t)=>g(t)&&t[0]<=i&&t[1]>i,"_inRange");var A=Object.defineProperty,Y=u((i,t,e)=>t in i?A(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,"m$1"),Z=u((i,t)=>A(i,"name",{value:t,configurable:!0}),"n$1"),v=u((i,t,e)=>(Y(i,typeof t!="symbol"?t+"":t,e),e),"r$1");class S{constructor(){v(this,"_name","dataset"),v(this,"dataset",null),v(this,"_cachedData",null),v(this,"_datasetLen",0),v(this,"_outLen",10),v(this,"sortDirection",{ASC:"asc",DESC:"desc"})}_formatError(t,e,s,...a){O(t,`${this._name}.${e} ${s}`,...a)}_hasDataset(){this._formatError(this.dataset!==null,"data",'No source collection is provided. Add your collection to dataset with "dataset.fromCollection([{}])" method.')}fromCollection(t){this._formatError(g(t),"fromCollection","Requires dataset to be a collection, like [{ }]"),this.dataset=t,this._cachedData=JSON.stringify(t),this._datasetLen=t.length}top(t){return this._hasDataset(),t?(this._formatError(h(t),"top","Requires length to be a number"),this.dataset.slice(0,t)):this.dataset.slice(0,this._outLen)}bottom(t){return this._hasDataset(),t?(this._formatError(h(t),"bottom","Requires length to be a number"),t=Math.max(this._datasetLen-t,0),this.dataset.slice(t,this._datasetLen)):(t=Math.max(this._datasetLen-this._outLen,0),this.dataset.slice(t,this._datasetLen))}get(t,e){return this._hasDataset(),this._formatError(h(t),"get",'Requires "from" to be a number'),this._formatError(h(e),"get",'Requires "to" to be a number'),this._formatError(!(t>e),"get",'"from" cannot be greater than "to"'),t=Math.max(t,0),e=Math.min(e,this._datasetLen),this.dataset.slice(t,e)}sort(t,e){this._hasDataset(),this._formatError(f(t),"sort",'Requires "column" type of string'),this._formatError(f(e),"sort",'Requires "direction" type of string'),this._formatError(e==="asc"||e==="desc","sort",'"%s" is invalid sort direction. Use "dataset.sortDirection.ASC" or "dataset.sortDirection.DESC".',e);const s=this.top(1)[0];this._formatError(s[t],"sort",'Column name "%s" does not exist in collection',t);const a=this.sortDirection.ASC===e?1:-1;return this.dataset.sort(function(n,o){return K(n[t],o[t])*a}),this.top(this._datasetLen)}pushData(t){g(t)&&Array.prototype.push.apply(this.dataset,t)}search(t,e){if(f(t)||h(t)){const s=JSON.parse(this._cachedData);t===""?this.dataset=s:this.dataset=J(s,a=>X(a,t,e)),this._datasetLen=this.dataset.length}}}u(S,"_"),Z(S,"DataSet");var tt=Object.defineProperty,j=u((i,t)=>tt(i,"name",{value:t,configurable:!0}),"l");const et=j((i,t,e)=>({node:i,attrs:t,children:e}),"constructNode"),it=j((i,t)=>{if(!t)return i;const e=Object.keys(t);let s=0;for(;s<e.length;){const a=e[s],n=t[a];n!==void 0&&(/^on/.test(a)&&n?i.on(a.replace(/^on/,"").toLowerCase(),n):a==="text"?i.text(n):a==="html"?i.html(n):a==="append"?i.append(n):a==="className"?i.attr("class",n):i.attr(a,n),s+=1)}return i},"addAttrs"),B=j(({node:i,attrs:t,children:e})=>{let s=jQuery(`<${i}></${i}>`);return it(s,t)},"createElement"),M=j((i,t,e)=>{if(e||t.empty(),f(i)||i instanceof jQuery)t.append(i);else if(g(i)){const s=[];for(let a=0;a<i.length;a++){let n=B(i[a]);i[a].children&&(n=M(i[a].children,n,!0)),s.push(n)}t.append(s)}else if(w(i)){let s=B(i);i.children&&(s=M(i.children,s,!0)),t.append(s)}return t},"renderElement"),F=j(()=>({createElement:et,render:M}),"Pret");var st=Object.defineProperty,N=u((i,t)=>st(i,"name",{value:t,configurable:!0}),"h");const I=N((i,t)=>Array(t-i+1).fill().map((e,s)=>s+i),"getRange"),at=N((i,t)=>{let e;t<=7?e=7:e=i>4&&i<t-3?2:4;const s={start:Math.round(i-e/2),end:Math.round(i+e/2)};(s.start-1===1||s.end+1===t)&&(s.start+=1,s.end+=1);let a=i>e?I(Math.min(s.start,t-e),Math.min(s.end,t)):I(1,Math.min(t,e+1));const n="...",o=N((p,c)=>a.length+1!==t?c:[p],"withDots");return a[0]!==1&&(a=o(1,[1,n]).concat(a)),a[a.length-1]<t&&(a=a.concat(o(t,[n,t]))),a},"generatePageRange");var V=Object.defineProperty,nt=u((i,t,e)=>t in i?V(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,"L"),C=u((i,t)=>V(i,"name",{value:t,configurable:!0}),"f"),l=u((i,t,e)=>(nt(i,typeof t!="symbol"?t+"":t,e),e),"o");class y{constructor(t){l(this,"_name","tableSortable"),l(this,"_defOptions",{element:"",data:[],columns:{},visibleColumns:null,classPrefix:"tangible-table",buttonClass:"tangible-table-button",activeButtonClass:"tangible-table-button active",buttonGroupClass:"tangible-table-button-group",paginationContainerClass:"tangible-table-pagination-container",paginationLeftColumnClass:"tangible-table-pagination-left-column",paginationRightColumnClass:"tangible-table-pagination-right-column",sorting:!0,pagination:!0,paginationContainer:null,paginationTemplate:'<span data-tangible-table-paginator-field="current"></span> of <span data-tangible-table-paginator-field="total"></span> pages',rowsPerPage:10,formatCell:null,formatHeader:null,searchField:null,responsive:{},totalPages:0,sortingIcons:{asc:"<span> \u25B2</span>",desc:"<span> \u25BC</span>"},prevText:"<span>\u25C0\uFE0E</span>",nextText:"<span>\u25B6\uFE0E</span>",tableWillMount:()=>{},tableDidMount:()=>{},tableWillUpdate:()=>{},tableDidUpdate:()=>{},tableWillUnmount:()=>{},tableDidUnmount:()=>{},onPaginationChange:null,onColumnSort:null,onSearch:null,onUpdateRowsPerPage:null}),l(this,"_styles",null),l(this,"_dataset",null),l(this,"_table",null),l(this,"_thead",null),l(this,"_tbody",null),l(this,"_isMounted",!1),l(this,"_isUpdating",!1),l(this,"_sorting",{currentCol:"",dir:""}),l(this,"_pagination",{elm:null,currentPage:0,totalPages:1,visiblePageNumbers:5,pageData:[]}),l(this,"_cachedOption",null),l(this,"_cachedViewPort",-1),l(this,"setData",C((e,s,a)=>{this.logError(g(e),"setData","expect first argument as array of objects"),this._isMounted&&e&&(a?this._dataset.pushData(e):this._dataset.fromCollection(e),s&&(this.logError(w(s),"setData","expect second argument as objects"),this.options.columns=s),this.refresh())},"setData")),l(this,"getData",C(()=>this._isMounted?this._dataset.top():[],"getData")),l(this,"getCurrentPageData",C(()=>{if(this._isMounted){const{rowsPerPage:e}=this.options,{currentPage:s}=this._pagination,a=s*e,n=a+e;return this._dataset.get(a,n)}return[]},"getCurrentPageData")),l(this,"refresh",C(e=>{e?(this.distroy(),this.create()):this._isMounted&&this.updateTable()},"refresh")),l(this,"distroy",C(()=>{this._isMounted&&(this.emitLifeCycles("tableWillUnmount"),this._table.remove(),this._styles&&this._styles.length&&(this._styles.remove(),this._styles=null),this._dataset=null,this._table=null,this._thead=null,this._tbody=null,this._pagination.elm&&this._pagination.elm.remove(),this._pagination={elm:null,currentPage:0,totalPages:0,visiblePageNumbers:5},this._isMounted=!1,this._isUpdating=!1,this._sorting={currentCol:"",dir:""},this._cachedViewPort=-1,this._cachedOption=null,this.emitLifeCycles("tableDidUnmount"))},"distroy")),l(this,"create",C(()=>{this._isMounted||this.init()},"create")),this.options=jQuery.extend(this._defOptions,t),delete this._defOptions,this._rootElement=jQuery(this.options.element),["classPrefix","buttonClass","activeButtonClass","buttonGroupClass","paginationContainerClass","paginationLeftColumnClass","paginationRightColumnClass"].forEach(e=>{this[e]=this.options[e]}),this.engine=F(),this.html=this.engine.createElement,this.init(),this._debounceUpdateTable()}logError(t,e,s,...a){O(t,`${this._name}.${e} ${s}`,...a)}logWarn(t,e,s){t&&console.warn(`${this._name}.options.${e} ${s}`)}emitLifeCycles(t,...e){if(!this.options)return;const{options:s}=this;P(s[t])&&s[t].apply(this,e)}setVisibleColumns(t){this.options.visibleColumns=t||Object.keys(this.options.columns)}getVisibleColumns(){return this.options.visibleColumns}setPage(t,e){this.logError(h(t),"setPage","expect argument as number");const{totalPages:s}=this._pagination;h(t)&&(t>s-1&&(t=s-1),this._pagination.currentPage=t,e&&this.setCurrentPageData(e),this.updateTable())}clearPageData(){this._pagination.pageData=[]}setTotalPages(t){t===0&&(t=1),this.options.totalPages=this._pagination.totalPages=t,this._pagination.currentPage>t-1&&(this._pagination.currentPage=t-1)}setCurrentPageData(t){this._pagination.pageData[this._pagination.currentPage]=t}updateRowsPerPage(t){if(this.logError(h(t),"updateRowsPerPage","expect argument as number"),!t)return;const{onUpdateRowsPerPage:e}=this.options;this._pagination.currentPage=0,this.options.rowsPerPage=t,e?e(t):this.updateTable()}search(t,e=[]){this.logError(e&&g(e),"search","second argument must be array of keys"),e.length||(e=this.getVisibleColumns()),this._pagination.currentPage=0;const{onSearch:s}=this.options;s?s(t,e):(this._dataset.search(t,e),this.debounceUpdateTable())}lookUp(t,e){return this.search(t,e)}_bindSearchField(){const t=this,{searchField:e}=this.options;if(!e)return;const s=jQuery(e);this.logError(s.length,"searchField",'"%s" is not a valid DOM element or string',s),s.on("input",function(){const a=jQuery(this).val();t.search(a)}),this.options.searchField=s}_validateRootElement(){this.logError(this._rootElement.length,"element",'"%s" is not a valid root element',this._rootElement)}_createTable(){this._table=jQuery("<table></table>").addClass("table "+this.classPrefix)}_initDataset(){const{data:t}=this.options;this.logError(g(t),"data","table-sortable only supports collections. Like: [{ key: value }, { key: value }]");const e=new S;e.fromCollection(t),this._dataset=e}_validateColumns(){const{columns:t}=this.options;this.logError(w(t),"columns","Invalid column type, see docs")}sortData(t){let{dir:e,currentCol:s}=this._sorting;t!==s&&(e=""),e?e===this._dataset.sortDirection.ASC?e=this._dataset.sortDirection.DESC:e===this._dataset.sortDirection.DESC&&(e=this._dataset.sortDirection.ASC):e=this._dataset.sortDirection.ASC,s=t,this._sorting={dir:e,currentCol:s};const{onColumnSort:a}=this.options;a?a.apply(this,[s,e]):(this._dataset.sort(s,e),this.updateCellHeader())}_addColSorting(t,e){const{sorting:s}=this.options,a=this;return s&&(s&&!g(s)&&(t=jQuery(t),t.attr("role","button"),t.addClass(this.classPrefix+"-sortable-column-header"),e===this._sorting.currentCol&&this._sorting.dir&&t.append(this.options.sortingIcons[this._sorting.dir]),t.click(function(n){a.sortData(e)})),g(s)&&T(s,n=>{e===n&&(t=jQuery(t),t.attr("role","button"),t.addClass(this.classPrefix+"-sortable-column-header"),e===this._sorting.currentCol&&this._sorting.dir&&t.append(this.options.sortingIcons[this._sorting.dir]),t.click(function(o){a.sortData(e)}))})),t}getCurrentPageIndex(){const{_datasetLen:t}=this._dataset,{pagination:e,rowsPerPage:s}=this.options,{currentPage:a}=this._pagination;if(!e)return{from:0};let n=a*s;const o=Math.min(n+s,t);return n=Math.min(n,o),{from:n,to:o}}_renderHeader(t){t||(t=jQuery('<thead class="'+this.classPrefix+'-head"></thead>'));const{html:e}=this,{columns:s,formatHeader:a}=this.options,n=[],o=this.getVisibleColumns();T(o,(c,b)=>{let d;P(a)?d=a(s[c],c,b):d=`<div>${s[c]}</div>`,d=this._addColSorting(d,c);const m=e("th",{html:d});n.push(m)});const p=e("tr",null,n);return this.engine.render(p,t)}_renderBody(t){t||(t=jQuery('<tbody class="'+this.classPrefix+'-body"></tbody>'));const e=this.engine,{html:s}=this,{columns:a,formatCell:n}=this.options,{from:o,to:p}=this.getCurrentPageIndex(),{currentPage:c}=this._pagination;let b=[];this._pagination.pageData[c]?b=this._pagination.pageData[c]:p===void 0?b=this._dataset.top():b=this._dataset.get(o,p);const d=[],m=this.getVisibleColumns();return T(b,function(x,D){const L=[];T(m,E=>{const U=s("td",{html:P(n)?n(x,E):x[E+"__display"]!==void 0?x[E+"__display"]:x[E]});L.push(U)}),d.push(s("tr",null,L))}),e.render(d,t)}_createCells(){const t=this._renderHeader(),e=this._renderBody();return{thead:t,tbody:e}}onPaginationBtnClick(t,e){let{totalPages:s,currentPage:a}=this._pagination;const{onPaginationChange:n}=this.options;t==="up"?a<s-1&&(a+=1):t==="down"&&a>=0&&(a-=1);const o=this.setPage.bind(this);if(P(n)){const p=isNaN(e)?a:e;n.apply(this,[p,o])}else e!==void 0?this._pagination.currentPage=e:this._pagination.currentPage=a,this.updateTable()}renderPagination(t){const e=this,s=this.engine,{html:a}=this,{pagination:n,paginationContainer:o,paginationTemplate:p,prevText:c,nextText:b}=this.options;if(!n)return t;const{currentPage:d,totalPages:m,visiblePageNumbers:x}=this._pagination;if(!t){t=jQuery('<div class="'+this.classPrefix+'-pagination"></div>');const _=jQuery(o);_.length?_.append(t):this._rootElement.after(t)}const D=[],L=a("button",{className:this.buttonClass,html:c,disabled:d===0,onClick:()=>e.onPaginationBtnClick("down")});D.push(L);const E=at(d+1,m);for(const _ of E){if(_==="..."){D.push(a("button",{className:this.buttonClass,disabled:!0,text:"\u2026"}));continue}const ht=d+1===_,ct=_;D.push(a("button",{className:ht?this.activeButtonClass:this.buttonClass,onClick:function(ut){e.onPaginationBtnClick(null,ct-1)},text:_,"data-page":_}))}const U=a("button",{className:this.buttonClass,html:b,disabled:d>=m-1,onClick:()=>e.onPaginationBtnClick("up")});D.push(U);let W="";if(m>=2){const _=jQuery(`<div>${p}</div>`);_.find('[data-tangible-table-paginator-field="current"]').text(d+1),_.find('[data-tangible-table-paginator-field="total"]').text(m),W=_}const lt=a("div",{className:this.paginationContainerClass},[a("div",{className:this.paginationLeftColumnClass},W),a("div",{className:this.paginationRightColumnClass},a("div",{className:this.buttonGroupClass},m<2?"":D))]);return s.render(lt,t)}createPagination(){const{pagination:t,totalPages:e,rowsPerPage:s}=this.options;if(!t)return!1;this.logError(s&&h(s),"rowsPerPage","should be a number greater than zero."),this.logError(h(e),"totalPages","should be a number greater than zero.");let a=e||Math.ceil(this._dataset._datasetLen/s);0>=a&&(a=1),this._pagination.totalPages=a,this._pagination.elm?this.renderPagination(this._pagination.elm):this._pagination.elm=this.renderPagination()}_generateTable(t,e){this._table.html(""),this._table.append(t),this._table.append(e),this._thead=t,this._tbody=e}_renderTable(){if(this._rootElement.is("table"))this._rootElement.html(this._table.html());else{const t=this.html("div",{className:this.classPrefix+"-container",append:this._table});this._rootElement=this.engine.render(t,this._rootElement)}}_initStyles(){}init(){this.emitLifeCycles("tableWillMount"),this._validateRootElement(),this._initDataset(),this._createTable(),this.setVisibleColumns(),this._validateColumns();const{thead:t,tbody:e}=this._createCells();this._generateTable(t,e),this._renderTable(),this.createPagination(),this._bindSearchField(),this._initStyles(),this._isMounted=!0,this.emitLifeCycles("tableDidMount"),this._cachedViewPort===-1&&this.resizeSideEffect()}_debounceUpdateTable(){this.debounceUpdateTable=R(this.updateTable,400)}updateTable(){this._isUpdating||(this.emitLifeCycles("tableWillUpdate"),this._isUpdating=!0,this._renderHeader(this._thead),this._renderBody(this._tbody),this.createPagination(),this._isUpdating=!1,this.emitLifeCycles("tableDidUpdate"))}updateCellHeader(){this._isUpdating||(this._isUpdating=!0,this.emitLifeCycles("tableWillUpdate"),this._renderHeader(this._thead),this._renderBody(this._tbody),this._isUpdating=!1,this.emitLifeCycles("tableDidUpdate"))}resizeSideEffect(){const t=R(this.makeResponsive,500);window.addEventListener("resize",t.bind(this)),this.makeResponsive()}makeResponsive(){const{responsive:t}=this.options,{innerWidth:e}=window,s=G($(t),"desc");let a;if(this.logError(w(t),"responsive",'Invalid type of responsive option provided: "%s"',t),T(s,o=>{parseInt(o,10)>e&&(a=o)}),this._cachedViewPort===a)return;this._cachedViewPort=a;const n=t[a];w(n)?(this._cachedOption||(this._cachedOption=jQuery.extend({},this.options)),this.options=jQuery.extend(this.options,n),this.refresh()):this._cachedOption&&(this.options=jQuery.extend({},this._cachedOption),this._cachedOption=null,this._cachedViewPort=-1,this.refresh())}}u(y,"P"),C(y,"TableSortable"),y.Pret=F,y.DataSet=S,function(i){i.fn.tangibleTable=function(t){this.each(function(){return t.element=i(this),new y(t)})}}(jQuery);var ot=Object.defineProperty,rt=u((i,t)=>ot(i,"name",{value:t,configurable:!0}),"n");function q(i){if(!i.element.length){console.warn("Tangible table requires element in options",i);return}return new y(i)}u(q,"r"),rt(q,"create"),window.Tangible=window.Tangible||{},window.Tangible.Table=y,window.Tangible.Table.create=q})();
//# sourceMappingURL=table.min.js.map

var je=Object.defineProperty;var o=(P,k)=>je(P,"name",{value:k,configurable:!0});(function(){"use strict";var v,y;(function(){const r={NODE_ENV:"production"};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,r);return}}catch{}globalThis.process={env:r}})();function P(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}o(P,"getDefaultExportFromCjs");var k=o(function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var l,n,p;if(Array.isArray(e)){if(l=e.length,l!=t.length)return!1;for(n=l;n--!==0;)if(!r(e[n],t[n]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(n of e.entries())if(!t.has(n[0]))return!1;for(n of e.entries())if(!r(n[1],t.get(n[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(n of e.entries())if(!t.has(n[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(l=e.length,l!=t.length)return!1;for(n=l;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(p=Object.keys(e),l=p.length,l!==Object.keys(t).length)return!1;for(n=l;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,p[n]))return!1;for(n=l;n--!==0;){var T=p[n];if(!r(e[T],t[T]))return!1}return!0}return e!==e&&t!==t},"equal"),ce=P(k),pe=Object.defineProperty,u=o((r,e)=>pe(r,"name",{value:e,configurable:!0}),"s$1");const{wp:a}=window,{apiFetch:ue,blocks:{__experimentalSanitizeBlockAttributes:me,sanitizeBlockAttributes:Le},components:{Placeholder:z,Spinner:de},compose:{useDebounce:fe,usePrevious:he},element:{RawHTML:H,useEffect:w,useRef:C,useState:_},i18n:{__:x,sprintf:Ee},url:{addQueryArgs:be}}=a;function D({className:r,children:e,onMount:t}){const l=C();return w(()=>{t&&t(l.current)},[]),a.element.createElement("div",{ref:l,className:"tangible-server-side-render"},a.element.createElement(H,{className:r},e))}o(D,"U"),u(D,"Content");const ge={};function V(r,e=null,t={}){return be(`/wp/v2/block-renderer/${r}`,{context:"edit",...e!==null?{attributes:e}:{},...t})}o(V,"rendererPath"),u(V,"rendererPath");function F(r){const{backgroundColor:e,borderColor:t,fontFamily:l,fontSize:n,gradient:p,textColor:T,className:ee,...B}=r,{border:te,color:re,elements:f,spacing:ne,typography:le,...h}=r?.style||ge;return{...B,style:h}}o(F,"removeBlockSupportAttributes"),u(F,"removeBlockSupportAttributes");function I({className:r}){return a.element.createElement(z,{className:r},x("Block rendered as empty."))}o(I,"W$1"),u(I,"DefaultEmptyResponsePlaceholder");function U({response:r,className:e}){const t=Ee(x("Error loading block: %s"),r.errorMsg);return a.element.createElement(z,{className:e},t)}o(U,"X"),u(U,"DefaultErrorResponsePlaceholder");function G({children:r,showLoader:e}){return a.element.createElement("div",{style:{position:"relative"}},e&&a.element.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",marginTop:"-9px",marginLeft:"-9px"}},a.element.createElement(de,null)),a.element.createElement("div",{style:{opacity:e?"0.3":1}},r))}o(G,"Z"),u(G,"DefaultLoadingResponsePlaceholder");function R(r){const{attributes:e,block:t,className:l,httpMethod:n="GET",urlQueryArgs:p,skipBlockSupportAttributes:T=!1,EmptyResponsePlaceholder:ee=I,ErrorResponsePlaceholder:B=U,LoadingResponsePlaceholder:te=G,onFetchResponseRendered:re}=r,f=C(!0),[ne,le]=_(!1),h=C(),[E,se]=_(null),oe=he(r),[j,ae]=_(!1);function L(){if(!f.current)return;ae(!0);let b=e&&me(t,e);T&&(b=F(b));const $=n==="POST",Ae=V(t,$?null:b??null,p),Be=$?{attributes:b??null}:null,S=h.current=ue({path:Ae,data:Be,method:$?"POST":"GET"}).then(O=>{f.current&&S===h.current&&O&&se(O.rendered)}).catch(O=>{f.current&&S===h.current&&se({error:!0,errorMsg:O.message})}).finally(()=>{f.current&&S===h.current&&ae(!1)});return S}o(L,"x"),u(L,"fetchData");const Re=fe(L,500);w(()=>()=>{f.current=!1},[]),w(()=>{oe===void 0?L():ce(oe,r)||Re()}),w(()=>{if(!j)return;const b=setTimeout(()=>{le(!0)},1e3);return()=>clearTimeout(b)},[j]);const ie=!!E,Me=E==="",Ne=E?.error;return j?a.element.createElement(te,{...r,showLoader:ne},ie&&a.element.createElement(H,{className:l},E)):Me||!ie?a.element.createElement(ee,{...r}):Ne?a.element.createElement(B,{response:E,...r}):a.element.createElement(D,{className:l,onMount:re},E)}o(R,"w$1"),u(R,"ServerSideRender");var K=Object.defineProperty,ve=o((r,e,t)=>e in r?K(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,"E"),g=o((r,e)=>K(r,"name",{value:e,configurable:!0}),"p"),M=o((r,e,t)=>(ve(r,typeof e!="symbol"?e+"":e,t),t),"m");const{wp:s,Tangible:Q,lodash:$e}=window,{element:{Component:W},blockEditor:{BlockControls:ye,InspectorControls:ze},blocks:{registerBlockType:Te},components:{Button:N,DropdownMenu:He,KeyboardShortcuts:we,SelectControl:Se,TextControl:xe,ToolbarItem:De,ToolbarButton:Ve,ToolbarGroup:q,Panel:Fe,PanelBody:Ie,PanelRow:Ue,withConstrainedTabbing:Ge},i18n:{__:d},keycodes:{rawShortcut:c}}=s,{createCodeEditor:Oe,gutenbergConfig:A,moduleLoader:Pe}=Q;Q.ServerSideRender=R;const i=g(r=>r.stopImmediatePropagation(),"stop"),ke={tab:i,[c.shift("tab")]:i,[c.ctrl("[")]:i,[c.primary("[")]:i,[c.ctrl("]")]:i,[c.primary("]")]:i,[c.ctrl("a")]:i,[c.primary("a")]:i,[c.ctrl("d")]:i,[c.primary("d")]:i,[c.ctrl("z")]:i,[c.ctrlShift("z")]:i,[c.primary("z")]:i,[c.primaryShift("z")]:i},J=g(()=>s.element.createElement("div",null,"\xA0"),"EmptyTemplate"),X=(v=class extends W{constructor(){super(...arguments),M(this,"onEditorUpdate",g(()=>{const{onChange:e}=this.props;e&&e(this.editor.getValue())},"onEditorUpdate"))}componentDidMount(){(async()=>{const e=await Oe(this.el,{language:"html",resizable:!0});e.setSize(null,"100%"),this.editor=e,this.editor.on("change",this.onEditorUpdate),s.editSite&&setTimeout(function(){e.refresh()},120)})().catch(console.error)}componentWillUnmount(){this.editor.off("change",this.onEditorUpdate)}shouldComponentUpdate(){return!1}render(){const{value:e,onChange:t}=this.props;return s.element.createElement(we,{shortcuts:ke},s.element.createElement("textarea",{ref:l=>this.el=l,value:e,onChange:l=>{t(l.target.value)},style:{display:"none"},cols:"30",rows:"10"}))}},o(v,"g"),v);g(X,"TemplateEditor");let Ce=X;const Y=(y=class extends W{constructor(e){super(e),M(this,"canEditTemplate",A.canEditTemplate),M(this,"state",{currentTab:this.props.attributes.template_selected||!this.canEditTemplate?"selectTemplate":"editor",previouslySelectedTemplate:0}),this.props.attributes.current_post_id=A.current_post_id||0,this.templateOptions=[];const t=A.templateOptions,l=Object.keys(t);for(const n of l)this.templateOptions.push({value:n&&parseInt(n,10),label:t[n]})}showTab(e){this.state.currentTab!==e&&(this.setState({currentTab:e}),e==="editor"?(console.log("Save",this.props.attributes.template_selected),this.setState({previouslySelectedTemplate:this.props.attributes.template_selected}),this.props.attributes.template_selected&&this.props.setAttributes({template_selected:0})):e==="selectTemplate"&&(this.props.attributes.template_selected||(console.log("Restore",this.props.attributes.template_selected),this.props.setAttributes({template_selected:this.state.previouslySelectedTemplate?this.state.previouslySelectedTemplate:this.templateOptions[0]&&this.templateOptions[0].value?this.templateOptions[0].value:0}))))}render(){const{className:e,attributes:t,setAttributes:l}=this.props,{currentTab:n}=this.state;return s.element.createElement(s.element.Fragment,null,s.element.createElement(ye,null,s.element.createElement(q,null,this.canEditTemplate&&s.element.createElement(N,{className:"components-tab-button",isPressed:n==="editor",onClick:()=>this.showTab("editor")},s.element.createElement("span",null,d("Editor"))),s.element.createElement(N,{className:"components-tab-button",isPressed:n==="selectTemplate",onClick:()=>this.showTab("selectTemplate")},s.element.createElement("span",null,d("Saved templates")))),s.element.createElement(q,null,s.element.createElement(N,{className:"components-tab-button",isPressed:n==="preview",onClick:()=>this.showTab("preview")},s.element.createElement("span",null,d("Preview"))))),n==="preview"?s.element.createElement(R,{block:"tangible/template",className:e,attributes:t,EmptyResponsePlaceholder:J,LoadingResponsePlaceholder:J,onFetchResponseRendered:Pe}):this.canEditTemplate&&n==="editor"?s.element.createElement(Ce,{value:t.template,onChange:p=>l({template:p})}):s.element.createElement(Se,{label:"Select template",value:t.template_selected,style:{height:"60px"},onChange:p=>l({template_selected:p&&parseInt(p,10)}),options:this.templateOptions}))}},o(y,"y"),y);g(Y,"edit");let _e=Y;Te("tangible/template",{title:d("Tangible Template"),description:d("Dynamic template"),icon:"editor-code",category:"common",keywords:[d("template","loop","content")],edit:_e,save(){return null}});const{wp:m}=window,{blocks:{registerBlockCollection:Z}}=m;Z&&Z("tangible",{title:"Tangible",icon:m.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 99 99"},m.element.createElement("path",{d:"M0 0 H 33 V 33 H 0 L 0 0",fill:"#262262"}),m.element.createElement("path",{d:"M33 0 H 66 V 33 H 33 L 33 0",fill:"#662d91"}),m.element.createElement("path",{d:"M66 0 H 99 V 33 H 66 L 66 0",fill:"#9f1f63"}),m.element.createElement("path",{d:"M0 33 H 33 V 66 H 0 L 0 33",fill:"#2e3192"}),m.element.createElement("path",{d:"M66 33 H 99 V 66 H 66 L 66 33",fill:"#ec008c"}),m.element.createElement("path",{d:"M33 66 H 66 V 99 H 33 L 33 66",fill:"#02aeef"}))})})();

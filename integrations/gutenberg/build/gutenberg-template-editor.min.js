var _e=Object.defineProperty;var o=(S,O)=>_e(S,"name",{value:O,configurable:!0});(function(){"use strict";(function(){const r={NODE_ENV:"production"};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,r);return}}catch{}globalThis.process={env:r}})();function S(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}o(S,"getDefaultExportFromCjs");var O=o(function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var l,n,p;if(Array.isArray(e)){if(l=e.length,l!=t.length)return!1;for(n=l;n--!==0;)if(!r(e[n],t[n]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(n of e.entries())if(!t.has(n[0]))return!1;for(n of e.entries())if(!r(n[1],t.get(n[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(n of e.entries())if(!t.has(n[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(l=e.length,l!=t.length)return!1;for(n=l;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(p=Object.keys(e),l=p.length,l!==Object.keys(t).length)return!1;for(n=l;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,p[n]))return!1;for(n=l;n--!==0;){var v=p[n];if(!r(e[v],t[v]))return!1}return!0}return e!==e&&t!==t},"equal"),se=S(O),oe=Object.defineProperty,u=o((r,e)=>oe(r,"name",{value:e,configurable:!0}),"s$1");const{wp:a}=window,{apiFetch:ae,blocks:{__experimentalSanitizeBlockAttributes:ie,sanitizeBlockAttributes:Ne},components:{Placeholder:$,Spinner:ce},compose:{useDebounce:pe,usePrevious:ue},element:{RawHTML:z,useEffect:y,useRef:P,useState:k},i18n:{__:H,sprintf:me},url:{addQueryArgs:de}}=a;function x({className:r,children:e,onMount:t}){const l=P();return y(()=>{t&&t(l.current)},[]),a.element.createElement("div",{ref:l,className:"tangible-server-side-render"},a.element.createElement(z,{className:r},e))}o(x,"U$1"),u(x,"Content");const fe={};function D(r,e=null,t={}){return de(`/wp/v2/block-renderer/${r}`,{context:"edit",...e!==null?{attributes:e}:{},...t})}o(D,"rendererPath"),u(D,"rendererPath");function V(r){const{backgroundColor:e,borderColor:t,fontFamily:l,fontSize:n,gradient:p,textColor:v,className:J,...A}=r,{border:X,color:Y,elements:f,spacing:Z,typography:ee,...h}=r?.style||fe;return{...A,style:h}}o(V,"removeBlockSupportAttributes"),u(V,"removeBlockSupportAttributes");function U({className:r}){return a.element.createElement($,{className:r},H("Block rendered as empty."))}o(U,"W"),u(U,"DefaultEmptyResponsePlaceholder");function F({response:r,className:e}){const t=me(H("Error loading block: %s"),r.errorMsg);return a.element.createElement($,{className:e},t)}o(F,"X"),u(F,"DefaultErrorResponsePlaceholder");function I({children:r,showLoader:e}){return a.element.createElement("div",{style:{position:"relative"}},e&&a.element.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",marginTop:"-9px",marginLeft:"-9px"}},a.element.createElement(ce,null)),a.element.createElement("div",{style:{opacity:e?"0.3":1}},r))}o(I,"Z"),u(I,"DefaultLoadingResponsePlaceholder");function C(r){const{attributes:e,block:t,className:l,httpMethod:n="GET",urlQueryArgs:p,skipBlockSupportAttributes:v=!1,EmptyResponsePlaceholder:J=U,ErrorResponsePlaceholder:A=F,LoadingResponsePlaceholder:X=I,onFetchResponseRendered:Y}=r,f=P(!0),[Z,ee]=k(!1),h=P(),[E,te]=k(null),re=ue(r),[B,ne]=k(!1);function j(){if(!f.current)return;ne(!0);let g=e&&ie(t,e);v&&(g=V(g));const L=n==="POST",ke=D(t,L?null:g??null,p),Ce=L?{attributes:g??null}:null,T=h.current=ae({path:ke,data:Ce,method:L?"POST":"GET"}).then(w=>{f.current&&T===h.current&&w&&te(w.rendered)}).catch(w=>{f.current&&T===h.current&&te({error:!0,errorMsg:w.message})}).finally(()=>{f.current&&T===h.current&&ne(!1)});return T}o(j,"x"),u(j,"fetchData");const Se=pe(j,500);y(()=>()=>{f.current=!1},[]),y(()=>{re===void 0?j():se(re,r)||Se()}),y(()=>{if(!B)return;const g=setTimeout(()=>{ee(!0)},1e3);return()=>clearTimeout(g)},[B]);const le=!!E,Oe=E==="",Pe=E?.error;return B?a.element.createElement(X,{...r,showLoader:Z},le&&a.element.createElement(z,{className:l},E)):Oe||!le?a.element.createElement(J,{...r}):Pe?a.element.createElement(A,{response:E,...r}):a.element.createElement(x,{className:l,onMount:Y},E)}o(C,"w"),u(C,"ServerSideRender");var he=Object.defineProperty,b=o((r,e)=>he(r,"name",{value:e,configurable:!0}),"n");const{wp:s,Tangible:G,lodash:Re}=window,{element:{Component:K},blockEditor:{BlockControls:Ee,InspectorControls:Me},blocks:{registerBlockType:ge},components:{Button:_,DropdownMenu:Ae,KeyboardShortcuts:be,SelectControl:ve,TextControl:Be,ToolbarItem:je,ToolbarButton:Le,ToolbarGroup:Q,Panel:$e,PanelBody:ze,PanelRow:He,withConstrainedTabbing:xe},i18n:{__:d},keycodes:{rawShortcut:c}}=s,{createCodeEditor:ye,gutenbergConfig:N,moduleLoader:Te}=G;G.ServerSideRender=C;const i=b(r=>r.stopImmediatePropagation(),"stop"),we={tab:i,[c.shift("tab")]:i,[c.ctrl("[")]:i,[c.primary("[")]:i,[c.ctrl("]")]:i,[c.primary("]")]:i,[c.ctrl("a")]:i,[c.primary("a")]:i,[c.ctrl("d")]:i,[c.primary("d")]:i,[c.ctrl("z")]:i,[c.ctrlShift("z")]:i,[c.primary("z")]:i,[c.primaryShift("z")]:i},q=b(()=>s.element.createElement("div",null,"\xA0"),"EmptyTemplate");class R extends K{constructor(){super(...arguments),this.onEditorUpdate=b(()=>{const{onChange:e}=this.props;e&&e(this.editor.getValue())},"onEditorUpdate")}componentDidMount(){(async()=>{const e=await ye(this.el,{language:"html",resizable:!0});e.setSize(null,"100%"),this.editor=e,this.editor.on("change",this.onEditorUpdate),s.editSite&&setTimeout(function(){e.refresh()},120)})().catch(console.error)}componentWillUnmount(){this.editor.off("change",this.onEditorUpdate)}shouldComponentUpdate(){return!1}render(){const{value:e,onChange:t}=this.props;return s.element.createElement(be,{shortcuts:we},s.element.createElement("textarea",{ref:l=>this.el=l,value:e,onChange:l=>{t(l.target.value)},style:{display:"none"},cols:"30",rows:"10"}))}}o(R,"S"),b(R,"TemplateEditor");class M extends K{constructor(e){super(e),this.canEditTemplate=N.canEditTemplate,this.state={currentTab:this.props.attributes.template_selected||!this.canEditTemplate?"selectTemplate":"editor",previouslySelectedTemplate:0},this.props.attributes.current_post_id=N.current_post_id||0,this.templateOptions=[];const t=N.templateOptions,l=Object.keys(t);for(const n of l)this.templateOptions.push({value:n&&parseInt(n,10),label:t[n]})}showTab(e){this.state.currentTab!==e&&(this.setState({currentTab:e}),e==="editor"?(console.log("Save",this.props.attributes.template_selected),this.setState({previouslySelectedTemplate:this.props.attributes.template_selected}),this.props.attributes.template_selected&&this.props.setAttributes({template_selected:0})):e==="selectTemplate"&&(this.props.attributes.template_selected||(console.log("Restore",this.props.attributes.template_selected),this.props.setAttributes({template_selected:this.state.previouslySelectedTemplate?this.state.previouslySelectedTemplate:this.templateOptions[0]&&this.templateOptions[0].value?this.templateOptions[0].value:0}))))}render(){const{className:e,attributes:t,setAttributes:l}=this.props,{currentTab:n}=this.state;return s.element.createElement(s.element.Fragment,null,s.element.createElement(Ee,null,s.element.createElement(Q,null,this.canEditTemplate&&s.element.createElement(_,{className:"components-tab-button",isPressed:n==="editor",onClick:()=>this.showTab("editor")},s.element.createElement("span",null,d("Editor"))),s.element.createElement(_,{className:"components-tab-button",isPressed:n==="selectTemplate",onClick:()=>this.showTab("selectTemplate")},s.element.createElement("span",null,d("Saved templates")))),s.element.createElement(Q,null,s.element.createElement(_,{className:"components-tab-button",isPressed:n==="preview",onClick:()=>this.showTab("preview")},s.element.createElement("span",null,d("Preview"))))),n==="preview"?s.element.createElement(C,{block:"tangible/template",className:e,attributes:t,EmptyResponsePlaceholder:q,LoadingResponsePlaceholder:q,onFetchResponseRendered:Te}):this.canEditTemplate&&n==="editor"?s.element.createElement(R,{value:t.template,onChange:p=>l({template:p})}):s.element.createElement(ve,{label:"Select template",value:t.template_selected,style:{height:"60px"},onChange:p=>l({template_selected:p&&parseInt(p,10)}),options:this.templateOptions}))}}o(M,"v"),b(M,"edit"),ge("tangible/template",{title:d("Tangible Template"),description:d("Dynamic template"),icon:"editor-code",category:"common",keywords:[d("template","loop","content")],edit:M,save(){return null}});const{wp:m}=window,{blocks:{registerBlockCollection:W}}=m;W&&W("tangible",{title:"Tangible",icon:m.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 99 99"},m.element.createElement("path",{d:"M0 0 H 33 V 33 H 0 L 0 0",fill:"#262262"}),m.element.createElement("path",{d:"M33 0 H 66 V 33 H 33 L 33 0",fill:"#662d91"}),m.element.createElement("path",{d:"M66 0 H 99 V 33 H 66 L 66 0",fill:"#9f1f63"}),m.element.createElement("path",{d:"M0 33 H 33 V 66 H 0 L 0 33",fill:"#2e3192"}),m.element.createElement("path",{d:"M66 33 H 99 V 66 H 66 L 66 33",fill:"#ec008c"}),m.element.createElement("path",{d:"M33 66 H 66 V 99 H 33 L 33 66",fill:"#02aeef"}))})})();
//# sourceMappingURL=gutenberg-template-editor.min.js.map

var _e=Object.defineProperty;var p=(N,w)=>_e(N,"name",{value:w,configurable:!0});(function(){"use strict";(function(){const a={env:{NODE_ENV:"production"}};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,a);return}}catch(e){}globalThis.process={env:a}})();const{Tangible:{ajax:N}}=window,w="tangible_blocks__template_cloud__";var q=Object.defineProperty,z=p((a,e)=>q(a,"name",{value:e,configurable:!0}),"i$1");const G=z(({catalogState:a,setPage:e})=>{const{loading:t,total:l,page:c,next:o,prev:d,last:i}=a;return Tangible.Preact.createElement(Tangible.Preact.Fragment,null,i>1&&Tangible.Preact.createElement("div",{className:"tangible-blocks__paginator"},Tangible.Preact.createElement("div",{className:"tablenav bottom"},Tangible.Preact.createElement("div",{className:"tablenav-pages"},Tangible.Preact.createElement("span",{className:"displaying-num"},l," items"),Tangible.Preact.createElement("span",{className:"pagination-links"},Tangible.Preact.createElement("a",{onClick:()=>e(1),className:"first-page button"+(2>=c?" disabled":"")},Tangible.Preact.createElement("span",{className:"screen-reader-text"},"First page"),Tangible.Preact.createElement("span",{"aria-hidden":"true"},"\xAB")),Tangible.Preact.createElement("a",{onClick:()=>e(d),className:"prev-page button"+(d>=c?" disabled":"")},Tangible.Preact.createElement("span",{className:"screen-reader-text"},"Previous page"),Tangible.Preact.createElement("span",{"aria-hidden":"true"},"\u2039")),Tangible.Preact.createElement("span",{className:"screen-reader-text"},"Current Page"),Tangible.Preact.createElement("span",{id:"table-paging",className:"paging-input"},Tangible.Preact.createElement("span",{className:"tablenav-paging-text"},c," of ",Tangible.Preact.createElement("span",{className:"total-pages"},i))),Tangible.Preact.createElement("a",{onClick:()=>e(o),className:"next-page button"+(o<=c?" disabled":"")},Tangible.Preact.createElement("span",{className:"screen-reader-text"},"Next page"),Tangible.Preact.createElement("span",{"aria-hidden":"true"},"\u203A")),Tangible.Preact.createElement("a",{onClick:()=>e(i),className:"last-page button"+(i<=c+1?" disabled":"")},Tangible.Preact.createElement("span",{className:"screen-reader-text"},"Last page"),Tangible.Preact.createElement("span",{"aria-hidden":"true"},"\xBB"))))),Tangible.Preact.createElement("br",{className:"clear"})))},"Paginator");var S=Object.defineProperty,Q=Object.defineProperties,U=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable,F=p((a,e,t)=>e in a?S(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,"h$1"),P=p((a,e)=>{for(var t in e||(e={}))X.call(e,t)&&F(a,t,e[t]);if($)for(var t of $(e))Y.call(e,t)&&F(a,t,e[t]);return a},"i"),k=p((a,e)=>Q(a,U(e)),"c$3"),T=p((a,e)=>S(a,"name",{value:e,configurable:!0}),"l$2");T((...a)=>console.log("[Store Blocks Catalog]",...a),"log");const{isTangibleBlocksProInstalled:Z=!1}=window.Tangible,ee=T(({tabs:a,activeTab:e,loadImportData:t})=>{const[l,c]=Tangible.Preact.useState({loading:!0,count:0,total:0,page:1,next:1,prev:1,last:1,downloads:[]}),o=T(n=>{c(k(P({},l),{page:n}))},"setPage"),d=T(function(n){return n.is_pro&&!Z},"needsPro"),i=T(n=>{if(n.files.length||console.error("File missing from dld",n),d(n)&&console.error("Tangible Blocks Pro missing"),n.dependencies&&n.dependencies.unmet.length>0&&!confirm("Warning: There are one or more missing plugins which this block distribution relies on. If you proceed with the installation, the installed templates might interfere with the normal functioning of your website."))return;const s=n.files[0].file;N(w+"json",{file:s}).then(r=>{t(r)}).catch(r=>{console.error(r)})},"attemptInstall");return Tangible.Preact.useEffect(()=>{c(k(P({},l),{loading:!0})),N(w+"catalog",{number:12,page:l.page,access_type:e}).then(n=>{let s=n.products;c(k(P(P({},l),n.meta),{downloads:s,loading:!1}))}).catch(n=>{console.error(n)})},[l.page]),Tangible.Preact.createElement("div",{className:"tangible-blocks__loop-gallery"},l.loading&&Tangible.Preact.createElement("div",{className:"components-modal__screen-overlay-wpcontent"},Tangible.Preact.createElement("span",{className:"spinner"})),l.downloads.length>0?Tangible.Preact.createElement("div",{className:"theme-browser"},Tangible.Preact.createElement("div",{className:"themes wp-clearfix"},l.downloads.map((n,s)=>Tangible.Preact.createElement("div",{key:`download-${s}`,className:"theme"+(n.is_pro?" pro":"")},Tangible.Preact.createElement("div",{className:"theme-screenshot"+(n.thumbnail?"":" blank")},n.thumbnail&&Tangible.Preact.createElement("img",{src:n.thumbnail}),n.vendor&&Tangible.Preact.createElement("div",{className:"theme-vendor-wrap"},n.vendor.logo&&Tangible.Preact.createElement("img",{className:"theme-vendor-logo",src:n.vendor.logo}),Tangible.Preact.createElement("a",{className:"theme-vendor-link",target:"_blank",href:n.vendor.url},n.vendor.name))),Tangible.Preact.createElement("div",{className:"theme-id-container"},Tangible.Preact.createElement("div",{className:"theme-copy"},Tangible.Preact.createElement("h2",{className:"theme-name"},n.title),n.dependencies&&Tangible.Preact.createElement("p",{className:"theme-details"},"Dependencies:"," ",n.dependencies.met.map((r,m)=>Tangible.Preact.createElement("span",{key:`dependency-met-${m}`,className:"dependency met","data-slug":r.slug},r.name)),n.dependencies.unmet.map((r,m)=>Tangible.Preact.createElement("span",{key:`dependency-unmet-${m}`,className:"dependency unmet","data-slug":r.slug},r.name)))),Tangible.Preact.createElement("div",{className:"theme-actions"},["public","free"].includes(e)?Tangible.Preact.createElement("button",{className:"button button-primary",disabled:d(n),onClick:()=>i(n)},"Install"):Tangible.Preact.createElement("a",{href:n.link,target:"_blank",className:"button"},"Buy")))))),Tangible.Preact.createElement(G,P({},{catalogState:l,setPage:o}))):Tangible.Preact.createElement(Tangible.Preact.Fragment,null,!l.loading&&Tangible.Preact.createElement("h2",null,"Nothing found in catalog for ",a[e])))},"Catalog");var te=Object.defineProperty,ae=p((a,e)=>te(a,"name",{value:e,configurable:!0}),"n");const ne=ae(({tabs:a,activeTab:e,setActiveTab:t})=>Tangible.Preact.createElement("h2",{className:"nav-tab-wrapper"},Object.entries(a).map(([l,c])=>Tangible.Preact.createElement("a",{key:e,className:"nav-tab "+(l===e?"nav-tab-active":""),href:"#",onClick:()=>t(l)},c))),"Menu"),{Tangible:{ajax:x}}=window,C="tangible_loops_and_logic__template_import_export__";var B=Object.defineProperty,re=Object.defineProperties,le=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable,H=p((a,e,t)=>e in a?B(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,"u$1"),b=p((a,e)=>{for(var t in e||(e={}))ce.call(e,t)&&H(a,t,e[t]);if(M)for(var t of M(e))ie.call(e,t)&&H(a,t,e[t]);return a},"a$1"),f=p((a,e)=>re(a,le(e)),"d$1"),se=p((a,e)=>B(a,"name",{value:e,configurable:!0}),"m");function D({mode:a,inputStateRef:e,setInputState:t}){const{importData:l}=e.current;if(!l||!l.post_types){console.warn("Import data not found",l);return}const c=f(b({},l),{post_types:{},handle_duplicates:a});for(const{id:o,title:d,post_type:i}of e.current.duplicatesFound){const n=l.post_types[i].filter(s=>s.id===o)[0];if(!n){console.warn("Corresponding post not found",o,i,d);continue}c.post_types[i]||(c.post_types[i]=[]),c.post_types[i].push(n)}t(f(b({},e.current),{importData:{},importedData:{},duplicatesFound:[],duplicatesHandledMessage:"",message:""})),x(C+"import",c).then(o=>{const d=f(b({},c),{old_to_new_id:b(b({},e.current.old_to_new_id||{}),o.old_to_new_id||{})});console.log("Imported duplicates",d),t(f(b({},e.current),{importing:!1,importData:{},importedData:d,duplicatesFound:[],duplicatesHandledMessage:"",message:o.post_count+" template"+(o.post_count!==1?"s":"")+" imported"}))}).catch(o=>{t(f(b({},e.current),{duplicatesHandledMessage:"Error: "+o.message}))})}p(D,"F"),se(D,"handleDuplicates");var A=Object.defineProperty,oe=Object.defineProperties,pe=Object.getOwnPropertyDescriptors,R=Object.getOwnPropertySymbols,me=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable,J=p((a,e,t)=>e in a?A(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,"I"),v=p((a,e)=>{for(var t in e||(e={}))me.call(e,t)&&J(a,t,e[t]);if(R)for(var t of R(e))de.call(e,t)&&J(a,t,e[t]);return a},"l"),y=p((a,e)=>oe(a,pe(e)),"u"),_=p((a,e)=>A(a,"name",{value:e,configurable:!0}),"c$1");const O=_((...a)=>console.log("[Importer]",...a),"log"),{FileReader:ge}=window,j={tangible_template:"Templates",tangible_style:"Styles",tangible_script:"Scripts",tangible_layout:"Layouts",tangible_block:"Blocks"},be=_(({useInput:a=!0,directImportData:e})=>{const[t,l]=Tangible.Preact.useState({importing:!1,importData:{},importedData:{},message:"",duplicatesFound:[],duplicatesHandledMessage:""}),c=_(()=>{l(y(v({},i.current),{importing:!0,importData:{},importedData:{},duplicatesFound:[],duplicatesHandledMessage:"",message:"Importing.."}))},"preImport"),o=_(s=>l(y(v({},i.current),{importing:!1,importData:{},importedData:{},duplicatesFound:[],duplicatesHandledMessage:"",message:"Error: "+s})),"onError"),d=_(s=>{l(y(v({},i.current),{importData:s})),x(C+"import",s).then(r=>{O("Import success",r);const{importData:m}=i.current,g={post_types:Object.keys(m.post_types).reduce((E,u)=>{const ye=r.duplicates_found.filter(h=>h.post_type===u).map(h=>h.id);return E[u]=m.post_types[u].filter(h=>ye.indexOf(h.id)<0),E},{}),old_to_new_id:r.old_to_new_id||{}};O("Imported minus duplicates",g),l(y(v({},i.current),{importing:!1,duplicatesFound:r.duplicates_found,importData:r.duplicates_found.length?m:{},importedData:g,message:r.post_count+" template"+(r.post_count!==1?"s":"")+" imported"+(r.failed_post_count?" - "+r.failed_post_count+" template"+(r.failed_post_count!==1?"s":"")+" failed":"")}))}).catch(r=>{console.error(r),o(r.message)})},"importJSON");Tangible.Preact.useEffect(()=>{!e||(c(),d(e))},[]);const i=Tangible.Preact.useRef();i.current=t;const n=Tangible.Preact.useRef();return Tangible.Preact.createElement("div",{id:"importer"},a&&Tangible.Preact.createElement("p",null,Tangible.Preact.createElement("input",{type:"file",hidden:!0,ref:n,accept:".json,text/json",onChange:({target:{files:s}})=>{const r=s[0],m=new ge;c(),m.onload=function(g){const E=g.target.result;try{const u=JSON.parse(E);O("Import data",u),d(u)}catch(u){O("Invalid JSON",E),o("Invalid JSON")}},m.onerror=function(g){o(g.message)},m.readAsText(r)}}),Tangible.Preact.createElement("button",{type:"button",className:"button button-primary",disabled:t.importing,onClick:()=>{n.current&&n.current.click()}},"Import")),t.message&&Tangible.Preact.createElement("p",null,t.message),Object.keys(t.importedData.post_types||{}).map(s=>t.importedData.post_types[s]&&t.importedData.post_types[s].length>0&&Tangible.Preact.createElement(Tangible.Preact.Fragment,null,Tangible.Preact.createElement("div",null,Tangible.Preact.createElement("b",null,j[s]||"Templates")),Tangible.Preact.createElement("ul",null,t.importedData.post_types[s].map((r,m)=>Tangible.Preact.createElement("li",{key:`post-${m}`},t.importedData.old_to_new_id&&t.importedData.old_to_new_id[r.id]?Tangible.Preact.createElement("a",{href:`post.php?post=${t.importedData.old_to_new_id[r.id]}&action=edit`},r.title):r.title))))),t.duplicatesFound.length>0&&Tangible.Preact.createElement(Tangible.Preact.Fragment,null,Tangible.Preact.createElement("p",{style:{fontWeight:"bold",color:"red"}},t.duplicatesFound.length," duplicate template",t.duplicatesFound!==1?"s":""," found"),Object.keys(j).map(s=>{const r=t.duplicatesFound.filter(m=>m.post_type===s);if(r.length)return Tangible.Preact.createElement(Tangible.Preact.Fragment,null,Tangible.Preact.createElement("div",null,Tangible.Preact.createElement("b",null,j[s]||"Templates")),Tangible.Preact.createElement("ul",null,r.map((m,g)=>Tangible.Preact.createElement("li",{key:`duplicate-post-${g}`},m.title))))}),Tangible.Preact.createElement("button",{type:"button",className:"button button-primary",onClick:()=>{D({mode:"overwrite",inputStateRef:i,setInputState:l})}},"Overwrite"),"\xA0",Tangible.Preact.createElement("button",{type:"button",className:"button button-primary",onClick:()=>{D({mode:"keep_both",inputStateRef:i,setInputState:l})}},"Keep both"),"\xA0",Tangible.Preact.createElement("button",{type:"button",className:"button button-primary",onClick:()=>{l(y(v({},i.current),{importing:!1,importData:{},importedData:{},duplicatesFound:[],duplicatesHandledMessage:"",message:""}))}},"Skip"),t.duplicatesHandledMessage&&Tangible.Preact.createElement("p",null,t.duplicatesHandledMessage)))},"Importer");var W=Object.defineProperty,L=Object.getOwnPropertySymbols,ue=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable,K=p((a,e,t)=>e in a?W(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,"c"),I=p((a,e)=>{for(var t in e||(e={}))ue.call(e,t)&&K(a,t,e[t]);if(L)for(var t of L(e))Pe.call(e,t)&&K(a,t,e[t]);return a},"r"),V=p((a,e)=>W(a,"name",{value:e,configurable:!0}),"a");const Te=document.getElementById("tangible_template_cloud_wrapper"),fe={public:"Public Blocks"},ve=V(({tabs:a})=>{const[e,t]=Tangible.Preact.useState(Object.keys(a)[0]),[l,c]=Tangible.Preact.useState(),o=V(d=>{c(d)},"loadImportData");return Tangible.Preact.createElement(Tangible.Preact.Fragment,null,Tangible.Preact.createElement(ne,I({},{tabs:a,activeTab:e,setActiveTab:t})),Tangible.Preact.createElement(be,I({key:l},{useInput:!1,directImportData:l})),Tangible.Preact.createElement(ee,I({key:e},{tabs:a,activeTab:e,loadImportData:o})))},"Wrapper");Tangible.Preact.render(Tangible.Preact.createElement(ve,{tabs:fe}),Te)})();
//# sourceMappingURL=template-cloud.min.js.map

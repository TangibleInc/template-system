(function(){"use strict";(function(){const a={env:{NODE_ENV:"production"}};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,a);return}}catch(e){}globalThis.process={env:a}})();const{Tangible:{ajax:N}}=window,O="tangible_blocks__template_cloud__",M=({catalogState:a,setPage:e})=>{const{loading:t,total:l,page:c,next:o,prev:m,last:i}=a;return Tangible.Preact.createElement(Tangible.Preact.Fragment,null,i>1&&Tangible.Preact.createElement("div",{className:"tangible-blocks__paginator"},Tangible.Preact.createElement("div",{className:"tablenav bottom"},Tangible.Preact.createElement("div",{className:"tablenav-pages"},Tangible.Preact.createElement("span",{className:"displaying-num"},l," items"),Tangible.Preact.createElement("span",{className:"pagination-links"},Tangible.Preact.createElement("a",{onClick:()=>e(1),className:"first-page button"+(2>=c?" disabled":"")},Tangible.Preact.createElement("span",{className:"screen-reader-text"},"First page"),Tangible.Preact.createElement("span",{"aria-hidden":"true"},"\xAB")),Tangible.Preact.createElement("a",{onClick:()=>e(m),className:"prev-page button"+(m>=c?" disabled":"")},Tangible.Preact.createElement("span",{className:"screen-reader-text"},"Previous page"),Tangible.Preact.createElement("span",{"aria-hidden":"true"},"\u2039")),Tangible.Preact.createElement("span",{className:"screen-reader-text"},"Current Page"),Tangible.Preact.createElement("span",{id:"table-paging",className:"paging-input"},Tangible.Preact.createElement("span",{className:"tablenav-paging-text"},c," of ",Tangible.Preact.createElement("span",{className:"total-pages"},i))),Tangible.Preact.createElement("a",{onClick:()=>e(o),className:"next-page button"+(o<=c?" disabled":"")},Tangible.Preact.createElement("span",{className:"screen-reader-text"},"Next page"),Tangible.Preact.createElement("span",{"aria-hidden":"true"},"\u203A")),Tangible.Preact.createElement("a",{onClick:()=>e(i),className:"last-page button"+(i<=c+1?" disabled":"")},Tangible.Preact.createElement("span",{className:"screen-reader-text"},"Last page"),Tangible.Preact.createElement("span",{"aria-hidden":"true"},"\xBB"))))),Tangible.Preact.createElement("br",{className:"clear"})))};var A=Object.defineProperty,R=Object.defineProperties,J=Object.getOwnPropertyDescriptors,k=Object.getOwnPropertySymbols,L=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,D=(a,e,t)=>e in a?A(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,u=(a,e)=>{for(var t in e||(e={}))L.call(e,t)&&D(a,t,e[t]);if(k)for(var t of k(e))W.call(e,t)&&D(a,t,e[t]);return a},v=(a,e)=>R(a,J(e));const{isTangibleBlocksProInstalled:K=!1}=window.Tangible,V=({tabs:a,activeTab:e,loadImportData:t})=>{const[l,c]=Tangible.Preact.useState({loading:!0,count:0,total:0,page:1,next:1,prev:1,last:1,downloads:[]}),o=n=>{c(v(u({},l),{page:n}))},m=function(n){return n.is_pro&&!K},i=n=>{if(n.files.length||console.error("File missing from dld",n),m(n)&&console.error("Tangible Blocks Pro missing"),n.dependencies&&n.dependencies.unmet.length>0&&!confirm("Warning: There are one or more missing plugins which this block distribution relies on. If you proceed with the installation, the installed templates might interfere with the normal functioning of your website."))return;const s=n.files[0].file;N(O+"json",{file:s}).then(r=>{t(r)}).catch(r=>{console.error(r)})};return Tangible.Preact.useEffect(()=>{c(v(u({},l),{loading:!0})),N(O+"catalog",{number:12,page:l.page,access_type:e}).then(n=>{let s=n.products;c(v(u(u({},l),n.meta),{downloads:s,loading:!1}))}).catch(n=>{console.error(n)})},[l.page]),Tangible.Preact.createElement("div",{className:"tangible-blocks__loop-gallery"},l.loading&&Tangible.Preact.createElement("div",{className:"components-modal__screen-overlay-wpcontent"},Tangible.Preact.createElement("span",{className:"spinner"})),l.downloads.length>0?Tangible.Preact.createElement("div",{className:"theme-browser"},Tangible.Preact.createElement("div",{className:"themes wp-clearfix"},l.downloads.map((n,s)=>Tangible.Preact.createElement("div",{key:`download-${s}`,className:"theme"+(n.is_pro?" pro":"")},Tangible.Preact.createElement("div",{className:"theme-screenshot"+(n.thumbnail?"":" blank")},n.thumbnail&&Tangible.Preact.createElement("img",{src:n.thumbnail}),n.vendor&&Tangible.Preact.createElement("div",{className:"theme-vendor-wrap"},n.vendor.logo&&Tangible.Preact.createElement("img",{className:"theme-vendor-logo",src:n.vendor.logo}),Tangible.Preact.createElement("a",{className:"theme-vendor-link",target:"_blank",href:n.vendor.url},n.vendor.name))),Tangible.Preact.createElement("div",{className:"theme-id-container"},Tangible.Preact.createElement("div",{className:"theme-copy"},Tangible.Preact.createElement("h2",{className:"theme-name"},n.title),n.dependencies&&Tangible.Preact.createElement("p",{className:"theme-details"},"Dependencies:"," ",n.dependencies.met.map((r,p)=>Tangible.Preact.createElement("span",{key:`dependency-met-${p}`,className:"dependency met","data-slug":r.slug},r.name)),n.dependencies.unmet.map((r,p)=>Tangible.Preact.createElement("span",{key:`dependency-unmet-${p}`,className:"dependency unmet","data-slug":r.slug},r.name)))),Tangible.Preact.createElement("div",{className:"theme-actions"},["public","free"].includes(e)?Tangible.Preact.createElement("button",{className:"button button-primary",disabled:m(n),onClick:()=>i(n)},"Install"):Tangible.Preact.createElement("a",{href:n.link,target:"_blank",className:"button"},"Buy")))))),Tangible.Preact.createElement(M,u({},{catalogState:l,setPage:o}))):Tangible.Preact.createElement(Tangible.Preact.Fragment,null,!l.loading&&Tangible.Preact.createElement("h2",null,"Nothing found in catalog for ",a[e])))},q=({tabs:a,activeTab:e,setActiveTab:t})=>Tangible.Preact.createElement("h2",{className:"nav-tab-wrapper"},Object.entries(a).map(([l,c])=>Tangible.Preact.createElement("a",{key:e,className:"nav-tab "+(l===e?"nav-tab-active":""),href:"#",onClick:()=>t(l)},c))),{Tangible:{ajax:j}}=window,I="tangible_loops_and_logic__template_import_export__";var z=Object.defineProperty,G=Object.defineProperties,Q=Object.getOwnPropertyDescriptors,x=Object.getOwnPropertySymbols,U=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,F=(a,e,t)=>e in a?z(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,g=(a,e)=>{for(var t in e||(e={}))U.call(e,t)&&F(a,t,e[t]);if(x)for(var t of x(e))X.call(e,t)&&F(a,t,e[t]);return a},P=(a,e)=>G(a,Q(e));function S({mode:a,inputStateRef:e,setInputState:t}){const{importData:l}=e.current;if(!l||!l.post_types){console.warn("Import data not found",l);return}const c=P(g({},l),{post_types:{},handle_duplicates:a});for(const{id:o,title:m,post_type:i}of e.current.duplicatesFound){const n=l.post_types[i].filter(s=>s.id===o)[0];if(!n){console.warn("Corresponding post not found",o,i,m);continue}c.post_types[i]||(c.post_types[i]=[]),c.post_types[i].push(n)}t(P(g({},e.current),{importData:{},importedData:{},duplicatesFound:[],duplicatesHandledMessage:"",message:""})),j(I+"import",c).then(o=>{const m=P(g({},c),{old_to_new_id:g(g({},e.current.old_to_new_id||{}),o.old_to_new_id||{})});console.log("Imported duplicates",m),t(P(g({},e.current),{importing:!1,importData:{},importedData:m,duplicatesFound:[],duplicatesHandledMessage:"",message:o.post_count+" template"+(o.post_count!==1?"s":"")+" imported"}))}).catch(o=>{t(P(g({},e.current),{duplicatesHandledMessage:"Error: "+o.message}))})}var Y=Object.defineProperty,Z=Object.defineProperties,ee=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,te=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,C=(a,e,t)=>e in a?Y(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,T=(a,e)=>{for(var t in e||(e={}))te.call(e,t)&&C(a,t,e[t]);if($)for(var t of $(e))ae.call(e,t)&&C(a,t,e[t]);return a},y=(a,e)=>Z(a,ee(e));const E=(...a)=>console.log("[Importer]",...a),{FileReader:ne}=window,h={tangible_template:"Templates",tangible_style:"Styles",tangible_script:"Scripts",tangible_layout:"Layouts",tangible_block:"Blocks"},re=({useInput:a=!0,directImportData:e})=>{const[t,l]=Tangible.Preact.useState({importing:!1,importData:{},importedData:{},message:"",duplicatesFound:[],duplicatesHandledMessage:""}),c=()=>{l(y(T({},i.current),{importing:!0,importData:{},importedData:{},duplicatesFound:[],duplicatesHandledMessage:"",message:"Importing.."}))},o=s=>l(y(T({},i.current),{importing:!1,importData:{},importedData:{},duplicatesFound:[],duplicatesHandledMessage:"",message:"Error: "+s})),m=s=>{l(y(T({},i.current),{importData:s})),j(I+"import",s).then(r=>{E("Import success",r);const{importData:p}=i.current,d={post_types:Object.keys(p.post_types).reduce((f,b)=>{const me=r.duplicates_found.filter(_=>_.post_type===b).map(_=>_.id);return f[b]=p.post_types[b].filter(_=>me.indexOf(_.id)<0),f},{}),old_to_new_id:r.old_to_new_id||{}};E("Imported minus duplicates",d),l(y(T({},i.current),{importing:!1,duplicatesFound:r.duplicates_found,importData:r.duplicates_found.length?p:{},importedData:d,message:r.post_count+" template"+(r.post_count!==1?"s":"")+" imported"+(r.failed_post_count?" - "+r.failed_post_count+" template"+(r.failed_post_count!==1?"s":"")+" failed":"")}))}).catch(r=>{console.error(r),o(r.message)})};Tangible.Preact.useEffect(()=>{!e||(c(),m(e))},[]);const i=Tangible.Preact.useRef();i.current=t;const n=Tangible.Preact.useRef();return Tangible.Preact.createElement("div",{id:"importer"},a&&Tangible.Preact.createElement("p",null,Tangible.Preact.createElement("input",{type:"file",hidden:!0,ref:n,accept:".json,text/json",onChange:({target:{files:s}})=>{const r=s[0],p=new ne;c(),p.onload=function(d){const f=d.target.result;try{const b=JSON.parse(f);E("Import data",b),m(b)}catch(b){E("Invalid JSON",f),o("Invalid JSON")}},p.onerror=function(d){o(d.message)},p.readAsText(r)}}),Tangible.Preact.createElement("button",{type:"button",className:"button button-primary",disabled:t.importing,onClick:()=>{n.current&&n.current.click()}},"Import")),t.message&&Tangible.Preact.createElement("p",null,t.message),Object.keys(t.importedData.post_types||{}).map(s=>t.importedData.post_types[s]&&t.importedData.post_types[s].length>0&&Tangible.Preact.createElement(Tangible.Preact.Fragment,null,Tangible.Preact.createElement("div",null,Tangible.Preact.createElement("b",null,h[s]||"Templates")),Tangible.Preact.createElement("ul",null,t.importedData.post_types[s].map((r,p)=>Tangible.Preact.createElement("li",{key:`post-${p}`},t.importedData.old_to_new_id&&t.importedData.old_to_new_id[r.id]?Tangible.Preact.createElement("a",{href:`post.php?post=${t.importedData.old_to_new_id[r.id]}&action=edit`},r.title):r.title))))),t.duplicatesFound.length>0&&Tangible.Preact.createElement(Tangible.Preact.Fragment,null,Tangible.Preact.createElement("p",{style:{fontWeight:"bold",color:"red"}},t.duplicatesFound.length," duplicate template",t.duplicatesFound!==1?"s":""," found"),Object.keys(h).map(s=>{const r=t.duplicatesFound.filter(p=>p.post_type===s);if(r.length)return Tangible.Preact.createElement(Tangible.Preact.Fragment,null,Tangible.Preact.createElement("div",null,Tangible.Preact.createElement("b",null,h[s]||"Templates")),Tangible.Preact.createElement("ul",null,r.map((p,d)=>Tangible.Preact.createElement("li",{key:`duplicate-post-${d}`},p.title))))}),Tangible.Preact.createElement("button",{type:"button",className:"button button-primary",onClick:()=>{S({mode:"overwrite",inputStateRef:i,setInputState:l})}},"Overwrite"),"\xA0",Tangible.Preact.createElement("button",{type:"button",className:"button button-primary",onClick:()=>{S({mode:"keep_both",inputStateRef:i,setInputState:l})}},"Keep both"),"\xA0",Tangible.Preact.createElement("button",{type:"button",className:"button button-primary",onClick:()=>{l(y(T({},i.current),{importing:!1,importData:{},importedData:{},duplicatesFound:[],duplicatesHandledMessage:"",message:""}))}},"Skip"),t.duplicatesHandledMessage&&Tangible.Preact.createElement("p",null,t.duplicatesHandledMessage)))};var le=Object.defineProperty,B=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable,H=(a,e,t)=>e in a?le(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,w=(a,e)=>{for(var t in e||(e={}))ce.call(e,t)&&H(a,t,e[t]);if(B)for(var t of B(e))ie.call(e,t)&&H(a,t,e[t]);return a};const se=document.getElementById("tangible_template_cloud_wrapper"),oe={public:"Public Blocks"},pe=({tabs:a})=>{const[e,t]=Tangible.Preact.useState(Object.keys(a)[0]),[l,c]=Tangible.Preact.useState(),o=m=>{c(m)};return Tangible.Preact.createElement(Tangible.Preact.Fragment,null,Tangible.Preact.createElement(q,w({},{tabs:a,activeTab:e,setActiveTab:t})),Tangible.Preact.createElement(re,w({key:l},{useInput:!1,directImportData:l})),Tangible.Preact.createElement(V,w({key:e},{tabs:a,activeTab:e,loadImportData:o})))};Tangible.Preact.render(Tangible.Preact.createElement(pe,{tabs:oe}),se)})();
//# sourceMappingURL=template-cloud.min.js.map

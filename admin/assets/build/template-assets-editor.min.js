var C=Object.defineProperty;var m=(o,u)=>C(o,"name",{value:u,configurable:!0});(function(){"use strict";(function(){const e={env:{NODE_ENV:"production"}};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,e);return}}catch(t){}globalThis.process={env:e}})();var o=Object.defineProperty,u=Object.getOwnPropertySymbols,O=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,P=m((e,t,n)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,"g"),T=m((e,t)=>{for(var n in t||(t={}))O.call(t,n)&&P(e,n,t[n]);if(u)for(var n of u(t))A.call(t,n)&&P(e,n,t[n]);return e},"p"),l=m((e,t)=>o(e,"name",{value:t,configurable:!0}),"n");const{wp:q}=window;let c,b;const j=l(()=>{if(c){c.open();return}c=q.media({title:"Select media attachment",button:{text:"Select"},multiple:!0}),c.on("select",b),c.open()},"openMediaModal");function E(e){return e.name&&(e.name=e.name.replace(/[^\w_\-]/g,"")),e}m(E,"R"),l(E,"withValidName");const k=l(({assets:e})=>{const[t,n]=Tangible.Preact.useState(e),r=Tangible.Preact.useRef();r.current=t;const g=Tangible.Preact.useRef(),N=l(()=>{g.current.value=JSON.stringify(r.current)},"updateAssetsElement");Tangible.Preact.useEffect(()=>{N()},[g.current]);const f=l(()=>{n([...r.current]),N()},"refreshAssets"),_=l(a=>{r.current.push(E(a)),f()},"addAsset"),x=l((a,s)=>{r.current[a]=T(T({},r.current[a]||{}),s),f()},"updateAsset"),M=l(a=>{r.current.splice(a,1),f()},"removeAsset");b||(b=l(()=>{const a=c.state().get("selection").toJSON();for(const s of a){let i=!1;for(const p of r.current)if(p.id===s.id){i=!0;break}if(i)continue;const v=["id","name","title","filename","mime","alt","caption","description"].reduce((p,h)=>(p[h]=s[h],p),{});_(v)}},"mediaModalCallback"));const w={};return Tangible.Preact.createElement(Tangible.Preact.Fragment,null,Tangible.Preact.createElement("input",{type:"hidden",name:"assets",ref:g}),Tangible.Preact.createElement("div",{className:"template-assets"},t.map((a,s)=>{const i=!!w[a.name];return i||(w[a.name]=!0),Tangible.Preact.createElement("div",{key:`asset-${s}`,className:"template-asset"},Tangible.Preact.createElement("div",{className:"template-asset-fields"},Tangible.Preact.createElement("div",{className:"template-asset-field template-asset-field--name"},Tangible.Preact.createElement("label",null,"Name"),Tangible.Preact.createElement("input",{type:"text",value:a.name,onChange:v=>{x(s,{name:v.target.value})}})),Tangible.Preact.createElement("div",{className:"template-asset-field template-asset-field--attachment"},Tangible.Preact.createElement("div",null,i&&Tangible.Preact.createElement("div",{className:"template-asset--duplicate-name-message"},"Duplicate name exists"),"ID:"," ",Tangible.Preact.createElement("a",{href:`post.php?post=${a.id}&action=edit`,target:"_blank"},a.id),Tangible.Preact.createElement("br",null),"Title: ",a.title,Tangible.Preact.createElement("br",null),"File name: ",Tangible.Preact.createElement("code",null,a.filename),Tangible.Preact.createElement("br",null)))),Tangible.Preact.createElement("div",{className:"template-asset-actions"},Tangible.Preact.createElement("div",{className:"template-asset-action template-asset-action--remove-asset"},Tangible.Preact.createElement("div",{className:"icon",onClick:()=>M(s)},Tangible.Preact.createElement("svg",{viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},Tangible.Preact.createElement("path",{d:"M1490 1322q0 40-28 68l-136 136q-28 28-68 28t-68-28l-294-294-294 294q-28 28-68 28t-68-28l-136-136q-28-28-28-68t28-68l294-294-294-294q-28-28-28-68t28-68l136-136q28-28 68-28t68 28l294 294 294-294q28-28 68-28t68 28l136 136q28 28 28 68t-28 68l-294 294 294 294q28 28 28 68z"}))))))})),Tangible.Preact.createElement("button",{type:"button",className:"button button--add-rule-group",onClick:()=>j()},"Add asset"))},"AssetsEditor"),{jQuery:S}=window,y=document.getElementById("tangible_template_assets_editor");let d=S(y).data("assets");Array.isArray(d)||(d=[]),Tangible.Preact.render(Tangible.Preact.createElement(k,{assets:d}),y)})();
//# sourceMappingURL=template-assets-editor.min.js.map

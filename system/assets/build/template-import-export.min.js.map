{"version":3,"file":"template-import-export.min.js","sources":["../src/template-import-export/common.js","../src/template-import-export/Importer/handleDuplicates.js","../src/template-import-export/Importer/index.jsx","../src/common/Select.jsx","../src/template-import-export/Exporter/ExportRule.jsx","../src/template-import-export/Exporter/localStorage.js","../src/template-import-export/Exporter/index.jsx","../src/template-import-export/index.jsx"],"sourcesContent":["const {\n  Tangible: { ajax },\n} = window\n\n// AJAX action prefix must be the same as in /system/import-export/ajax.php\nconst ajaxActionPrefix = 'tangible_template_import_export__'\n\nexport { ajax, ajaxActionPrefix }\n","import { ajax, ajaxActionPrefix } from '../common'\n\nexport default function handleDuplicates({\n  mode, // overwrite or keep_both\n  inputStateRef,\n  setInputState,\n}) {\n  const { importData } = inputStateRef.current\n\n  if (!importData || !importData.post_types) {\n    console.warn('Import data not found', importData)\n    return\n  }\n\n  const duplicates = {\n    ...importData, // NOTE: Other import data properties such as \"shared_assets\"\n    post_types: {},\n    handle_duplicates: mode,\n  }\n\n  // Filter only duplicate posts\n  for (const { id, title, post_type } of inputStateRef.current\n    .duplicatesFound) {\n    const postData = importData.post_types[post_type].filter(\n      (post) => post.id === id\n    )[0]\n    if (!postData) {\n      console.warn('Corresponding post not found', id, post_type, title)\n      continue\n    }\n\n    if (!duplicates.post_types[post_type]) {\n      duplicates.post_types[post_type] = []\n    }\n\n    duplicates.post_types[post_type].push(postData)\n  }\n\n  // console.log('Import duplicates', mode, duplicates)\n\n  setInputState({\n    ...inputStateRef.current,\n    importData: {},\n    importedData: {},\n    duplicatesFound: [],\n    duplicatesHandledMessage: '',\n    message: '',\n  })\n\n  ajax(ajaxActionPrefix + 'import', duplicates)\n    .then((result) => {\n      const importedData = {\n        ...duplicates,\n        old_to_new_id: {\n          ...(inputStateRef.current.old_to_new_id || {}),\n          ...(result.old_to_new_id || {}),\n        },\n      }\n\n      console.log('Imported duplicates', importedData)\n\n      // Clear duplicate posts state and show message after \"Import\" button\n\n      setInputState({\n        ...inputStateRef.current,\n        importing: false,\n        importData: {},\n        importedData,\n        duplicatesFound: [],\n        duplicatesHandledMessage: '',\n        message:\n          result.post_count +\n          ' template' +\n          (result.post_count !== 1 ? 's' : '') +\n          ' imported',\n      })\n    })\n    .catch((error) => {\n      setInputState({\n        ...inputStateRef.current,\n        duplicatesHandledMessage: 'Error: ' + error.message,\n      })\n    })\n}\n","/**\n * Template importer with support for handling duplicates\n *\n * Also used in ../../template-cloud\n */\n\nimport { useEffect, useRef, useState } from 'react'\nimport handleDuplicates from './handleDuplicates'\n\nimport { ajax, ajaxActionPrefix } from '../common'\n\nconst debug = true // Set this to false for production\nconst log = (...args) => debug && console.log('[Importer]', ...args)\n\nconst { FileReader } = window\n\nconst postTypeToLabel = {\n  tangible_template: 'Templates',\n  tangible_style: 'Styles',\n  tangible_script: 'Scripts',\n  tangible_layout: 'Layouts',\n  tangible_block: 'Blocks',\n}\n\nconst Importer = ({\n  useInput = true,\n  directImportData, // Optionally pass direct JSON data instead of using file upload\n}) => {\n  const [inputState, setInputState] = useState({\n    importing: false,\n    importData: {},\n    importedData: {},\n    message: '',\n    duplicatesFound: [],\n    duplicatesHandledMessage: '',\n  })\n\n  const preImport = () => {\n    setInputState({\n      ...inputStateRef.current,\n      importing: true,\n      importData: {},\n      importedData: {},\n      duplicatesFound: [],\n      duplicatesHandledMessage: '',\n      message: 'Importing..',\n    })\n  }\n\n  const onError = (message) =>\n    setInputState({\n      ...inputStateRef.current,\n      importing: false,\n      importData: {},\n      importedData: {},\n      duplicatesFound: [],\n      duplicatesHandledMessage: '',\n      message: 'Error: ' + message,\n    })\n\n  const importJSON = (data) => {\n    setInputState({\n      ...inputStateRef.current,\n      importData: data,\n    })\n\n    ajax(ajaxActionPrefix + 'import', data)\n      .then((result) => {\n        // Import complete\n        log('Import success', result)\n\n        const { importData } = inputStateRef.current\n        const importedData = {\n          post_types: Object.keys(importData.post_types).reduce(\n            (obj, postType) => {\n              const duplicateIds = result.duplicates_found\n                .filter((post) => post.post_type === postType)\n                .map((post) => post.id)\n\n              obj[postType] = importData.post_types[postType].filter(\n                (post) => duplicateIds.indexOf(post.id) < 0\n              )\n\n              return obj\n            },\n            {}\n          ),\n          // Map of old to new ID - See same property in ./handleDuplicates\n          old_to_new_id: result.old_to_new_id || {},\n        }\n\n        log('Imported minus duplicates', importedData)\n\n        setInputState({\n          ...inputStateRef.current,\n          importing: false,\n          duplicatesFound: result.duplicates_found,\n          importData: result.duplicates_found.length ? importData : {}, // Clear\n          importedData,\n          message:\n            result.post_count +\n            ' template' +\n            (result.post_count !== 1 ? 's' : '') +\n            ' imported' +\n            (result.failed_post_count\n              ? ' - ' +\n                result.failed_post_count +\n                ' template' +\n                (result.failed_post_count !== 1 ? 's' : '') +\n                ' failed'\n              : ''),\n        })\n      })\n      .catch((error) => {\n        // Import failed\n        console.error(error)\n        onError(error.message)\n      })\n  }\n\n  useEffect(() => {\n    if (!directImportData) return\n\n    preImport()\n    importJSON(directImportData) // Will correctly refresh when a new block json is installed\n  }, [])\n\n  const inputStateRef = useRef()\n  inputStateRef.current = inputState\n\n  const fileInputRef = useRef()\n\n  return (\n    <div id=\"importer\">\n      {useInput && (\n        <p>\n          <input\n            type=\"file\"\n            hidden\n            ref={fileInputRef}\n            accept=\".json,text/json\"\n            onChange={({ target: { files } }) => {\n              // File upload\n\n              // log('File upload state', files)\n\n              const file = files[0]\n\n              const reader = new FileReader()\n\n              preImport()\n\n              reader.onload = function (e) {\n                const content = e.target.result\n\n                // File upload complete\n\n                try {\n                  const data = JSON.parse(content)\n\n                  log('Import data', data)\n\n                  importJSON(data)\n                } catch (e) {\n                  log('Invalid JSON', content)\n\n                  onError('Invalid JSON')\n                }\n              }\n\n              reader.onerror = function (e) {\n                onError(e.message)\n              }\n\n              reader.readAsText(file)\n            }}\n          />\n          <button\n            type=\"button\"\n            className=\"button button-primary\"\n            disabled={inputState.importing}\n            onClick={() => {\n              fileInputRef.current && fileInputRef.current.click()\n            }}\n          >\n            Import\n          </button>\n        </p>\n      )}\n\n      {inputState.message && <p>{inputState.message}</p>}\n\n      {\n        // List imported posts\n\n        Object.keys(inputState.importedData.post_types || {}).map(\n          (postType) =>\n            inputState.importedData.post_types[postType] &&\n            inputState.importedData.post_types[postType].length > 0 && (\n              <>\n                <div>\n                  <b>{postTypeToLabel[postType] || 'Templates'}</b>\n                </div>\n                <ul>\n                  {inputState.importedData.post_types[postType].map(\n                    (post, postIndex) => (\n                      <li key={`post-${postIndex}`}>\n                        {inputState.importedData.old_to_new_id &&\n                        inputState.importedData.old_to_new_id[post.id] ? (\n                          // Link to newly created template\n                          <a\n                            href={`post.php?post=${\n                              inputState.importedData.old_to_new_id[post.id]\n                            }&action=edit`}\n                          >\n                            {post.title}\n                          </a>\n                        ) : (\n                          // Fallback in case we couldn't find new ID in map\n                          post.title\n                        )}\n                      </li>\n                    )\n                  )}\n                </ul>\n              </>\n            )\n        )\n      }\n\n      {\n        // Duplicates\n\n        inputState.duplicatesFound.length > 0 && (\n          <>\n            <p style={{ fontWeight: 'bold', color: 'red' }}>\n              {inputState.duplicatesFound.length} duplicate template\n              {inputState.duplicatesFound !== 1 ? 's' : ''} found\n            </p>\n            {\n              // Organize list of duplicate posts by post type\n              Object.keys(postTypeToLabel).map((postType) => {\n                const posts = inputState.duplicatesFound.filter(\n                  (post) => post.post_type === postType\n                )\n                if (!posts.length) return\n                return (\n                  <>\n                    <div>\n                      <b>{postTypeToLabel[postType] || 'Templates'}</b>\n                    </div>\n                    <ul>\n                      {posts.map((post, postIndex) => (\n                        <li key={`duplicate-post-${postIndex}`}>\n                          {post.title}\n                        </li>\n                      ))}\n                    </ul>\n                  </>\n                )\n              })\n            }\n            {/* <ul>\n          {inputState.duplicatesFound.map((post, postIndex) =>\n            <li key={`duplicate-post-${postIndex}`}>{ post.title }\n            </li>\n          )}\n        </ul> */}\n            <button\n              type=\"button\"\n              className=\"button button-primary\"\n              onClick={() => {\n                handleDuplicates({\n                  mode: 'overwrite',\n                  inputStateRef,\n                  setInputState,\n                })\n              }}\n            >\n              Overwrite\n            </button>\n            &nbsp;\n            <button\n              type=\"button\"\n              className=\"button button-primary\"\n              onClick={() => {\n                handleDuplicates({\n                  mode: 'keep_both',\n                  inputStateRef,\n                  setInputState,\n                })\n              }}\n            >\n              Keep both\n            </button>\n            &nbsp;\n            <button\n              type=\"button\"\n              className=\"button button-primary\"\n              onClick={() => {\n                // Clear state\n\n                setInputState({\n                  ...inputStateRef.current,\n                  importing: false,\n                  importData: {},\n                  importedData: {},\n                  duplicatesFound: [],\n                  duplicatesHandledMessage: '',\n                  message: '',\n                })\n              }}\n            >\n              Skip\n            </button>\n            {inputState.duplicatesHandledMessage && (\n              <p>{inputState.duplicatesHandledMessage}</p>\n            )}\n          </>\n        )\n      }\n    </div>\n  )\n}\n\nexport default Importer\n","import { useEffect, useRef } from 'react' // Aliased from Tangible.Preact || wp.element\n\n/**\n * Wrap Select2 module from vendor/tangible/interface\n *\n * @see https://select2.org/\n *\n * Also used in ../template-import-export\n */\nconst { jQuery: $ } = window\n\nconst Select = ({\n  labelForEmptyValue = '',\n  options = [],\n  value = '',\n  onChange,\n  multiSelect,\n  style,\n}) => {\n  const ref = useRef()\n\n  /**\n   * Activate Select2\n   */\n\n  useEffect(() => {\n    const $el = $(ref.current)\n    ref.current.$el = $el\n\n    onChange(value)\n\n    $el.tangibleSelect({\n      minimumResultsForSearch: 5,\n    })\n\n    if (multiSelect) {\n      // Ensure multiple values are selected on mount\n      $el.val(value)\n      $el.trigger('change')\n    }\n\n    $el.on('change', function (e) {\n      if (!multiSelect) {\n        onChange(e.target.value)\n        return\n      }\n\n      if (!ref.current) return\n\n      // Ensure array of values for multi-select\n\n      const values = $el.select2('data').map((item) => item.id)\n      onChange(values)\n    })\n\n    const select2 = (ref.current.select2 = $el.data('select2'))\n\n    // Clean up when component removed\n    return () => {\n      select2 && select2.destroy()\n    }\n  }, []) // NOTE: Empty array to run only once on component mount\n\n  // Ensure Select2 shows current value\n  if (ref.current && ref.current.$el) {\n    if (multiSelect) {\n      const currentValues = ref.current.$el.val()\n      if (value.length !== currentValues.length && options.length) {\n        // After select is rendered with options\n        setImmediate(function () {\n          ref.current.$el.val(value)\n          ref.current.$el.trigger('change')\n        })\n      }\n    } else if (ref.current.value !== value) {\n      ref.current.$el.val(value)\n      ref.current.$el.trigger('change')\n    }\n  }\n\n  return (\n    <select\n      ref={ref}\n      // onChange={e => onChange(e.target.value)}\n      autoComplete=\"off\"\n      multiple={multiSelect}\n      style={{\n        display: 'none',\n        width: '160px', // Default width\n        ...style,\n      }}\n    >\n      {labelForEmptyValue && (\n        <option value=\"\" disabled={true} selected={value == null}>\n          {labelForEmptyValue}\n        </option>\n      )}\n      {options.map((option, optionIndex) => (\n        <option\n          key={`option-${optionIndex}`}\n          value={option.value}\n          selected={option.value === value}\n        >\n          {option.label}\n        </option>\n      ))}\n    </select>\n  )\n}\n\nexport default Select\n","import Select from '../../common/Select'\n\n/**\n * Check for Block Editor plugin\n * @see /template/import-export/enqueue.php\n */\nconst { templateSystemHasPlugin: hasPlugin = {} } = window.Tangible\n\nconst ExportRule = ({\n  rule,\n  ruleIndex,\n\n  exportRulesRef,\n  setExportRules,\n\n  templateTypeItemOptionsRef,\n  ensureTemplateTypeItemOptions,\n}) => (\n  <div className=\"export-rule\">\n    <div className=\"export-rule-part\">\n      <Select\n        {...{\n          labelForEmptyValue: 'Select template type',\n          options: [\n\n            /**\n             * Enable block export only when Blocks & Editor is active\n             */\n            ...((hasPlugin['blocks'] && hasPlugin['blocks_editor'])\n              ? [{ label: 'Block', value: 'tangible_block' }]\n              : []),\n            ...(hasPlugin['loops'] || hasPlugin['template_system']\n              ? [\n                { label: 'Template', value: 'tangible_template' },\n                { label: 'Style', value: 'tangible_style' },\n                { label: 'Script', value: 'tangible_script' },\n                { label: 'Layout', value: 'tangible_layout' },\n              ]\n              : []\n            )\n          ],\n          value: rule.field,\n          onChange(field) {\n            rule.field = field\n\n            exportRulesRef.current[ruleIndex] = rule\n            setExportRules(exportRulesRef.current)\n          },\n        }}\n      />\n    </div>\n\n    {rule.field && (\n      <div className=\"export-rule-part\">\n        <Select\n          {...{\n            options: [\n              { label: 'All', value: 'all' },\n              { label: 'Include', value: 'include' },\n              { label: 'Exclude', value: 'exclude' },\n            ],\n            value: rule.operator,\n            onChange(operator) {\n              rule.operator = operator\n\n              if (operator === 'all') {\n                rule.values = [] // Clear values from include/exclude\n              }\n\n              exportRulesRef.current[ruleIndex] = rule\n              setExportRules(exportRulesRef.current)\n\n              if (operator !== 'all') {\n                ensureTemplateTypeItemOptions(rule.field)\n              }\n            },\n            style: { width: 'auto' },\n          }}\n        />\n      </div>\n    )}\n\n    {rule.field &&\n      rule.operator !== 'all' &&\n      templateTypeItemOptionsRef.current[rule.field] && (\n        <div className=\"export-rule-part\">\n          <Select\n            {...{\n              options:\n                templateTypeItemOptionsRef.current[rule.field] instanceof\n                Promise\n                  ? [] // Still loading\n                  : templateTypeItemOptionsRef.current[rule.field],\n\n              value: rule.values,\n\n              onChange(values) {\n                rule.values = values\n\n                exportRulesRef.current[ruleIndex] = rule\n                setExportRules(exportRulesRef.current)\n              },\n              multiSelect: true,\n            }}\n          />\n        </div>\n      )}\n\n    <div className=\"export-rule-part export-rule-part--remove-rule\">\n      <div\n        className=\"icon\"\n        onClick={() => {\n          // Remove this rule\n          exportRulesRef.current.splice(ruleIndex, 1)\n\n          setExportRules(exportRulesRef.current)\n        }}\n      >\n        <svg viewBox=\"0 0 1792 1792\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M1490 1322q0 40-28 68l-136 136q-28 28-68 28t-68-28l-294-294-294 294q-28 28-68 28t-68-28l-136-136q-28-28-28-68t28-68l294-294-294-294q-28-28-28-68t28-68l136-136q28-28 68-28t68 28l294 294 294-294q28-28 68-28t68 28l136 136q28 28 28 68t-28 68l-294 294 294 294q28 28 28 68z\" />\n        </svg>\n      </div>\n    </div>\n  </div>\n)\n\nexport default ExportRule\n","/**\n * Remember export settings in local storage\n */\nexport function saveStateToLocalStorage(state) {\n  if (!window.localStorage) return\n  window.localStorage.setItem('exporterState', JSON.stringify(state))\n}\n\nexport function getSavedStateFromLocalStorage() {\n  if (!window.localStorage) return\n  let state = window.localStorage.getItem('exporterState')\n  if (!state) return\n  try {\n    state = JSON.parse(state)\n    return state\n  } catch (e) {\n    /* Ignore */\n  }\n}\n","/**\n * Template exporter\n */\n\nimport { useEffect, useRef, useState } from 'react'\nimport ExportRule from './ExportRule'\nimport {\n  saveStateToLocalStorage,\n  getSavedStateFromLocalStorage,\n} from './localStorage'\n\nimport { ajax, ajaxActionPrefix } from '../common'\n\nconst debug = false // Set this to false for production\nconst log = (...args) => debug && console.log('[Exporter]', ...args)\n\nconst savedState = getSavedStateFromLocalStorage()\n\nconst defaultPackageName =\n  (savedState && savedState.name) || 'tangible-templates'\nconst defaultExportRules = (savedState && savedState.rules) || [\n  {\n    field: 'tangible_template',\n    operator: 'all',\n    values: [],\n  },\n]\n\nconst Exporter = () => {\n  // Export package name\n  const exportNameRef = useRef()\n\n  // Rules state\n\n  const [exportRules, _setExportRules] = useState(defaultExportRules)\n\n  const exportRulesRef = useRef()\n  exportRulesRef.current = exportRules // Keep ever-fresh reference for event callbacks to use\n\n  const setExportRules = (rules) => {\n    _setExportRules([...rules]) // Must create new state to re-render\n  }\n\n  // log('exportRulesRef.current', exportRulesRef.current)\n\n  // AJAX data state\n\n  const [templateTypeItemOptions, setTemplateTypeItemOptions] = useState({})\n  const templateTypeItemOptionsRef = useRef()\n\n  // Keep ever-fresh reference for event callbacks to use\n  templateTypeItemOptionsRef.current = templateTypeItemOptions\n\n  // log('templateTypeItemOptionsRef.current', templateTypeItemOptionsRef.current)\n\n  // Export state\n\n  const [exportState, _setExportState] = useState({\n    exporting: false,\n    message: '',\n    json: '',\n    packageName: '',\n  })\n\n  const exportStateRef = useRef()\n  exportStateRef.current = exportState\n\n  const setExportState = (newState) => {\n    _setExportState({\n      ...exportStateRef.current,\n      ...newState,\n    })\n  }\n\n  // Ensure data\n\n  const ensureTemplateTypeItemOptions = async (templateType) => {\n    // We already have data (or is loading it)\n    if (templateTypeItemOptionsRef.current[templateType]) return\n\n    log(\n      'ensureTemplateTypeItemOptions',\n      templateType,\n      templateTypeItemOptionsRef.current\n    )\n\n    const promise = ajax(ajaxActionPrefix + 'get_template_type_item_options', {\n      post_type: templateType,\n    })\n      .then((result) => {\n        log('ensureTemplateTypeItemOptions Success', result)\n\n        setTemplateTypeItemOptions({\n          ...templateTypeItemOptionsRef.current,\n          [templateType]: result,\n        })\n      })\n      .catch((error) => {\n        log('ensureTemplateTypeItemOptions Fail', error)\n      })\n\n    // Store promise to prevent loading multiple times\n    setTemplateTypeItemOptions({\n      ...templateTypeItemOptionsRef.current,\n      [templateType]: promise,\n    })\n  }\n\n  return (\n    <div id=\"exporter\">\n      <div className=\"export-name\">\n        Package name:{' '}\n        <input\n          type=\"text\"\n          name=\"name\"\n          defaultValue={defaultPackageName}\n          ref={exportNameRef}\n        />\n      </div>\n\n      <div className=\"export-rules\">\n        {exportRules.map((rule, ruleIndex) => (\n          <ExportRule\n            key={`export-rule-${ruleIndex}`}\n            {...{\n              rule,\n              ruleIndex,\n\n              exportRulesRef,\n              setExportRules,\n\n              templateTypeItemOptionsRef,\n              ensureTemplateTypeItemOptions,\n            }}\n          />\n        ))}\n      </div>\n\n      <p>\n        <button\n          type=\"button\"\n          className=\"button button-secondary\"\n          onClick={() => {\n            // Add export rule\n\n            exportRulesRef.current.push({\n              field: 'tangible_template',\n              operator: 'all',\n              values: [],\n            })\n\n            setExportRules(exportRulesRef.current)\n          }}\n        >\n          Add export rule\n        </button>\n      </p>\n\n      {exportRulesRef.current.length > 0 && (\n        <p>\n          <button\n            type=\"button\"\n            className=\"button button-primary\"\n            disabled={exportState.exporting}\n            onClick={() => {\n              const packageName =\n                (exportNameRef.current && exportNameRef.current.value) ||\n                defaultPackageName\n\n              saveStateToLocalStorage({\n                name: packageName,\n                rules: exportRulesRef.current,\n              })\n\n              // Export\n\n              log('Export start', exportRulesRef.current)\n\n              setExportState({\n                exporting: true,\n                message: 'Exporting..',\n              })\n\n              ajax(ajaxActionPrefix + 'export', {\n                export_rules: exportRulesRef.current,\n              })\n                .then((result) => {\n                  console.log('Export success', result)\n\n                  setExportState({\n                    exporting: false,\n                    message: '',\n                    // json: JSON.stringify(result, null, 2)\n                  })\n\n                  // Download JSON file\n\n                  const data = {\n                    package_name: packageName,\n                    ...result,\n                  }\n\n                  const timestamp = new Date()\n                    .toISOString()\n                    .slice(0, 10)\n                    .replace(/-/g, '') // Ymd\n\n                  const a = document.createElement('a')\n\n                  a.href =\n                    'data:text/json;charset=utf-8,' +\n                    encodeURIComponent(JSON.stringify(data, null, 2))\n                  a.download = `${packageName}-${timestamp}.json`\n                  a.style.display = 'none'\n\n                  document.body.appendChild(a)\n\n                  a.click()\n                })\n                .catch((error) => {\n                  console.error(error)\n\n                  setExportState({\n                    exporting: false,\n                    message: 'Error: ' + error.message,\n                  })\n                })\n            }}\n          >\n            Export\n          </button>\n\n          {exportState.message && (\n            <span style={{ paddingLeft: '1rem' }}>{exportState.message}</span>\n          )}\n        </p>\n      )}\n    </div>\n  )\n}\n\nexport default Exporter\n","/**\n * Template import/export\n *\n * @see /template/import-export/ajax.php, view.php\n */\n\nimport Importer from './Importer'\nimport Exporter from './Exporter'\n\nconst {\n  Tangible: {\n    Preact,\n    /**\n     * Check for installed plugins\n     * @see /template/import-export/enqueue.php\n     */\n    templateSystemHasPlugin: hasPlugin = {}\n  },\n} = window\n\nconst el = document.getElementById('tangible_template_import_export_form')\n\nel.addEventListener('submit', function (e) {\n  e.preventDefault()\n})\n\nconst hasExport =\n  hasPlugin['loops'] // Loop & Logic\n  || hasPlugin['blocks_editor'] // Tangible Blocks Editor\n  || hasPlugin['template_system'] // Template System module as standalone plugin\n\nPreact.render(\n  <>\n    <h1 className=\"wp-heading-inline\">Import</h1>\n\n    <Importer />\n\n    { hasExport && <>\n      <hr />\n      <h1 className=\"wp-heading-inline\">Export</h1>\n      <Exporter />\n    </> \n    }\n  </>,\n  el\n)\n"],"names":["ajax","ajaxActionPrefix","handleDuplicates","mode","inputStateRef","setInputState","importData","duplicates","id","title","post_type","postData","post","result","importedData","error","__name","useState","f","r","s","n","_","o","y","w","F","t","m","a","i","l","p","k","u","useEffect","useRef","d","c","h","e","hasPlugin","ExportRule","rule","ruleIndex","exportRulesRef","setExportRules","templateTypeItemOptionsRef","ensureTemplateTypeItemOptions","Select","field","operator","values","saveStateToLocalStorage","state","getSavedStateFromLocalStorage","g","b","E","S","O","T","Preact","el","hasExport","Importer","Exporter"],"mappings":"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"}
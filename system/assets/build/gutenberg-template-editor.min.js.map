{"version":3,"file":"gutenberg-template-editor.min.js.map","sources":["../src/gutenberg-template-editor/blocks/template/ServerSideRender.jsx","../src/gutenberg-template-editor/blocks/template/index.jsx","../src/gutenberg-template-editor/index.jsx"],"sourcesContent":["/**\r\n * Based on https://github.com/WordPress/gutenberg/blob/trunk/packages/server-side-render/src/server-side-render.js\r\n *\r\n * Forked to support callback onFetchResponseRendered, used by dynamic module loader\r\n */\r\n\r\nconst { wp, lodash } = window\r\nconst { isEqual } = lodash\r\nconst {\r\n  apiFetch,\r\n  blocks: {\r\n    __experimentalSanitizeBlockAttributes,\r\n    sanitizeBlockAttributes\r\n  },\r\n  components: { Placeholder, Spinner },\r\n  compose: { useDebounce, usePrevious },\r\n  element: { RawHTML, useEffect, useRef, useState },\r\n  i18n: { __, sprintf },\r\n  url: { addQueryArgs }\r\n} = wp\r\n\r\nexport function rendererPath( block, attributes = null, urlQueryArgs = {} ) {\r\n\treturn addQueryArgs( `/wp/v2/block-renderer/${ block }`, {\r\n\t\tcontext: 'edit',\r\n\t\t...( null !== attributes ? { attributes } : {} ),\r\n\t\t...urlQueryArgs,\r\n\t} );\r\n}\r\n\r\nfunction DefaultEmptyResponsePlaceholder( { className } ) {\r\n\treturn (\r\n\t\t<Placeholder className={ className }>\r\n\t\t\t{ __( 'Block rendered as empty.' ) }\r\n\t\t</Placeholder>\r\n\t);\r\n}\r\n\r\nfunction DefaultErrorResponsePlaceholder( { response, className } ) {\r\n\tconst errorMessage = sprintf(\r\n\t\t// translators: %s: error message describing the problem\r\n\t\t__( 'Error loading block: %s' ),\r\n\t\tresponse.errorMsg\r\n\t);\r\n\treturn <Placeholder className={ className }>{ errorMessage }</Placeholder>;\r\n}\r\n\r\nfunction DefaultLoadingResponsePlaceholder( { children, showLoader } ) {\r\n\treturn (\r\n\t\t<div style={ { position: 'relative' } }>\r\n\t\t\t{ showLoader && (\r\n\t\t\t\t<div\r\n\t\t\t\t\tstyle={ {\r\n\t\t\t\t\t\tposition: 'absolute',\r\n\t\t\t\t\t\ttop: '50%',\r\n\t\t\t\t\t\tleft: '50%',\r\n\t\t\t\t\t\tmarginTop: '-9px',\r\n\t\t\t\t\t\tmarginLeft: '-9px',\r\n\t\t\t\t\t} }\r\n\t\t\t\t>\r\n\t\t\t\t\t<Spinner />\r\n\t\t\t\t</div>\r\n\t\t\t) }\r\n\t\t\t<div style={ { opacity: showLoader ? '0.3' : 1 } }>\r\n\t\t\t\t{ children }\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nfunction Content({\r\n  className,\r\n  children,\r\n  onMount\r\n}) {\r\n  const ref = useRef()\r\n  useEffect(() => {\r\n    if (onMount) onMount(ref.current)\r\n  }, [])\r\n  return <div ref={ref} className=\"tangible-server-side-render\">\r\n    <RawHTML className={ className }>{ children }</RawHTML>\r\n  </div>\r\n}\r\n\r\n\r\nexport default function ServerSideRender( props ) {\r\n\tconst {\r\n\t\tattributes,\r\n\t\tblock,\r\n\t\tclassName,\r\n\t\thttpMethod = 'GET',\r\n\t\turlQueryArgs,\r\n\t\tEmptyResponsePlaceholder = DefaultEmptyResponsePlaceholder,\r\n\t\tErrorResponsePlaceholder = DefaultErrorResponsePlaceholder,\r\n\t\tLoadingResponsePlaceholder = DefaultLoadingResponsePlaceholder,\r\n    onFetchResponseRendered\r\n\t} = props;\r\n\r\n\tconst isMountedRef = useRef( true );\r\n\tconst [ showLoader, setShowLoader ] = useState( false );\r\n\tconst fetchRequestRef = useRef();\r\n\tconst [ response, setResponse ] = useState( null );\r\n\tconst prevProps = usePrevious( props );\r\n\tconst [ isLoading, setIsLoading ] = useState( false );\r\n\r\n\tfunction fetchData() {\r\n\t\tif ( ! isMountedRef.current ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetIsLoading( true );\r\n\r\n\t\tconst sanitizedAttributes =\r\n\t\t\tattributes &&\r\n\t\t\t(sanitizeBlockAttributes || __experimentalSanitizeBlockAttributes)( block, attributes );\r\n\r\n\t\t// If httpMethod is 'POST', send the attributes in the request body instead of the URL.\r\n\t\t// This allows sending a larger attributes object than in a GET request, where the attributes are in the URL.\r\n\t\tconst isPostRequest = 'POST' === httpMethod;\r\n\t\tconst urlAttributes = isPostRequest\r\n\t\t\t? null\r\n\t\t\t: sanitizedAttributes ?? null;\r\n\t\tconst path = rendererPath( block, urlAttributes, urlQueryArgs );\r\n\t\tconst data = isPostRequest\r\n\t\t\t? { attributes: sanitizedAttributes ?? null }\r\n\t\t\t: null;\r\n\r\n\t\t// Store the latest fetch request so that when we process it, we can\r\n\t\t// check if it is the current request, to avoid race conditions on slow networks.\r\n\t\tconst fetchRequest = ( fetchRequestRef.current = apiFetch( {\r\n\t\t\tpath,\r\n\t\t\tdata,\r\n\t\t\tmethod: isPostRequest ? 'POST' : 'GET',\r\n\t\t} )\r\n\t\t\t.then( ( fetchResponse ) => {\r\n\t\t\t\tif (\r\n\t\t\t\t\tisMountedRef.current &&\r\n\t\t\t\t\tfetchRequest === fetchRequestRef.current &&\r\n\t\t\t\t\tfetchResponse\r\n\t\t\t\t) {\r\n\t\t\t\t\tsetResponse( fetchResponse.rendered );\r\n\t\t\t\t}\r\n\t\t\t} )\r\n\t\t\t.catch( ( error ) => {\r\n\t\t\t\tif (\r\n\t\t\t\t\tisMountedRef.current &&\r\n\t\t\t\t\tfetchRequest === fetchRequestRef.current\r\n\t\t\t\t) {\r\n\t\t\t\t\tsetResponse( {\r\n\t\t\t\t\t\terror: true,\r\n\t\t\t\t\t\terrorMsg: error.message,\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t} )\r\n\t\t\t.finally( () => {\r\n\t\t\t\tif (\r\n\t\t\t\t\tisMountedRef.current &&\r\n\t\t\t\t\tfetchRequest === fetchRequestRef.current\r\n\t\t\t\t) {\r\n\t\t\t\t\tsetIsLoading( false );\r\n\t\t\t\t}\r\n\t\t\t} ) );\r\n\r\n\t\treturn fetchRequest;\r\n\t}\r\n\r\n\tconst debouncedFetchData = useDebounce( fetchData, 500 );\r\n\r\n\t// When the component unmounts, set isMountedRef to false. This will\r\n\t// let the async fetch callbacks know when to stop.\r\n\tuseEffect(\r\n\t\t() => () => {\r\n\t\t\tisMountedRef.current = false;\r\n\t\t},\r\n\t\t[]\r\n\t);\r\n\r\n\tuseEffect( () => {\r\n\t\t// Don't debounce the first fetch. This ensures that the first render\r\n\t\t// shows data as soon as possible.\r\n\t\tif ( prevProps === undefined ) {\r\n\t\t\tfetchData();\r\n\t\t} else if ( ! isEqual( prevProps, props ) ) {\r\n\t\t\tdebouncedFetchData();\r\n\t\t}\r\n\t} );\r\n\r\n\t/**\r\n\t * Effect to handle showing the loading placeholder.\r\n\t * Show it only if there is no previous response or\r\n\t * the request takes more than one second.\r\n\t */\r\n\tuseEffect( () => {\r\n\t\tif ( ! isLoading ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst timeout = setTimeout( () => {\r\n\t\t\tsetShowLoader( true );\r\n\t\t}, 1000 );\r\n\t\treturn () => clearTimeout( timeout );\r\n\t}, [ isLoading ] );\r\n\r\n\tconst hasResponse = !! response;\r\n\tconst hasEmptyResponse = response === '';\r\n\tconst hasError = response?.error;\r\n\r\n\tif ( isLoading ) {\r\n\t\treturn (\r\n\t\t\t<LoadingResponsePlaceholder { ...props } showLoader={ showLoader }>\r\n\t\t\t\t{ hasResponse && (\r\n\t\t\t\t\t<RawHTML className={ className }>{ response }</RawHTML>\r\n\t\t\t\t) }\r\n\t\t\t</LoadingResponsePlaceholder>\r\n\t\t);\r\n\t}\r\n\r\n\tif ( hasEmptyResponse || ! hasResponse ) {\r\n\t\treturn <EmptyResponsePlaceholder { ...props } />;\r\n\t}\r\n\r\n\tif ( hasError ) {\r\n\t\treturn <ErrorResponsePlaceholder response={ response } { ...props } />;\r\n\t}\r\n\r\n\treturn <Content className={ className } onMount={onFetchResponseRendered}\r\n  >{ response }</Content>;\r\n}\r\n","import ServerSideRender from './ServerSideRender'\r\n\r\nconst { wp, Tangible, lodash } = window\r\nconst {\r\n  element: { Component },\r\n  blockEditor: { BlockControls, InspectorControls },\r\n  blocks: { registerBlockType },\r\n  components: {\r\n    Button,\r\n    DropdownMenu,\r\n    KeyboardShortcuts,\r\n    SelectControl,\r\n    TextControl,\r\n    ToolbarItem,\r\n    ToolbarButton,\r\n    ToolbarGroup,\r\n    Panel,\r\n    PanelBody,\r\n    PanelRow,\r\n    withConstrainedTabbing,\r\n  },\r\n  i18n: { __ },\r\n  keycodes: { rawShortcut },\r\n  // serverSideRender: ServerSideRender,\r\n} = wp\r\nconst {\r\n  CodeMirror,\r\n  createCodeEditor,\r\n  gutenbergConfig,\r\n  moduleLoader\r\n} = Tangible\r\n\r\n/**\r\n * Pass it to Tangible Blocks\r\n * @see tangible-blocks/assets/src/gutenberg-integration/blocks\r\n */\r\nTangible.ServerSideRender = ServerSideRender\r\n\r\n/**\r\n * Workaround for Gutenberg issue with keyboard shortcuts\r\n *\r\n * Problem:\r\n * @see https://github.com/WordPress/gutenberg/issues/15190\r\n *\r\n * Solution:\r\n * @see https://github.com/WordPress/gutenberg/issues/18755#issuecomment-568269535\r\n *\r\n * Reference:\r\n * @see https://github.com/WordPress/gutenberg/blob/trunk/packages/keycodes/src/index.js for keycodes, modifiers\r\n * @see https://github.com/ccampbell/mousetrap\r\n */\r\nconst stop = (e) => e.stopImmediatePropagation()\r\nconst stopGutenbergShortcuts = {\r\n  tab: stop,\r\n  [rawShortcut.shift('tab')]: stop,\r\n  [rawShortcut.ctrl('[')]: stop,\r\n  [rawShortcut.primary('[')]: stop,\r\n  [rawShortcut.ctrl(']')]: stop,\r\n  [rawShortcut.primary(']')]: stop,\r\n  [rawShortcut.ctrl('a')]: stop,\r\n  [rawShortcut.primary('a')]: stop,\r\n  [rawShortcut.ctrl('d')]: stop,\r\n  [rawShortcut.primary('d')]: stop,\r\n  [rawShortcut.ctrl('z')]: stop,\r\n  [rawShortcut.ctrlShift('z')]: stop,\r\n  [rawShortcut.primary('z')]: stop,\r\n  [rawShortcut.primaryShift('z')]: stop,\r\n}\r\n\r\nconst EmptyTemplate = () => <div>&nbsp;</div>\r\n\r\nclass TemplateEditor extends Component {\r\n  componentDidMount() {\r\n    const editor = createCodeEditor(this.el, {\r\n      language: 'html',\r\n      resizable: true,\r\n    })\r\n\r\n    // Full height - Prevent width resize, scroll instead\r\n    editor.setSize(null, '100%')\r\n\r\n    // editor.focus() // Don't focus, since there can be multiple Template blocks\r\n\r\n    this.editor = editor\r\n    this.editor.on('change', this.onEditorUpdate)\r\n\r\n    /**\r\n     * Workaround for Gutenburg full-site editor\r\n     *\r\n     * Without this, any template editor block that already exists on the page\r\n     * is not visible. Newly added template block is not affected by the issue.\r\n     */\r\n    if (wp.editSite) {\r\n      setTimeout(function() {\r\n        editor.refresh()\r\n      }, 120)\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.editor.off('change', this.onEditorUpdate)\r\n  }\r\n\r\n  shouldComponentUpdate() {\r\n    return false\r\n  }\r\n\r\n  onEditorUpdate = () => {\r\n    const { onChange } = this.props\r\n    if (onChange) onChange(this.editor.getValue())\r\n  }\r\n\r\n  render() {\r\n    const { value, onChange } = this.props\r\n    return (\r\n      <KeyboardShortcuts shortcuts={stopGutenbergShortcuts}>\r\n        <textarea\r\n          ref={(el) => (this.el = el)}\r\n          value={value}\r\n          onChange={(e) => {\r\n            onChange(e.target.value)\r\n          }}\r\n          cols=\"30\"\r\n          rows=\"10\"\r\n        ></textarea>\r\n      </KeyboardShortcuts>\r\n    )\r\n  }\r\n}\r\n\r\nclass edit extends Component {\r\n  canEditTemplate = gutenbergConfig.canEditTemplate\r\n\r\n  state = {\r\n    /**\r\n     * Current tab showing: editor, selectTemplate, or preview\r\n     */\r\n    currentTab:\r\n      this.props.attributes.template_selected || !this.canEditTemplate\r\n        ? 'selectTemplate'\r\n        : 'editor',\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    /**\r\n     * Current post ID\r\n     * Used in integrations/gutenberg/enqueue to set loop context\r\n     */\r\n    this.props.attributes.current_post_id = gutenbergConfig.current_post_id || 0\r\n\r\n    /**\r\n     * Prepare template options\r\n     */\r\n\r\n    this.templateOptions = []\r\n\r\n    const options = gutenbergConfig.templateOptions // From server-side: [ { id: title }, .. ]\r\n    const optionKeys = Object.keys(options)\r\n\r\n    // Convert to select options\r\n\r\n    for (const id of optionKeys) {\r\n      this.templateOptions.push({\r\n        value: id ? parseInt(id, 10) : id, // ID can be null if no templates available\r\n        label: options[id],\r\n      })\r\n    }\r\n  }\r\n\r\n  showTab(tab) {\r\n    if (this.state.currentTab === tab) return // Already showing tab\r\n\r\n    this.setState({ currentTab: tab })\r\n\r\n    if (tab === 'editor' && this.props.attributes.template_selected) {\r\n      // Clear selected template\r\n\r\n      this.props.setAttributes({\r\n        template_selected: 0,\r\n      })\r\n    } else if (\r\n      tab === 'selectTemplate' &&\r\n      !this.props.attributes.template_selected\r\n    ) {\r\n      // Select first option if nothing selected yet\r\n\r\n      this.props.setAttributes({\r\n        template_selected: this.templateOptions[0].value,\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { className, attributes, setAttributes } = this.props\r\n    const { currentTab } = this.state\r\n\r\n    return (\r\n      <>\r\n        <BlockControls>\r\n          <ToolbarGroup>\r\n            {this.canEditTemplate && (\r\n              <Button\r\n                className=\"components-tab-button\"\r\n                isPressed={currentTab === 'editor'}\r\n                onClick={() => this.showTab('editor')}\r\n              >\r\n                <span>{__('Editor')}</span>\r\n              </Button>\r\n            )}\r\n\r\n            <Button\r\n              className=\"components-tab-button\"\r\n              isPressed={currentTab === 'selectTemplate'}\r\n              onClick={() => this.showTab('selectTemplate')}\r\n            >\r\n              <span>{__('Saved templates')}</span>\r\n            </Button>\r\n          </ToolbarGroup>\r\n          <ToolbarGroup>\r\n            <Button\r\n              className=\"components-tab-button\"\r\n              isPressed={currentTab === 'preview'}\r\n              onClick={() => this.showTab('preview')}\r\n            >\r\n              <span>{__('Preview')}</span>\r\n            </Button>\r\n          </ToolbarGroup>\r\n        </BlockControls>\r\n\r\n        {currentTab === 'preview' ?\r\n          /**\r\n           * Note: Ensure props are \"equal\" on every render - for example,\r\n           * don't create new function here - because it fetches on prop change.\r\n           */\r\n          <ServerSideRender\r\n            block=\"tangible/template\"\r\n            className={className}\r\n            attributes={attributes}\r\n            EmptyResponsePlaceholder={EmptyTemplate}\r\n            LoadingResponsePlaceholder={EmptyTemplate}\r\n            onFetchResponseRendered={moduleLoader}\r\n          />\r\n        : this.canEditTemplate && currentTab === 'editor' ? (\r\n          <TemplateEditor\r\n            value={attributes.template}\r\n            onChange={(val) =>\r\n              setAttributes({\r\n                template: val,\r\n              })\r\n            }\r\n          />\r\n        ) : (\r\n          <SelectControl\r\n            label={'Select template'}\r\n            value={attributes.template_selected}\r\n            style={{ height: '60px' }}\r\n            onChange={(val) =>\r\n              setAttributes({\r\n                template_selected: val ? parseInt(val, 10) : val,\r\n              })\r\n            }\r\n            options={this.templateOptions}\r\n          />\r\n        )}\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nregisterBlockType('tangible/template', {\r\n  title: __('Tangible Template'),\r\n  description: __('Dynamic template'),\r\n  icon: 'editor-code',\r\n  category: 'common',\r\n  keywords: [__('template', 'loop', 'content')],\r\n\r\n  edit,\r\n\r\n  save() {\r\n    // Dynamic block\r\n    return null\r\n  },\r\n})\r\n","import './blocks/template'\r\n\r\nconst { wp } = window\r\nconst {\r\n  blocks: { registerBlockCollection },\r\n} = wp\r\n\r\n/**\r\n * Register block collection \"Tangible\"\r\n *\r\n * Feature is available from WP 5.4\r\n * @see https://make.wordpress.org/core/2020/02/27/block-collections\r\n */\r\n\r\nif (registerBlockCollection) {\r\n  registerBlockCollection('tangible', {\r\n    title: 'Tangible',\r\n    icon: (\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 99 99\">\r\n        <path d=\"M0 0 H 33 V 33 H 0 L 0 0\" fill=\"#262262\" />\r\n        <path d=\"M33 0 H 66 V 33 H 33 L 33 0\" fill=\"#662d91\" />\r\n        <path d=\"M66 0 H 99 V 33 H 66 L 66 0\" fill=\"#9f1f63\" />\r\n\r\n        <path d=\"M0 33 H 33 V 66 H 0 L 0 33\" fill=\"#2e3192\" />\r\n        <path d=\"M66 33 H 99 V 66 H 66 L 66 33\" fill=\"#ec008c\" />\r\n\r\n        <path d=\"M33 66 H 66 V 99 H 33 L 33 66\" fill=\"#02aeef\" />\r\n      </svg>\r\n    ),\r\n  })\r\n}\r\n"],"names":["wp","lodash","isEqual","apiFetch","__experimentalSanitizeBlockAttributes","sanitizeBlockAttributes","Placeholder","Spinner","useDebounce","usePrevious","RawHTML","useEffect","useRef","useState","__","sprintf","addQueryArgs","rendererPath","block","attributes","urlQueryArgs","__spreadValues","__name","DefaultEmptyResponsePlaceholder","className","DefaultErrorResponsePlaceholder","response","errorMessage","DefaultLoadingResponsePlaceholder","children","showLoader","Content","onMount","ref","ServerSideRender","props","httpMethod","EmptyResponsePlaceholder","ErrorResponsePlaceholder","LoadingResponsePlaceholder","onFetchResponseRendered","isMountedRef","setShowLoader","fetchRequestRef","setResponse","prevProps","isLoading","setIsLoading","fetchData","sanitizedAttributes","isPostRequest","urlAttributes","path","data","fetchRequest","fetchResponse","error","debouncedFetchData","timeout","hasResponse","hasEmptyResponse","hasError","__spreadProps","Tangible","Component","BlockControls","InspectorControls","registerBlockType","Button","DropdownMenu","KeyboardShortcuts","SelectControl","TextControl","ToolbarItem","ToolbarButton","ToolbarGroup","Panel","PanelBody","PanelRow","withConstrainedTabbing","rawShortcut","CodeMirror","createCodeEditor","gutenbergConfig","moduleLoader","stop","e","stopGutenbergShortcuts","EmptyTemplate","TemplateEditor","__publicField","onChange","editor","value","el","edit","options","optionKeys","id","tab","setAttributes","currentTab","val","registerBlockCollection"],"mappings":"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"}
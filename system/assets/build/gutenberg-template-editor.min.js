var Me=Object.defineProperty;var s=(S,P)=>Me(S,"name",{value:P,configurable:!0});(function(){"use strict";(function(){const r={NODE_ENV:"production"};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,r);return}}catch{}globalThis.process={env:r}})();function S(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}s(S,"getDefaultExportFromCjs");var P=s(function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var l,n,u;if(Array.isArray(e)){if(l=e.length,l!=t.length)return!1;for(n=l;n--!==0;)if(!r(e[n],t[n]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(n of e.entries())if(!t.has(n[0]))return!1;for(n of e.entries())if(!r(n[1],t.get(n[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(n of e.entries())if(!t.has(n[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(l=e.length,l!=t.length)return!1;for(n=l;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(u=Object.keys(e),l=u.length,l!==Object.keys(t).length)return!1;for(n=l;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,u[n]))return!1;for(n=l;n--!==0;){var v=u[n];if(!r(e[v],t[v]))return!1}return!0}return e!==e&&t!==t},"equal"),ae=S(P),ce=Object.defineProperty,p=s((r,e)=>ce(r,"name",{value:e,configurable:!0}),"s$1");const{wp:a}=window,{apiFetch:ie,blocks:{__experimentalSanitizeBlockAttributes:ue,sanitizeBlockAttributes:Ne},components:{Placeholder:H,Spinner:pe},compose:{useDebounce:me,usePrevious:de},element:{RawHTML:$,useEffect:y,useRef:k,useState:O},i18n:{__:x,sprintf:fe},url:{addQueryArgs:he}}=a;function D({className:r,children:e,onMount:t}){const l=k();return y(()=>{t&&t(l.current)},[]),a.element.createElement("div",{ref:l,className:"tangible-server-side-render"},a.element.createElement($,{className:r},e))}s(D,"U$1"),p(D,"Content");const Ee={};function V(r,e=null,t={}){return he(`/wp/v2/block-renderer/${r}`,{context:"edit",...e!==null?{attributes:e}:{},...t})}s(V,"rendererPath"),p(V,"rendererPath");function F(r){const{backgroundColor:e,borderColor:t,fontFamily:l,fontSize:n,gradient:u,textColor:v,className:Y,...B}=r,{border:Z,color:ee,elements:f,spacing:te,typography:re,...h}=r?.style||Ee;return{...B,style:h}}s(F,"removeBlockSupportAttributes"),p(F,"removeBlockSupportAttributes");function U({className:r}){return a.element.createElement(H,{className:r},x("Block rendered as empty."))}s(U,"W"),p(U,"DefaultEmptyResponsePlaceholder");function I({response:r,className:e}){const t=fe(x("Error loading block: %s"),r.errorMsg);return a.element.createElement(H,{className:e},t)}s(I,"X"),p(I,"DefaultErrorResponsePlaceholder");function G({children:r,showLoader:e}){return a.element.createElement("div",{style:{position:"relative"}},e&&a.element.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",marginTop:"-9px",marginLeft:"-9px"}},a.element.createElement(pe,null)),a.element.createElement("div",{style:{opacity:e?"0.3":1}},r))}s(G,"Z"),p(G,"DefaultLoadingResponsePlaceholder");function C(r){const{attributes:e,block:t,className:l,httpMethod:n="GET",urlQueryArgs:u,skipBlockSupportAttributes:v=!1,EmptyResponsePlaceholder:Y=U,ErrorResponsePlaceholder:B=I,LoadingResponsePlaceholder:Z=G,onFetchResponseRendered:ee}=r,f=k(!0),[te,re]=O(!1),h=k(),[E,ne]=O(null),le=de(r),[j,oe]=O(!1);function L(){if(!f.current)return;oe(!0);let g=e&&ue(t,e);v&&(g=F(g));const z=n==="POST",_e=V(t,z?null:g??null,u),Re=z?{attributes:g??null}:null,T=h.current=ie({path:_e,data:Re,method:z?"POST":"GET"}).then(w=>{f.current&&T===h.current&&w&&ne(w.rendered)}).catch(w=>{f.current&&T===h.current&&ne({error:!0,errorMsg:w.message})}).finally(()=>{f.current&&T===h.current&&oe(!1)});return T}s(L,"x"),p(L,"fetchData");const ke=me(L,500);y(()=>()=>{f.current=!1},[]),y(()=>{le===void 0?L():ae(le,r)||ke()}),y(()=>{if(!j)return;const g=setTimeout(()=>{re(!0)},1e3);return()=>clearTimeout(g)},[j]);const se=!!E,Oe=E==="",Ce=E?.error;return j?a.element.createElement(Z,{...r,showLoader:te},se&&a.element.createElement($,{className:l},E)):Oe||!se?a.element.createElement(Y,{...r}):Ce?a.element.createElement(B,{response:E,...r}):a.element.createElement(D,{className:l,onMount:ee},E)}s(C,"w$1"),p(C,"ServerSideRender");var K=Object.defineProperty,ge=s((r,e,t)=>e in r?K(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,"E"),b=s((r,e)=>K(r,"name",{value:e,configurable:!0}),"p"),_=s((r,e,t)=>(ge(r,typeof e!="symbol"?e+"":e,t),t),"m");const{wp:o,Tangible:Q,lodash:Ae}=window,{element:{Component:q},blockEditor:{BlockControls:be,InspectorControls:Be},blocks:{registerBlockType:ve},components:{Button:R,DropdownMenu:je,KeyboardShortcuts:ye,SelectControl:Te,TextControl:Le,ToolbarItem:ze,ToolbarButton:He,ToolbarGroup:W,Panel:$e,PanelBody:xe,PanelRow:De,withConstrainedTabbing:Ve},i18n:{__:d},keycodes:{rawShortcut:i}}=o,{createCodeEditor:we,gutenbergConfig:M,moduleLoader:Se}=Q;Q.ServerSideRender=C;const c=b(r=>r.stopImmediatePropagation(),"stop"),Pe={tab:c,[i.shift("tab")]:c,[i.ctrl("[")]:c,[i.primary("[")]:c,[i.ctrl("]")]:c,[i.primary("]")]:c,[i.ctrl("a")]:c,[i.primary("a")]:c,[i.ctrl("d")]:c,[i.primary("d")]:c,[i.ctrl("z")]:c,[i.ctrlShift("z")]:c,[i.primary("z")]:c,[i.primaryShift("z")]:c},J=b(()=>o.element.createElement("div",null,"\xA0"),"EmptyTemplate");class N extends q{constructor(){super(...arguments),_(this,"onEditorUpdate",b(()=>{const{onChange:e}=this.props;e&&e(this.editor.getValue())},"onEditorUpdate"))}componentDidMount(){(async()=>{const e=await we(this.el,{language:"html",resizable:!0});e.setSize(null,"100%"),this.editor=e,this.editor.on("change",this.onEditorUpdate),o.editSite&&setTimeout(function(){e.refresh()},120)})().catch(console.error)}componentWillUnmount(){this.editor.off("change",this.onEditorUpdate)}shouldComponentUpdate(){return!1}render(){const{value:e,onChange:t}=this.props;return o.element.createElement(ye,{shortcuts:Pe},o.element.createElement("textarea",{ref:l=>this.el=l,value:e,onChange:l=>{t(l.target.value)},style:{display:"none"},cols:"30",rows:"10"}))}}s(N,"S"),b(N,"TemplateEditor");class A extends q{constructor(e){super(e),_(this,"canEditTemplate",M.canEditTemplate),_(this,"state",{currentTab:this.props.attributes.template_selected||!this.canEditTemplate?"selectTemplate":"editor"}),this.props.attributes.current_post_id=M.current_post_id||0,this.templateOptions=[];const t=M.templateOptions,l=Object.keys(t);for(const n of l)this.templateOptions.push({value:n&&parseInt(n,10),label:t[n]})}showTab(e){this.state.currentTab!==e&&(this.setState({currentTab:e}),e==="editor"&&this.props.attributes.template_selected?this.props.setAttributes({template_selected:0}):e==="selectTemplate"&&!this.props.attributes.template_selected&&this.props.setAttributes({template_selected:this.templateOptions[0].value}))}render(){const{className:e,attributes:t,setAttributes:l}=this.props,{currentTab:n}=this.state;return o.element.createElement(o.element.Fragment,null,o.element.createElement(be,null,o.element.createElement(W,null,this.canEditTemplate&&o.element.createElement(R,{className:"components-tab-button",isPressed:n==="editor",onClick:()=>this.showTab("editor")},o.element.createElement("span",null,d("Editor"))),o.element.createElement(R,{className:"components-tab-button",isPressed:n==="selectTemplate",onClick:()=>this.showTab("selectTemplate")},o.element.createElement("span",null,d("Saved templates")))),o.element.createElement(W,null,o.element.createElement(R,{className:"components-tab-button",isPressed:n==="preview",onClick:()=>this.showTab("preview")},o.element.createElement("span",null,d("Preview"))))),n==="preview"?o.element.createElement(C,{block:"tangible/template",className:e,attributes:t,EmptyResponsePlaceholder:J,LoadingResponsePlaceholder:J,onFetchResponseRendered:Se}):this.canEditTemplate&&n==="editor"?o.element.createElement(N,{value:t.template,onChange:u=>l({template:u})}):o.element.createElement(Te,{label:"Select template",value:t.template_selected,style:{height:"60px"},onChange:u=>l({template_selected:u&&parseInt(u,10)}),options:this.templateOptions}))}}s(A,"v"),b(A,"edit"),ve("tangible/template",{title:d("Tangible Template"),description:d("Dynamic template"),icon:"editor-code",category:"common",keywords:[d("template","loop","content")],edit:A,save(){return null}});const{wp:m}=window,{blocks:{registerBlockCollection:X}}=m;X&&X("tangible",{title:"Tangible",icon:m.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 99 99"},m.element.createElement("path",{d:"M0 0 H 33 V 33 H 0 L 0 0",fill:"#262262"}),m.element.createElement("path",{d:"M33 0 H 66 V 33 H 33 L 33 0",fill:"#662d91"}),m.element.createElement("path",{d:"M66 0 H 99 V 33 H 66 L 66 0",fill:"#9f1f63"}),m.element.createElement("path",{d:"M0 33 H 33 V 66 H 0 L 0 33",fill:"#2e3192"}),m.element.createElement("path",{d:"M66 33 H 99 V 66 H 66 L 66 33",fill:"#ec008c"}),m.element.createElement("path",{d:"M33 66 H 66 V 99 H 33 L 33 66",fill:"#02aeef"}))})})();
//# sourceMappingURL=gutenberg-template-editor.min.js.map

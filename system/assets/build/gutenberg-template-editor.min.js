var je=Object.defineProperty;var l=(v,k)=>je(v,"name",{value:k,configurable:!0});(function(){"use strict";(function(){const t={env:{NODE_ENV:"production"}};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,t);return}}catch(e){}globalThis.process={env:t}})();var v=Object.defineProperty,k=Object.defineProperties,ne=Object.getOwnPropertyDescriptors,j=Object.getOwnPropertySymbols,re=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable,B=l((t,e,n)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,"b$1"),E=l((t,e)=>{for(var n in e||(e={}))re.call(e,n)&&B(t,n,e[n]);if(j)for(var n of j(e))le.call(e,n)&&B(t,n,e[n]);return t},"l$1"),ae=l((t,e)=>k(t,ne(e)),"S$1"),p=l((t,e)=>v(t,"name",{value:e,configurable:!0}),"c$1");const{wp:a,lodash:oe}=window,{isEqual:se}=oe,{apiFetch:ce,blocks:{__experimentalSanitizeBlockAttributes:ie,sanitizeBlockAttributes:me},components:{Placeholder:D,Spinner:pe},compose:{useDebounce:ue,usePrevious:de},element:{RawHTML:z,useEffect:y,useRef:C,useState:O},i18n:{__:A,sprintf:he},url:{addQueryArgs:be}}=a;function V(t,e=null,n={}){return be(`/wp/v2/block-renderer/${t}`,E(E({context:"edit"},e!==null?{attributes:e}:{}),n))}l(V,"rendererPath"),p(V,"rendererPath");function U({className:t}){return a.element.createElement(D,{className:t},A("Block rendered as empty."))}l(U,"oe"),p(U,"DefaultEmptyResponsePlaceholder");function I({response:t,className:e}){const n=he(A("Error loading block: %s"),t.errorMsg);return a.element.createElement(D,{className:e},n)}l(I,"se"),p(I,"DefaultErrorResponsePlaceholder");function F({children:t,showLoader:e}){return a.element.createElement("div",{style:{position:"relative"}},e&&a.element.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",marginTop:"-9px",marginLeft:"-9px"}},a.element.createElement(pe,null)),a.element.createElement("div",{style:{opacity:e?"0.3":1}},t))}l(F,"ce"),p(F,"DefaultLoadingResponsePlaceholder");function G({className:t,children:e,onMount:n}){const s=C();return y(()=>{n&&n(s.current)},[]),a.element.createElement("div",{ref:s,className:"tangible-server-side-render"},a.element.createElement(z,{className:t},e))}l(G,"le"),p(G,"Content");function S(t){const{attributes:e,block:n,className:s,httpMethod:i="GET",urlQueryArgs:h,EmptyResponsePlaceholder:ke=U,ErrorResponsePlaceholder:Ce=I,LoadingResponsePlaceholder:Oe=F,onFetchResponseRendered:Se}=t,g=C(!0),[_e,Re]=O(!1),T=C(),[u,Y]=O(null),Z=de(t),[L,ee]=O(!1);function x(){if(!g.current)return;ee(!0);const b=e&&(me||ie)(n,e),H=i==="POST",Le=H?null:b!=null?b:null,xe=V(n,Le,h),He=H?{attributes:b!=null?b:null}:null,w=T.current=ce({path:xe,data:He,method:H?"POST":"GET"}).then(P=>{g.current&&w===T.current&&P&&Y(P.rendered)}).catch(P=>{g.current&&w===T.current&&Y({error:!0,errorMsg:P.message})}).finally(()=>{g.current&&w===T.current&&ee(!1)});return w}l(x,"E"),p(x,"fetchData");const Ne=ue(x,500);y(()=>()=>{g.current=!1},[]),y(()=>{Z===void 0?x():se(Z,t)||Ne()}),y(()=>{if(!L)return;const b=setTimeout(()=>{Re(!0)},1e3);return()=>clearTimeout(b)},[L]);const te=!!u,Me=u==="",$e=u==null?void 0:u.error;return L?a.element.createElement(Oe,ae(E({},t),{showLoader:_e}),te&&a.element.createElement(z,{className:s},u)):Me||!te?a.element.createElement(ke,E({},t)):$e?a.element.createElement(Ce,E({response:u},t)):a.element.createElement(G,{className:s,onMount:Se},u)}l(S,"ae"),p(S,"ServerSideRender");var K=Object.defineProperty,Ee=l((t,e,n)=>e in t?K(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,"E"),f=l((t,e)=>K(t,"name",{value:e,configurable:!0}),"p"),_=l((t,e,n)=>(Ee(t,typeof e!="symbol"?e+"":e,n),n),"m");const{wp:r,Tangible:Q,lodash:Be}=window,{element:{Component:W},blockEditor:{BlockControls:fe,InspectorControls:De},blocks:{registerBlockType:ge},components:{Button:R,DropdownMenu:ze,KeyboardShortcuts:ve,SelectControl:ye,TextControl:Ae,ToolbarItem:Ve,ToolbarButton:Ue,ToolbarGroup:q,Panel:Ie,PanelBody:Fe,PanelRow:Ge,withConstrainedTabbing:Ke},i18n:{__:d},keycodes:{rawShortcut:c}}=r,{CodeMirror:Qe,createCodeEditor:Te,gutenbergConfig:N,moduleLoader:we}=Q;Q.ServerSideRender=S;const o=f(t=>t.stopImmediatePropagation(),"stop"),Pe={tab:o,[c.shift("tab")]:o,[c.ctrl("[")]:o,[c.primary("[")]:o,[c.ctrl("]")]:o,[c.primary("]")]:o,[c.ctrl("a")]:o,[c.primary("a")]:o,[c.ctrl("d")]:o,[c.primary("d")]:o,[c.ctrl("z")]:o,[c.ctrlShift("z")]:o,[c.primary("z")]:o,[c.primaryShift("z")]:o},J=f(()=>r.element.createElement("div",null,"\xA0"),"EmptyTemplate");class M extends W{constructor(){super(...arguments),_(this,"onEditorUpdate",f(()=>{const{onChange:e}=this.props;e&&e(this.editor.getValue())},"onEditorUpdate"))}componentDidMount(){const e=Te(this.el,{language:"html",resizable:!0});e.setSize(null,"100%"),this.editor=e,this.editor.on("change",this.onEditorUpdate),r.editSite&&setTimeout(function(){e.refresh()},120)}componentWillUnmount(){this.editor.off("change",this.onEditorUpdate)}shouldComponentUpdate(){return!1}render(){const{value:e,onChange:n}=this.props;return r.element.createElement(ve,{shortcuts:Pe},r.element.createElement("textarea",{ref:s=>this.el=s,value:e,onChange:s=>{n(s.target.value)},cols:"30",rows:"10"}))}}l(M,"S"),f(M,"TemplateEditor");class $ extends W{constructor(e){super(e),_(this,"canEditTemplate",N.canEditTemplate),_(this,"state",{currentTab:this.props.attributes.template_selected||!this.canEditTemplate?"selectTemplate":"editor"}),this.props.attributes.current_post_id=N.current_post_id||0,this.templateOptions=[];const n=N.templateOptions,s=Object.keys(n);for(const i of s)this.templateOptions.push({value:i&&parseInt(i,10),label:n[i]})}showTab(e){this.state.currentTab!==e&&(this.setState({currentTab:e}),e==="editor"&&this.props.attributes.template_selected?this.props.setAttributes({template_selected:0}):e==="selectTemplate"&&!this.props.attributes.template_selected&&this.props.setAttributes({template_selected:this.templateOptions[0].value}))}render(){const{className:e,attributes:n,setAttributes:s}=this.props,{currentTab:i}=this.state;return r.element.createElement(r.element.Fragment,null,r.element.createElement(fe,null,r.element.createElement(q,null,this.canEditTemplate&&r.element.createElement(R,{className:"components-tab-button",isPressed:i==="editor",onClick:()=>this.showTab("editor")},r.element.createElement("span",null,d("Editor"))),r.element.createElement(R,{className:"components-tab-button",isPressed:i==="selectTemplate",onClick:()=>this.showTab("selectTemplate")},r.element.createElement("span",null,d("Saved templates")))),r.element.createElement(q,null,r.element.createElement(R,{className:"components-tab-button",isPressed:i==="preview",onClick:()=>this.showTab("preview")},r.element.createElement("span",null,d("Preview"))))),i==="preview"?r.element.createElement(S,{block:"tangible/template",className:e,attributes:n,EmptyResponsePlaceholder:J,LoadingResponsePlaceholder:J,onFetchResponseRendered:we}):this.canEditTemplate&&i==="editor"?r.element.createElement(M,{value:n.template,onChange:h=>s({template:h})}):r.element.createElement(ye,{label:"Select template",value:n.template_selected,style:{height:"60px"},onChange:h=>s({template_selected:h&&parseInt(h,10)}),options:this.templateOptions}))}}l($,"v"),f($,"edit"),ge("tangible/template",{title:d("Tangible Template"),description:d("Dynamic template"),icon:"editor-code",category:"common",keywords:[d("template","loop","content")],edit:$,save(){return null}});const{wp:m}=window,{blocks:{registerBlockCollection:X}}=m;X&&X("tangible",{title:"Tangible",icon:m.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 99 99"},m.element.createElement("path",{d:"M0 0 H 33 V 33 H 0 L 0 0",fill:"#262262"}),m.element.createElement("path",{d:"M33 0 H 66 V 33 H 33 L 33 0",fill:"#662d91"}),m.element.createElement("path",{d:"M66 0 H 99 V 33 H 66 L 66 0",fill:"#9f1f63"}),m.element.createElement("path",{d:"M0 33 H 33 V 66 H 0 L 0 33",fill:"#2e3192"}),m.element.createElement("path",{d:"M66 33 H 99 V 66 H 66 L 66 33",fill:"#ec008c"}),m.element.createElement("path",{d:"M33 66 H 66 V 99 H 33 L 33 66",fill:"#02aeef"}))})})();
//# sourceMappingURL=gutenberg-template-editor.min.js.map

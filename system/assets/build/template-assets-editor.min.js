var S=Object.defineProperty;var p=(m,t)=>S(m,"name",{value:t,configurable:!0});(function(){"use strict";(function(){const a={NODE_ENV:"production"};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,a);return}}catch{}globalThis.process={env:a}})();var m=Object.defineProperty,t=p((a,c)=>m(a,"name",{value:c,configurable:!0}),"t$1");const{wp:N}=window;let s,o;const h=t(()=>{if(s){s.open();return}s=N.media({title:"Select media attachment",button:{text:"Select"},multiple:!0}),s.on("select",o),s.open()},"openMediaModal");function T(a){return a.name&&(a.name=a.name.replace(/[^\w_\-]/g,"")),a}p(T,"y"),t(T,"withValidName");const w=t(({assets:a})=>{const[c,q]=Tangible.Preact.useState(a),n=Tangible.Preact.useRef();n.current=c;const d=Tangible.Preact.useRef(),f=t(()=>{d.current.value=JSON.stringify(n.current)},"updateAssetsElement");Tangible.Preact.useEffect(()=>{f()},[d.current]);const b=t(()=>{q([...n.current]),f()},"refreshAssets"),A=t(e=>{n.current.push(T(e)),b()},"addAsset"),k=t((e,l)=>{n.current[e]={...n.current[e]||{},...l},b()},"updateAsset"),O=t(e=>{n.current.splice(e,1),b()},"removeAsset");o||(o=t(()=>{const e=s.state().get("selection").toJSON();for(const l of e){let r=!1;for(const i of n.current)if(i.id===l.id){r=!0;break}if(r)continue;const g=["id","name","title","filename","mime","alt","caption","description"].reduce((i,v)=>(i[v]=l[v],i),{});A(g)}},"mediaModalCallback"));const E={};return Tangible.Preact.createElement(Tangible.Preact.Fragment,null,Tangible.Preact.createElement("input",{type:"hidden",name:"assets",ref:d}),Tangible.Preact.createElement("div",{className:"template-assets"},c.map((e,l)=>{const r=!!E[e.name];return r||(E[e.name]=!0),Tangible.Preact.createElement("div",{key:`asset-${l}`,className:"template-asset"},Tangible.Preact.createElement("div",{className:"template-asset-fields"},Tangible.Preact.createElement("div",{className:"template-asset-field template-asset-field--name"},Tangible.Preact.createElement("label",null,"Name"),Tangible.Preact.createElement("input",{type:"text",value:e.name,onChange:g=>{k(l,{name:g.target.value})}})),Tangible.Preact.createElement("div",{className:"template-asset-field template-asset-field--attachment"},Tangible.Preact.createElement("div",null,r&&Tangible.Preact.createElement("div",{className:"template-asset--duplicate-name-message"},"Duplicate name exists"),"ID:"," ",Tangible.Preact.createElement("a",{href:`post.php?post=${e.id}&action=edit`,target:"_blank"},e.id),Tangible.Preact.createElement("br",null),"Title: ",e.title,Tangible.Preact.createElement("br",null),"File name: ",Tangible.Preact.createElement("code",null,e.filename),Tangible.Preact.createElement("br",null)))),Tangible.Preact.createElement("div",{className:"template-asset-actions"},Tangible.Preact.createElement("div",{className:"template-asset-action template-asset-action--remove-asset"},Tangible.Preact.createElement("div",{className:"icon",onClick:()=>O(l)},Tangible.Preact.createElement("svg",{viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},Tangible.Preact.createElement("path",{d:"M1490 1322q0 40-28 68l-136 136q-28 28-68 28t-68-28l-294-294-294 294q-28 28-68 28t-68-28l-136-136q-28-28-28-68t28-68l294-294-294-294q-28-28-28-68t28-68l136-136q28-28 68-28t68 28l294 294 294-294q28-28 68-28t68 28l136 136q28 28 28 68t-28 68l-294 294 294 294q28 28 28 68z"}))))))})),Tangible.Preact.createElement("button",{type:"button",className:"button button--add-rule-group",onClick:()=>h()},"Add asset"))},"AssetsEditor"),{jQuery:y}=window,P=document.getElementById("tangible_template_assets_editor");let u=y(P).data("assets");Array.isArray(u)||(u=[]),Tangible.Preact.render(Tangible.Preact.createElement(w,{assets:u}),P)})();
//# sourceMappingURL=template-assets-editor.min.js.map

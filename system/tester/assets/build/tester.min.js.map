{"version":3,"file":"tester.min.js.map","sources":["../src/index.js"],"sourcesContent":["const createNewSession = () => ({\n  id: 0,\n  tests: [],\n  promises: [],\n  success: 0,\n  fail: 0,\n  total: 0,\n})\n\nconst tester = {\n  session: null,\n  start,\n}\n\n// Export\nwindow.Tangible = window.Tangible || {}\nwindow.Tangible.tester = tester\n\n/**\n * Tester\n *\n * Same interface as PHP side\n */\n\nfunction start(options = {}) {\n  const session = createNewSession()\n\n  // Corresponding tester ID on server-side\n  session.id = options.id || 0\n\n  const test = createSessionTest(session)\n\n  test.report = () => report(session)\n\n  return test\n}\n\n/**\n * Test and assert\n */\nfunction createSessionTest(session) {\n  return function test(title, callback) {\n    const result = {\n      title,\n      assertions: [],\n      success: true,\n      error: null,\n    }\n\n    const it = (assertionTitle, success = false) => {\n      result.assertions.push({\n        title: assertionTitle,\n        success: !!success,\n      })\n    }\n\n    try {\n      session.promises.push(callback(it))\n    } catch (error) {\n      result.success = false\n      result.error = error\n    }\n\n    session.tests.push(result)\n\n    if (result.success) {\n      session.success++\n    } else {\n      session.fail++\n    }\n\n    session.total++\n  }\n}\n\n/**\n * Reporter\n */\n\nconst successIcon =\n  '<span class=\"tangible-tester-success-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1000 1000\"><path d=\"M933 316q0 22-16 38L513 758l-76 76q-16 15-38 15t-38-15l-76-76L83 556q-15-16-15-38t15-38l76-76q16-16 38-16t38 16l164 165 366-367q16-16 38-16t38 16l76 76q16 15 16 38z\"/></svg></span>'\n\nconst failIcon =\n  '<span class=\"tangible-tester-fail-icon\"><svg viewBox=\"0 0 1792 1792\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1490 1322q0 40-28 68l-136 136q-28 28-68 28t-68-28l-294-294-294 294q-28 28-68 28t-68-28l-136-136q-28-28-28-68t28-68l294-294-294-294q-28-28-28-68t28-68l136-136q28-28 68-28t68 28l294 294 294-294q28-28 68-28t68 28l136 136q28 28 28 68t-28 68l-294 294 294 294q28 28 28 68z\"/></svg></span>'\n\nfunction report(session) {\n  const $result = document.querySelector(\n    `[data-tangible-tester-id=\"${session.id}\"]`\n  )\n\n  if (!$result) {\n    console.log('Test result element not found for ID', session.id)\n    return\n  }\n\n  $result.innerHTML = `\n<h4>JavaScript tests</h4>\n${\n  // Each test\n  session.tests\n    .map(\n      (result, index) =>\n        `\n<p>\n  ${result.success ? successIcon : failIcon}\n  &nbsp;&nbsp;${index + 1}. ${result.title}${\n          result.error ? '<br>' + result.error : ''\n        }\n</p>\n${\n  // Each assertion\n  !result.assertions.length\n    ? ''\n    : `\n<p>\n  ${result.assertions\n    .map(\n      (assert) =>\n        `\n  &nbsp;&nbsp;&nbsp;&nbsp;${assert.success ? successIcon : failIcon}\n  &nbsp;&nbsp;${assert.title}\n  ${\n    assert.error\n      ? `<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - ${assert.error}`\n      : ''\n  }`\n    )\n    .join('<br>')}\n</p>`\n}`\n    )\n    .join('') // Each test\n}\n<p>${\n    // Summary\n    session.fail === 0\n      ? `All ${session.total} test${session.total === 1 ? '' : 's'} passed`\n      : `Total of ${session.total} test${session.total === 1 ? '' : 's'}: ${\n          session.success\n        } passed, ${session.fail} failed`\n  }\n</p>\n`\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;AACA,EAAE,CAAC,CAAC,KAAI,CAAA,GAAA,CAAA,CAAA,CAAA,CAAA,CAAA,GAAA,CAAA;AACR;AACA,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAA,CAAA,CAAA;AACf,cAAa,EAAA,CAAA,CAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,KAAA,CAAA,EAAA,CAAA,CAAA,KAAA,CAAA,MAAA,CAAA,CAAA,CAAA,KAAA,CAAA,EAAA,CAAA;AACb;AACA,EAAE,CAAC,CAAC,UAAO,CAAA,MAAA,CAAA,CAAA;AACX;AACA,EAAA,EAAA,CAAA,CAAA,UAAA,CAAA,GAAA,CAAA,CAAA,EAAA,CAAA;AACA,0BAAgB,EAAA,CAAA,CAAA,OAAA,CAAA,CAAA,CAAA,CAAA,CAAA;AAChB,cAAc,EAAE,CAAA,CAAA,KAAA,CAAA;AAChB,EAAE,EAAE,CAAC,CAAC,KAAE,CAAA,CAAA,2CAAA,EAAA,CAAA,CAAA,KAAA,CAAA,CAAA,CAAA,EAAA,CAAA,CAAA,CAAA,CAAA,IAAA,CAAA,MAAA,CAAA,CAAA;AACR,IAAC,CAAA,CAAA,EAAA,CAAA,CAAA,CAAA,CAAA,IAAA,CAAA,EAAA,CAAA,CAAA;AACD,GAAA,EAAA,CAAA,CAAA,IAAA,GAAA,CAAA,CAAA,CAAA,IAAA,EAAA,CAAA,CAAA,KAAA,CAAA,KAAA,EAAA,CAAA,CAAA,KAAA,GAAA,CAAA,CAAA,EAAA,CAAA,GAAA,CAAA,OAAA,CAAA,CAAA,CAAA,SAAA,EAAA,CAAA,CAAA,KAAA,CAAA,KAAA,EAAA,CAAA,CAAA,KAAA,GAAA,CAAA,CAAA,EAAA,CAAA,GAAA,CAAA,EAAA,EAAA,CAAA,CAAA,OAAA,CAAA,SAAA,EAAA,CAAA,CAAA,IAAA,CAAA,OAAA,CAAA,CAAA;AACA;AACA,EAAC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;;;;;;"}